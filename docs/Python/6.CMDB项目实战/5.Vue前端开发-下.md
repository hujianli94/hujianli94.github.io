# 5.Vue前端开发-下


## 大纲

- vue常用指令之数据双向绑定
- vue实例生命周期钩子
- Vue cli脚手架
- 前后端数据交互Axios
- Vue路由： vue-router



## vue常用指令之数据双向绑定

双向数据绑定：通过前面学习知道Vue是数据驱动的，数据驱动有一个精髓之处是数据双向绑定，即当数据发生变化的时候，视图也就发生变化，当视图发生变化的时候，数据也会跟着同步变化。

### v-model

v-model指令提供表单输入绑定，可以在 `<input>`、`<textarea>` 及 `<select>` 元素上创建双向数据绑定。

#### v-model: 表单输入

v-model.html


- 代码示例：

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>V-model</title>
    <script src="static/vue.js"></script>
</head>
<body>
<div id="v_model">
    <input type="text" v-model="msg">
    <p>{{msg}}</p>
</div>
<script>
    const VueApp = {
        data() {
            return {
                msg: ""
            }
        }
    }
    Vue.createApp(VueApp).mount('#v_model')
</script>
</body>
</html>
```

> v-model指令其实是一个语法糖，背后本质上包含v-bind和v-on两个操作。



#### v-model: 单选

v-model-select.html

- 示例代码

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>V-model-Select</title>
    <script src="static/vue.js"></script>
</head>
<body>
<div id="v_model">
    <input type="radio" value="Golang" v-model="msg">Golang <br>
    <input type="radio" value="Vue" v-model="msg">Vue <br>
    <p>选择： {{msg}}</p>
</div>
<script>
    const VueApp = {
        data() {
            return {
                msg: ""
            }
        }
    }
    Vue.createApp(VueApp).mount('#v_model')
</script>
</body>
</html>
```

#### v-model: 多选

v-model-selects.html

- 示例代码

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>V-model-selects</title>
    <script src="static/vue.js"></script>
</head>
<body>
<div id="v_model">
    <select v-model="selected" multiple>
        <option value="go">go</option>
        <option value="python">python</option>
        <option value="java">java</option>
    </select>
    <p>{{selected}}</p>
</div>
<script>
    const VueApp = {
        data() {
            return {
                selected: ""
            }
        }
    }
    Vue.createApp(VueApp).mount('#v_model')
</script>
</body>
</html>
```



#### 登录页面案例

v-model-login.html


- 示例代码

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>V-model-Login</title>
    <script src="static/vue.js"></script>
</head>
<body>
<div id="login">
    <div>
        欢迎访问Devops平台
        <br>
        用户名： <input type="text" v-model="form.username"> <br>
        密码： <input type="text" v-model="form.password"> <br>
        <button @click="loginBtn">登录</button>
    </div>
</div>
<script>
    const VueApp = {
        data() {
            return {
                form: {
                    username: '',
                    password: ''
                }
            }
        },
        methods: {
            loginBtn() {
                console.log(this.form)
            }
        }
    }
    Vue.createApp(VueApp).mount('#login')
</script>
</body>
</html>
```


### vue常见指令总结

![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.231lmhehhp.webp){: .zoom}



## vue实例生命周期钩子


生命周期是指Vue实例从创建到销毁的过程。就是vue实例从开始创建、初始化数据、编译模板、挂载Dom、渲染->更新->渲染、卸载等⼀系列过程，在vue⽣命周期中提供了⼀系列的⽣命周期函数，如图所⽰


![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.2doffmxsia.webp){: .zoom}


![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.syog618y5.webp){: .zoom}


- 示例代码


```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>lifeCycle</title>
    <script src="static/vue.js"></script>
</head>
<body>
<div id="vue_lifecycle">
    {{counter}}
</div>
<script>
    const VueApp = {
        data() {
            return {
                counter: 0
            }
        },
        methods: {
            increament() {
                this.counter++
            }
        },
        created() {
            console.log('xxx')
        },
        mounted() {
            //在渲染完页面之后执行
            console.log('打开页面执行')
            this.increament()
        }
    }
    Vue.createApp(VueApp).mount('#vue_lifecycle')
</script>
</body>
</html>
```


## Vue cli脚手架


### vue cli脚手架介绍

到目前为止，已经会了Vue基本使用，但这种在HTML引用Vue.js的方式，简单的页面还是没问题的，如果用Vue开发整个前端项目，组建Vue项目结构及配置还是比较复杂的，例如引入各种js文件、打包上线等。

因此，为了提高开发效率，官方开发了VueCli脚手架快捷搭建开发环境。


Vue CLI 是一个基于 Vue.js 进行快速开发的完整系统，提供：
- 通过 @vue/cli 实现的交互式的项目脚手架。
- 通过 @vue/cli + @vue/cli-service-global 实现的零配置原型开发。


- 一个运行时依赖 (@vue/cli-service)，该依赖：
  - 可升级；
  - 基于 webpack 构建，并带有合理的默认配置；
  - 可以通过项目内的配置文件进行配置；
  - 可以通过插件进行扩展。

- 一个丰富的官方插件集合，集成了前端生态中最好的工具。
- 一套完全图形化的创建和管理 Vue.js 项目的用户界面。


Vue CLI 致力于将 Vue 生态中的工具基础标准化。它确保了各种构建工具能够基于智能的默认配置即可平稳衔接，这样你可以专注在撰写应用上，而不必花好几天去纠结配置的问题。



### 认识NPM

在使用Vue Cli之前，需先了解一些关于NPM的知识点：

- **NPM（Node Package Manager，Node包管理器），**存放JavaScript代码共享中心，是目前最大的JavaScript仓库。类似于Linux yum仓库。

- 可能你会联想到Node.js，Node.js是服务端的JavaScript，类似于Gin、Django，NPM是基于Node.js开发的软件。

- 随着Node.js兴起，生态圈的JS库都纷纷向NPM官方仓库发布，所以现在，大都是使用 npm install 命令来安装JS库，而不必再去它们官网下载了。


安装Node.js，默认已经内置npm，下载对应软件包直接安装即可。 http://nodejs.cn/download/



|命令|描述|
|----|--------|
|npm -v|查看版本|
|npm install <模块名>|安装模块|
|npm install -g <模块名>|可以直接在命令行里使用|
|npm list -g|查看所有全局安装的模块|
|npm list <模块名>|查看某个模块的版本号|
|npm install -g <模块名>@<版本号>|更新模块版本|
|npm install -save <模块名>|在package,json文件中写入依赖<br>(npm5版本之前需要指定，之后版本无需再加-save选项)|
|npm config|管理npm的配置路径|
|npm run serve|运行项目|
|npm run build|打包项目|


- 配置淘宝npm仓库

```sh
npm config set registry https://registry.npm.taobao.org --global 
npm config get registry
```


### vue cli脚手架的使用

Vue Cli脚手架使用步骤：
- 安装nodeJS TLS版本：  https://nodejs.org/
- 命令安装：npm install -g @vue/cli
- 检查版本：vue -V
- 创建项目：vue create <项目名称>


![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.5j3xel6j98.webp){: .zoom}




- 运行项目，访问

```sh
cd hello-vue
npm run serve
```

#### 目录结构及其介绍


|目录/文件|	说明|
|-----|-----|
|node_modules|	项目开发依赖的一些模块，不用管|
|public|主要存放首页、favicon|
|src	|源码目录，这里是我们要开发的目录，基本上要做的事情都在这个目录里。里面包含了几个目录及文件：<br>assets: 放入资源，例如图片、CSS等<br>components: 公共组件目录<br>routes: 前端路由<br>store: 应用级数据（state）Vuex<br>views: 单页面组件目录<br>App.vue： 项目的入口文件（根组件<br>main.js: 项目的全局配置，在任意一个文件中都有效的|
|gitignore文件	|git提交忽略文件|
|babel.config.js|	babel配置，例如es5转es6|
|package.json|	项目配置文件。npm包配置文件，里面定义了项目的npm脚本，依赖包等信息|
|README.md|	项目的说明文档，markdown格式|


![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.4uanukmeir.webp){: .zoom}



#### vite创建项目


Vite是Vue的作者尤雨溪开发的Web开发构建工具，它是一个基于浏览器原生ES模块导入的开发服务器，在开发环境下，利用浏览器解析import,

在服务器端按需编译返回，完全跳过了打包这个概念，服务器随启随用。

同时，Vite 不仅对 Vue 文件提供了支持，还支持热更新，而且热更新的速度不会随着模块增多而变慢。在生产环境下使用 Rollup 打包。



Vite具有以下特点：

- 快速的冷启动；
- 即时热模块更新(hot module replacement,.HMR);
- 真正按需编译。

Vite 是在推出 Vue3.0 时开发的，目前仅支持 Vue3.x ,这意味着与 Vue3.0 不兼容的库也不能与 Vite 一起使用。


创建项目vite项目

```sh
#------------------------ 创建项目vite项目 ------------------------------
# npm 6.x
npm init vite@latest vue3-admin --template vue

# npm 7+, 需要额外的双横线：
npm init vite@latest vue3-admin -- --template vue

# yarn
yarn create vite vue3-admin --template vue

# pnpm
pnpm create vite vue3-admin -- --template vue
```


```sh
#------------------------ vite生成ts项目 ------------------------------
npm init vite@latest my-vue-app --template vue-ts

# npm 7+, 需要额外的双横线：
npm init vite@latest my-vue-app -- --template vue-ts

# yarn
yarn create vite my-vue-app --template vue-ts

# pnpm
pnpm create vite my-vue-app -- --template vue-ts
```


安装依赖并运行项目
```sh
cd projectName
npm install
npm run dev
```



### vue组件


#### 组件介绍


**组件:** 一段独立的，能代表页面某一个部分的代码片段，拥有自己独立的数据、JavaScript脚本、以及CSS样式。

组件是可复用的Vue实例，在开发过程中可以把经常重复的功能，封装为组件，达到快捷开发的目的。


组件的好处：

- 提高开发效率
- 方便重复使用
- 易于管理和维护

通常一个应用会以一棵嵌套的组件树的形式来组织，如图所示。

例如，你可能会有页头、侧边栏、内容区等组件，每个组件又包含了其它的像导航链接、博文之类的组件。

![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.5q75a0xvxd.webp){: .zoom}



#### 文件格式

Vue单文件格式（又名*.vue文件，缩写为SFC）是一种特殊的文件格式，它允许将Vue组件的模板、逻辑与样式封装在单个文件中。

正如所见，Vue SFC是经典的HTML、CSS与JavaScript三个经典组合的自然延伸。每个*.vue文件由三种类型的顶层代码块组成：<template>、<script>与<style>:

```js
<template>部分定义了组件的模板
<script>部分是一个标准的JavaScript模块。它应该导出一个Vue组件定义作为其默认导出。
<style>部分定义了与此组件关联的CSS
```






#### 修改默认页面配置


- 修改 `components/HelloWorld.vue`


```html
<template>
  <div class="hello">
    <h1>{{ msg }}</h1>
    这是hello world 子组件内容
  </div>
</template>

<script>
export default {
  name: "HelloWorld",
  props: {
    msg: String,
  },
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>
h3 {
  margin: 40px 0 0;
}

ul {
  list-style-type: none;
  padding: 0;
}

li {
  display: inline-block;
  margin: 0 10px;
}

a {
  color: #42b983;
}
</style>
```


- 修改 `views/HomeView.vue`

```html
<template>
  <div class="home">
    <img alt="Vue logo" src="../assets/logo.svg"/>
    <HelloWorld msg="欢迎使用Vue"/>
  </div>
</template>

<script>
// @ is an alias to /src
import HelloWorld from "@/components/HelloWorld.vue";

export default {
  name: "HomeView",
  components: {
    HelloWorld,
  },
};
</script>
```


- 修改 `views/AboutView.vue`


```html
<script>
export default {
  name: "AboutView"
}
</script>

<template>
  <div class="about">
    这是关于页面
  </div>
</template>

<style scoped>

</style>
```


- 修改 `App.vue`


```html
<script setup>
</script>

<template>
  <nav>
    <router-link to="/">首页</router-link>
    |
    <router-link to="/about">关于</router-link>
  </nav>
  <router-view/>
</template>

<style scoped>
#app {
  font-family: Avenir, Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
}

nav {
  padding: 30px;
}

nav a {
  font-weight: bold;
  color: #2c3e50;
}

nav a.router-link-exact-active {
  color: #42b983;
}
</style>
```


- 效果展示


![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.64dl4svdw4.webp){: .zoom}



#### 组件使用

使用具体流程：

1、在 src/views 目录里开发一个组件文件（首字母大写）: NewView.vue

> 可以在创建的时候关闭语法检查，右侧飘红的地方右键，选择Customize Highlighting Level配置成None就可以


```html
<script>
export default {
  name: "NewView"
}
</script>

<template>
  <p> 这是一个新的页面 </p>
</template>

<style scoped>

</style>
```


2、在 router/index.js 中新增/new , /new2 路由: new2是懒加载，一般用这种方式


```js
import {createRouter, createWebHashHistory} from "vue-router";

const Home = () => import("../views/HomeView.vue");
const About = () => import("../views/AboutView.vue");

const NewView = () => import("../views/NewView.vue");

const routes = [
        {
            path: "/",
            name: "root",
            component: Home,
        },
        {
            path: "/home",
            name: "home",
            component: Home,
        },
        {
            path: "/about",
            name: "about",
            // route level code-splitting
            // this generates a separate chunk (about.[hash].js) for this route
            // which is lazy-loaded when the route is visited.
            component: About,
        },
        {
            path: "/new",
            name: "new",
            component: NewView,
        },
        {
            path: "/new2",
            name: "new2",
            component: () =>
                import(/* webpackChunkName: "about" */ "../views/NewView.vue"),
        },
    ];

const router = createRouter({
    history: createWebHashHistory(),
    routes,
});

export default router;
```


3、调整全局配置 vite.config.js 文件，关闭eslint语法检查


```js
import {fileURLToPath, URL} from 'node:url'

import {defineConfig} from 'vite'
import vue from '@vitejs/plugin-vue'

// https://vitejs.dev/config/
export default defineConfig({
    // other configurations...
    esbuild: {
        jsx: 'preserve' // Disable ESLint syntax checking
    },
    plugins: [
        vue(),
    ],
    resolve: {
        alias: {
            '@': fileURLToPath(new URL('./src', import.meta.url))
        }
    }
})
```


4、页面测试

![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.7zq5xg0pjv.webp){: .zoom}




开发组件  -->  注册组件  --> 使用组件





5、将HelloWorld 注册到 views/NewView.vue 中

```html
<template>
  <p>这是一个新的页面</p>
  <HelloWorld></HelloWorld>
</template>

<script>
import HelloWorld from "@/components/HelloWorld.vue";

export default {
  name: "NewView",
  components: {
    HelloWorld,
  }
}
</script>


<style scoped>

</style>
```

6、调整App.vue 加入新页面配置

```html
<script setup>
</script>

<template>
  <nav>
    <router-link to="/">首页</router-link>
    |
    <router-link to="/about">关于</router-link>
    |
    <router-link to="/new">新页面</router-link>
  </nav>
  <router-view/>
</template>

<!-- .....其余不动.. -->
```



7、测试

![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.361b1bpkoj.webp){: .zoom}



8、创建 `component/Test.vue` 组件

```html
<template>
  <div class="test"></div>
</template>

<script>
export default {
  name: "Test"
}
</script>

<style scoped>
.test {
  width: 200px;
  height: 200px;
  background: orange;
}
</style>
```


9、在 `views/NewView` 中注册 Test 组件

```html
<template>
  <div class="new">
    <p>这是一个新的页面</p>
    <HelloWorld></HelloWorld>
    <Test></Test>
  </div>
</template>

<script>
import HelloWorld from "@/components/HelloWorld.vue";
import Test from "@/components/Test.vue";

export default {
  name: "NewView",
  components: {
    HelloWorld,
    Test
  }
}
</script>


<style scoped>
.new {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
</style>
```

10、效果展示

![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.1ov5zpb9s6.webp){: .zoom}



#### 组件注册


为了能在模板中使用，这些组件必须先注册以便 Vue 能够识别。这里有两种组件的注册类型：全局注册和局部注册。上述是局部注册，只能在当前模板中使用。

**全局注册：**声明一次，在任何vue文件模板中使用，一般使用该组件的地方多时使用

**局部注册：**在使用组件的vue文件中声明和使用，一般只需要解耦代码时使用(使用较多) ， 上述8,9 示例就是局部注册的典型应用




全局注册示例



- 在 main.js 注册 `components/Test.vue`


```js
import './assets/main.css'

import {createApp} from 'vue'
import App from './App.vue'
import router from './router'
import Test from './components/Test.vue'


const app = createApp(App)
app.component('Test', Test)
app.use(router).mount("#app");
```

- 在 `views/AboutView.vue` 中引用全局的 Test 组件

```html
<script>
export default {
  name: "AboutView"
}
</script>

<template>
  <div class="about">
    这是关于页面
  </div>
  <Test></Test>
</template>

<style scoped>
.about {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
</style>
```


- 效果展示

![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.lt2is46v.webp){: .zoom}



#### 组件传参

学习了组件用法，就像一种嵌套引用关系，在这个关系中，经常会涉及相互传数据的需求，即父组件传子组件，子组件传父组件。

父、子组件的关系可以总结为： **prop 向下传递，事件向上传递**。

父组件通过 prop 给子组件下发数据，子组件通过事件给父组件发送消息，如右图所示：

![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.26l7oalb3m.webp){: .zoom}



##### 父传子示例

示例1

- 父组件 `views/HomeView.vue`

```html
<template>
  <div class="home">
    <img alt="Vue logo" src="../assets/logo.svg"/>
    <HelloWorld msg="欢迎使用Vue"/>
  </div>
</template>

<script>
// @ is an alias to /src
import HelloWorld from "@/components/HelloWorld.vue";

export default {
  name: "HomeView",
  components: {
    HelloWorld,
  },
};
</script>


<style scoped>
.home {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.logo-container {
  margin-bottom: 20px;
}
</style>
```


- 子组件 `views/HelloWorld.vue`

```html
<template>
  <div class="hello">
    <h1>{{ msg }}</h1>>
    这是hello world 子组件内容
  </div>
</template>

<script>
export default {
  name: "HelloWorld",
  props: {
    msg: String,
  },
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>
h3 {
  margin: 40px 0 0;
}

ul {
  list-style-type: none;
  padding: 0;
}

li {
  display: inline-block;
  margin: 0 10px;
}

a {
  color: #42b983;
}
</style>
```

示例2


1、views/NewView.vue 父组件代码


```html
<template>
  <div class="new">
    <p>这是一个新的页面</p>
    <HelloWorld></HelloWorld>
    <Test msg="我是NewView传递的数据"></Test>
    <!--    //后端数据到子组件需要bind-->
    <Test :msg="msg"></Test>
  </div>
</template>

<script>
import HelloWorld from "@/components/HelloWorld.vue";
import Test from "@/components/Test.vue";

export default {
  name: "NewView",
  components: {
    HelloWorld,
    Test
  },
  data() {
    return {
      msg: "你好，这是父组件传递的内容"
    }
  }
}
</script>


<style scoped>
.new {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
</style>
```

2、Components/Test.vue 子组件接收

```html
<template>
  <div class="test">
    {{ msg }}
  </div>
</template>

<script>
export default {
  name: "Test",
  props: {
    msg: String,
  },
}
</script>

<style scoped>
.test {
  width: 200px;
  height: 200px;
  background: orange;
}
</style>
```


3、效果展示

![image](https://cdn.jsdelivr.net/gh/hujianli94/picx-images-hosting@master/image.1754b4zmlq.webp){: .zoom}

