# 4.Python 开发环境

## 1.Python3 环境搭建

=== "Windows"

    ```shell
    1. 从如下地址下载Python3安装包

    # python官方各版本下载地址：
    https://www.python.org/ftp/python/

    # 国内华为镜像：
    https://mirrors.huaweicloud.com/python/


    2. 双击安装，第一个节目选中 Add Python3.* to PATH，点击Install Now(默认安装pip)，一路下一步


    3. 验证：打开cmd命令行，输入python，应能进入python shell 并显示为Python 3.6.5版本
    ```

=== "MacOS"

    ```shell
    # 安装brew：在终端执行以下命令
    ruby -e "$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)"

    # 使用brew安装python3：
    brew install python3
    ```

=== "Linux"

    CentOS Python3环境源码搭建

    ```shell
    # 1.安装依赖包
    yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gcc make
    yum install libffi-devel -y


    # 2.下载Python3源码安装
    wget https://www.python.org/ftp/python/3.7.0/Python-3.7.0.tgz
    tar -zxvf Python-3.7.0.tgz
    cd Python-3.7.0
    ./configure --prefix=/usr/local/python37
    make & make install

    # 3.建立软链
    ln -s /usr/local/python37/bin/python3.7 /usr/bin/python3
    ln -s /usr/local/python37/bin/pip3 /usr/bin/pip3

    # 4.添加python3到环境变量 vim ~/.bashrc, 增加
    export PATH=$PATH:/usr/local/python37/bin

    # 使用source ~/.bshrc是环境变量生效
    ```

    "Ubuntu 安装最新版本 Python"

    ```shell
    # 1.添加 ppa 源：

    # 死蛇的源
    sudo add-apt-repository ppa:deadsnakes/ppa
    # 或者，jonathonf 的源
    sudo add-apt-repository ppa:jonathonf/python-3.x
    # 如果提示没有 add-apt-repository 的话执行：

    apt install software-properties-common
    # 更新源并安装 python3.x，3.x 以你要安装的版本号为准：

    sudo apt update
    sudo apt install python3.x
    # 可选
    sudo apt install python3.x-dev
    sudo apt install python3.x-venv


    # 安装 pip:
    wget https://bootstrap.pypa.io/get-pip.py
    sudo python3.x get-pip.py
    # 查看 python 和 pip 版本：
    # 也可以用 - V
    python --version
    python3 --version
    pip --version
    pip3 --version

    # 如果关联版本不正确，备份 usr/bin 的软链接，重建软链接：

    # 设置默认 python3 对应 python 版本
    sudo ln -s /usr/bin/python3.x /usr/bin/python3
    # 设置默认 pip3 使用 pip 版本
    sudo ln -s /usr/local/bin/pip3.x /usr/bin/pip3

    # 注意 python 默认安装位置在 /usr/bin 下，pip 默认安装位置在 /usr/local/bin 下

    # pip 初始化设置：
    mkdir ~/.pip
    touch ~/.pip/pip.conf

    # python3.6/pip18 之后无需配置这个
    echo [list]>>~/.pip/pip.conf
    echo format=columns>>~/.pip/pip.conf

    # 设置默认 pip 源为清华大学开源镜像
    echo [global]>>~/.pip/pip.conf
    echo index-url = https://pypi.tuna.tsinghua.edu.cn/simple>>~/.pip/pip.conf

    # (可选) 一键升级所有过期的包：
    sudo pip freeze --local | grep -v '^\-e' | cut -d = -f 1  | xargs pip install -U
    ```

## 2.Conda 安装与使用

Python 支持多种方式安装，这里推荐使用 Anaconda,更方便管理版本等信息。

### 2.1 Anaconda 介绍

Anaconda 是一个用于科学计算的 Python 发行版，支持 Linux、Mac、Windows 系统，包含了众多流行的科学计算、数据分析的 Python 包。

此外，Anaconda 提供了包管理与环境管理的功能，可以很方便地解决多版本 python 并存、切换以及各种第三方包安装问题。

conda 分为 anaconda 和 miniconda。

anaconda 是包含一些常用包的版本，miniconda 则是精简版，需要啥装啥，所以推荐使用 miniconda。

- Anaconda

- miniconda

特点：相比 Anaconda 安装文件体积小，可以按照实际需求安装相关依赖和包。

Anaconda 比较臃肿, 推荐安装 无 GUI 的 miniconda

下载网址

> miniconda 官网：<https://conda.io/miniconda.html>

这里我本地笔记本安装的如下版本：

`Miniconda3-latest-Windows-x86_64.exe`

[wsl | 安装配置 miniconda 虚拟环境](https://www.lvbibir.cn/posts/tech/windows-wsl-4-miniconda/)

[windows | miniconda 配置 python 虚拟环境](https://www.lvbibir.cn/posts/tech/windows-miniconda/)

[Conda 软件包和环境管理系统](https://www.xiexianbin.cn/python/env/conda/index.html)

[Windows 平台开发环境搭建](https://zhoptics.github.io/python-tutorials/install.html)

miniconda 的使用

- https://hellogitlab.com/backend/python/miniconda

### 2.2 镜像源

#### 2.2.1 下载方式

- 国内地址: <https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive>

- 官网地址: <https://www.anaconda.com/>

[Python 多环境管理神器（Anaconda）](https://www.cnblogs.com/doublexi/p/15796263.html)

> 从官网下载比较慢，推荐使用国内下载地址，然后选择自己系统对应的版本，下载即可

Anaconda 与 Python 版本对应关系：[传送门](https://docs.anaconda.com/free/anaconda/reference/packages/oldpkglists/)

```sh
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash Miniconda3-latest-Linux-x86_64.sh
rm -rf Miniconda3-latest-Linux-x86_64.sh
```

#### 2.2.2 更换国内镜像源

通常 anaconda 的默认源在境外，下载速度会非常慢甚至导致网络错误下载包失败，这里推荐清华大学镜像源，添加方法如下:

```shell
# 创建.condarc文件
$ conda config --set show_channel_urls yes

$ conda config --show-sources
==> /root/.condarc <==
auto_activate_base: False
envs_dirs:
  - /mnt/d/envs
pkgs_dirs:
  - /root/miniconda3/pkgs
channels:
  - https://mirrors.ustc.edu.cn/anaconda/pkgs/free/
  - https://mirrors.ustc.edu.cn/anaconda/pkgs/main/
  - defaults
custom_channels:
  conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  pytorch-lts: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  deepmodeling: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/
default_channels:
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2
show_channel_urls: True


# 编辑.condarc文件
channels:
  - https://mirrors.ustc.edu.cn/anaconda/pkgs/free/
  - https://mirrors.ustc.edu.cn/anaconda/pkgs/main/
  - defaults
show_channel_urls: true
default_channels:
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2
custom_channels:
  conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  pytorch-lts: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  deepmodeling: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/
# 不自动激活 base 环境
auto_activate_base: false
# 虚拟环境存放路径  修改 Conda 包存储的位置
envs_dirs:
  - D:\software\python\envs
# pkg 存放路径
pkgs_dirs:
  - D:\software\python\pkgs
```

[Anaconda 镜像使用帮助](https://mirrors.bfsu.edu.cn/help/anaconda/)

> 注：由于更新过快难以同步，该镜像源不会同步 pytorch-nightly, pytorch-nightly-cpu, ignite-nightly 这三个包。
>
> 更多信息可查看官方文档:<https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/>

#### 2.2.3 清除缓存

添加镜像源成功后，需要手动清除索引缓存，保证用的是镜像是最新的配置；清除命令如下:

```shell
# 清除索引缓存
$ conda clean -i
```

#### 2.2.4 更新镜像源

```shell
conda update --all
```

#### 2.2.5 版本升级

```shell
# 查看当前版本
$ conda  -V
conda 22.9.0

# 升级版本
$ conda update conda

$ conda update conda          #基本升级
$ conda update anaconda       #大的升级
$ conda update anaconda-navigator    #update最新版本的anaconda-navigator

```

### 2.3 管理 python 环境

#### 2.3.1 查看可用版本

使用 conda search x 搜索某个软件包的可用版本。

```shell
$ conda search python
Loading channels: done
# Name                       Version           Build  Channel
python                        2.7.13     h32f5f24_13  anaconda/pkgs/main
....
python                        3.9.15      h218abb5_2  anaconda/pkgs/main
...
python                        3.10.0      h88f2d9e_0  anaconda/pkgs/main
....
python                        3.11.0      h1fd4e5f_2  anaconda/pkgs/main
```

#### 2.3.2 创建环境

使用`conda create --name 环境名称 python=x`创建 python 新环境，x 可指定具体版本,如下示例创建 python3.10 版本

```shell
# 创建python3.10开发环境，环境名称为: py310
$ conda create --name py310 python=3.10
Collecting package metadata (current_repodata.json): done
Solving environment: done

## Package Plan ##
  environment location: /Users/liuqh/opt/anaconda3/envs/py310
  added / updated specs:
    - python=3.10

The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    pip-23.0.1                 |  py310hecd8cb5_0         2.6 MB  defaults
    python-3.10.11             |       h218abb5_2        13.1 MB  defaults
    setuptools-66.0.0          |  py310hecd8cb5_0         1.2 MB  defaults
    wheel-0.38.4               |  py310hecd8cb5_0          66 KB  defaults
    ------------------------------------------------------------
                                           Total:        17.0 MB
...
Proceed ([y]/n)?
# 输入:y
Downloading and Extracting Packages
python-3.10.11       | 13.1 MB   | ######################################################################## | 100%
wheel-0.38.4         | 66 KB     | ######################################################################## | 100%
pip-23.0.1           | 2.6 MB    | ######################################################################## | 100%
setuptools-66.0.0    | 1.2 MB    | ######################################################################## | 100%
Preparing transaction: done
Verifying transaction: done
Executing transaction: done
#
# To activate this environment, use
#
#     $ conda activate py310
#
# To deactivate an active environment, use
#
#     $ conda deactivate

Retrieving notices: ...working... done
```

#### 2.3.3 列出环境

使用`conda env list`可以列出我们创建的所有开发环境；

```shell
# 列出创建的所有开发环境
$ conda env list
# conda environments:
base                  *  /Users/liuqh/opt/anaconda3 # 这里的*代表当前使用环境
py310                    /Users/liuqh/opt/anaconda3/envs/py310
python3.11               /Users/liuqh/opt/anaconda3/envs/python3.11
python3.7                /Users/liuqh/opt/anaconda3/envs/python3.7
```

#### 2.3.4 激活环境

当我们使用的项目，用了不同的 python 版本时，可以通过激活对应的环境，来选择适应的版本;

激活环境的命令如下:

```shell
# 激活python3.11开发环境
$ conda activate python3.11
(python3.11)  ~ python -V
Python 3.11.3

# 激活刚才创建的py310开发环境
$ conda activate py310
(py310) ➜  ~ python -V
Python 3.10.11
```

#### 2.3.5 删除环境

当我们不想使用某些环境时，可以通过命令:`conda env remove --name 环境名称` 来删除环境，

如下示例删除 py310 环境

```shell

# 删除
$ conda env remove --name py310

Remove all packages in environment /Users/liuqh/opt/anaconda3/envs/py310:
# 查看是否删除
$ conda env list
# conda environments:
base                  *  /Users/liuqh/opt/anaconda3 # 这里的*代表当前使用环境
python3.11               /Users/liuqh/opt/anaconda3/envs/python3.11
python3.7                /Users/liuqh/opt/anaconda3/envs/python3.7
```

#### 2.3.6 导出环境

如果想把本地开发环境，分享给同事，可以通过导出命令`conda env export`,如下:

```shell
# 导出当前环境
(python3.7) $ conda env export > py37.yaml
# 查看导出文件
(python3.7) $ ls
py37.yaml
# 查看文件内容
$ cat py37.yaml
name: python3.7
channels:
  - defaults
dependencies:
  - ca-certificates=2023.01.10=hecd8cb5_0
  ...
  - pip:
    - numpy==1.19.1
    ...
prefix: /Users/liuqh/opt/anaconda3/envs/python3.7
```

#### 2.3.7 导入环境

有导出自然就有导出，比如同事给你的环境文件是 py37.yaml，你可以基于这个文件直接导入本地，导入命令如下:

```shell
# 基于环境文件创建环境
$ conda env create -f py37.yaml
Collecting package metadata (repodata.json): done
Solving environment: done
Preparing transaction: done
Verifying transaction: done
```

#### 2.3.8 默认环境

1. 关闭 base 环境

安装完 Conda 之后，开启终端将默认进入 base 环境，如果想关闭可使用下面命令:

```shell
# 执行后，新启动终端发现已经不在进入base环境
$ conda config --set auto_activate_base false
```

2. 指定默认环境(mac)

修改`~/.bashrc`

```shell

# 你本地的anaconda3安装路中的etc/profile.d/conda.sh
source /Users/liuqh/opt/anaconda3/etc/profile.d/conda.sh

# 切换到某个环境
conda activate python3.11
```

> 修改之后执行 source ~/.bashrc,后面新创建的终端都是指定环境

### 2.4 依赖管理

#### 2.4.1 安装依赖

python 安装依赖(第三方包)，常见的方式是使用`pip install`,除此之外，还可以使用`conda install`,下面以安装 requests 为示例,两种方式使用分别如下:

```shell
# 使用pip 安装
$ pip install requests

# 使用 conda
$ conda install requests

# 安装指定版本
$ conda install requests=2.29.0
```

```shell
# 通过pip 安装依赖时，可以使用 -i指定加速源来提升下载速度,如下示例:

# 根据requirements.txt 下载依赖
$ pip install -r requirements.txt -i 加速源

# 直接下载包
$ pip install -i 加速源 numpy
```

国内加速源部分整理如下:

```
1. 清华大学开源软件镜像站：https://pypi.tuna.tsinghua.edu.cn/simple/
2. 阿里云 PyPI 镜像：http://mirrors.aliyun.com/pypi/simple/
3. 华为云 PyPI 镜像：http://mirrors.huaweicloud.com/repository/pypi/simple/
4. 豆瓣 PyPI 镜像：http://pypi.douban.com/simple/
5. ustc PyPI 镜像：http://mirrors.ustc.edu.cn/pypi/web/simple/
```

#### 2.4.2 删除依赖

```shell
conda remove requests
```

#### 2.4.3 查看已安装依赖

```shell
# 查看所有
$ conda list
(base) ➜  ~ conda list
# packages in environment at /Users/liuqh/opt/anaconda3:
# Name                    Version                   Build  Channel
_anaconda_depends         2023.03                  py39_0    defaults
_ipyw_jlab_nb_ext_conf    0.1.0            py39hecd8cb5_1    defaults
alabaster                 0.7.12             pyhd3eb1b0_0    defaults
...
# 通过模糊搜索
$ conda list | grep req
requests                  2.29.0           py39hecd8cb5_0    defaults
requests-file             1.5.1              pyhd3eb1b0_0    defaults
requests-toolbelt         0.9.1              pyhd3eb1b0_0    defaults
```

### 2.5 conda 环境基本命令

```shell
conda update -n base conda        #update最新版本的conda
conda update --all                #update最新版本的conda
conda create -n xxxx python=3.5   #创建python3.5的xxxx虚拟环境
conda activate xxxx               #开启xxxx环境
conda deactivate                  #关闭环境
conda env list                    #显示所有的虚拟环境
conda info --envs                 #显示所有的虚拟环境


####### 更新，卸载安装包：
conda list         #查看已经安装的文件包
conda list -n xxx       #指定查看xxx虚拟环境下安装的package
conda update xxx   #更新xxx文件包
conda uninstall xxx   #卸载xxx文件包


##删除虚拟环境
conda remove -n xxxx --all   #创建xxxx虚拟环境


## 清理（conda瘦身）
conda clean -p      #删除没有用的包
conda clean -t      #删除tar包
conda clean -y --all #删除所有的安装包及cache

```

!!!info "参考文献"

    [Python虚拟环境，学会这篇就够了](https://mp.weixin.qq.com/s/JRUtixkgEOLCvI1PGlA45A)

    [conda常用命令](https://blog.csdn.net/zhayushui/article/details/80433768)

## 3.IPython

IPython 是一个第三方工具，因此，在使用之前需要先安装。可以直接使用操作系统的包管理工具或 pip 进行安装。如下所示：

=== "apt 安装"

    ```shell
    sudo apt-get install -y ipython

    # 在 Ubuntu 20.04 上，默认的 IPython 包已被分割为 ipython3 和 ipython
    sudo apt install -y ipython3
    ```

=== "pip 安装"

    ```shell
    pip install ipython
    ```

IPython 提供的使用说明

| 命令             | 解释说明                                                 |
| ---------------- | -------------------------------------------------------- |
| ?                | 介绍 IPython 的特征                                      |
| %quickref        | IPython 的使用手册                                       |
| help             | Python 的内置帮助系统                                    |
| object?/object?? | 获取 Python 对象的信息、如帮助信息、对象定义、对象源码等 |

常用操作

- ? ：放在被查方法或者命令的前后，一个?查看详细信息。??可以查看源代码(如果有)。
- \* ：通配符，可以放在名字中间，结合?一起，补全功能比 tab 键还强大。
- ! : 以!起头，可以执行在系统 shell 中可以执行的命令（实际上也是在系统 shell 中执行的）。比如在 IPython 下，可以运行 !python 和 !pip 等命令。
- \_: 打印前输出结果
- %run: 命令当做 Python 程序来运行，输入%run 路径+文件名称即可，运行完毕会导入文件的变量、函数、方法到当前环境中
- %run -d: 交互式调试器
- ! shell_command: 执行 shell 命令
- %load: 加载代码%load 命令用于将脚本代码加载到当前 cell。
- %save: 保存 cell %save path.py n1 n2..命令用于将指定 cell 代码保存到指定的 py 文件中。
- %debug: 交互式调试器 %debug 命令支持从最新的异常跟踪的底部进入交互式调试器。在 ipdb 调试模式下能访问所有的本地变量和整个栈回溯。使用 u 和 d 向上和向下访问栈，使用 q 退出调试器。在调试器中输入?可以查看所有的可用命令列表。

参考文献：

- https://cloud.tencent.com/developer/article/1971873
- https://www.osgeo.cn/python-tutorial/ipython.html

示例：

```sh
In [5]: import os

In [6]: ?os.path.is*
os.path.isabs
os.path.isdir
os.path.isfile
os.path.islink
os.path.ismount

In [9]: ?os.path.ba*
os.path.basename

In [10]: os.path.isfile?
Signature: os.path.isfile(path)
Docstring: Test whether a path is a regular file
File:      /usr/lib64/python3.6/genericpath.py
Type:      function

In [11]: os.path.isfile??
Signature: os.path.isfile(path)
Source:
def isfile(path):
    """Test whether a path is a regular file"""
    try:
        st = os.stat(path)
    except OSError:
        return False
    return stat.S_ISREG(st.st_mode)
File:      /usr/lib64/python3.6/genericpath.py
Type:      function

# 强大的magic函数
In [18]: %lsmagic
Out[18]:
Available line magics:
%alias  %alias_magic  %autoawait  %autocall  %autoindent  %automagic  %bookmark  %cat  %cd  %clear  %colors  %conda  %config  %cp  %cpaste  %debug  %dhist  %dirs  %doctest_mode  %ed  %edit  %env  %gui  %hist  %history  %killbgscripts  %ldir  %less  %lf  %lk  %ll  %load  %load_ext  %loadpy  %logoff  %logon  %logstart  %logstate  %logstop  %ls  %lsmagic  %lx  %macro  %magic  %man  %matplotlib  %mkdir  %more  %mv  %notebook  %page  %paste  %pastebin  %pdb  %pdef  %pdoc  %pfile  %pinfo  %pinfo2  %pip  %popd  %pprint  %precision  %prun  %psearch  %psource  %pushd  %pwd  %pycat  %pylab  %quickref  %recall  %rehashx  %reload_ext  %rep  %rerun  %reset  %reset_selective  %rm  %rmdir  %run  %save  %sc  %set_env  %store  %sx  %system  %tb  %time  %timeit  %unalias  %unload_ext  %who  %who_ls  %whos  %xdel  %xmode

Available cell magics:
%%!  %%HTML  %%SVG  %%bash  %%capture  %%debug  %%file  %%html  %%javascript  %%js  %%latex  %%markdown  %%perl  %%prun  %%pypy  %%python  %%python2  %%python3  %%ruby  %%script  %%sh  %%svg  %%sx  %%system  %%time  %%timeit  %%writefile

Automagic is ON, % prefix IS NOT needed for line magics.
```

以下是一些常用的 magic 函数及其简介：

- %run：运行 Python 脚本或 Jupyter notebook。
- %timeit：测量代码的执行时间。
- %matplotlib：启用 matplotlib 图形化库。
- %reset：清除所有定义的变量和名称空间。
- %who：列出当前定义的所有变量。
- %whos：列出当前定义的所有详细信息。
- %pwd：显示当前工作目录。
- %cd：更改当前工作目录。
- %ls：列出当前目录下的文件。
- %env：列出当前环境变量。
- %history：列出命令历史记录。
- %%writefile：将 cell 中的内容写入到文件中。
- %load：将文件中的内容加载到 cell 中。
- %debug：进入交互式调试器。
- %pdb：在异常发生时自动进入调试器。
- %time：测量单个语句的执行时间。
- %prun：使用分析器运行代码并生成性能报告。
- %run -p：使用分析器运行代码并生成性能报告。
- %run -t：使用跟踪器运行代码并生成性能报告。
- %run -d：使用调试器运行代码并生成性能报告。

这些 magic 函数可以提高 ipython 的交互性和生产力。使用它们可以更好地管理内存、调试代码、测量代码执行时间等。

安装完成以后，在命令行终端输入 ipython 就进入了 IPython 交互式编程界面：

```shell
$ ipython
Python 2.7.3 (default, Jun 21 2016, 18:38:19)
Type "copyright", "credits" or "license" for more information.

IPython 0.13.1 -- An enhanced Interactive Python.
?         -> Introduction and overview of IPython's features.
%quickref -> Quick reference.
help      -> Python's own help system.
object?   -> Details about 'object', use 'object??' for extra details.
```

一个典型的 MySQL 物理备份日志如下所示：

即使读者对 MySQL 不了解也没有关系，我们现在的需求是解析下面这一行日志，并获取日志中的 host、filename 和 position 的值。虽然在日志中 position 的值包含在一对单引号内，但是，我们希望解析以后 position 的值是一个整数。

```shell
MySQL slave binlog position: master host '10.173.33.35', filename 'mysql-bin.000002', position '524993060'
```

在这个例子中，主要就是对字符串进行处理，并提取相应的值。

这个问题当然不难，但是，如果不借助交互式编程工具，需要工程师一次在代码中编写正确也不简单。

如果工程师不知道交互式编程工具，就只能在编辑器里面编写代码，然后运行。如果有错误再修改，直到获取正确的取值，整个过程将会非常耗时。

**如果项目庞大，调试起来也会比较困难。这个时候就可以借助 Python 的交互式编程工具，先验证代码的正确性，然后将验证过的代码从交互式编程工具复制到编辑器中。**

如下所示：

```shell
hujianli@hujianli-OptiPlex-7010:~$ ipython
In [1]: line = "MySQL slave binlog position: master host '10.173.33.35', filename 'mysql-bin.000002', position '524993060'"
   ...:

In [2]:  line.split("'")
Out[2]:
['MySQL slave binlog position: master host ',
 '10.173.33.35',
 ', filename ',
 'mysql-bin.000002',
 ', position ',
 '524993060',
 '']

In [3]: host = line.split("'")[1]
   ...:

In [4]: filename = line.split("'")[3]

In [5]: position = line.split("'")[5]

In [6]: print(host, filename, position)
10.173.33.35 mysql-bin.000002 524993060

In [7]: type(position)
Out[7]: str

In [8]: position = int(position)

In [9]: print(host, filename, position)
10.173.33.35 mysql-bin.000002 524993060
```

**ipython 的优势**

1. 运行 ipython 控制台
2. 使用 ipython 作为系统 shell
3. 使用历史输入(history)
4. Tab 补全
5. 使用%run 命令运行脚本
6. 使用%timeit 命令快速测量时间
7. 使用%pdb 命令快速 debug
8. 使用 pylab 进行交互计算
9. 使用 IPython Notebook

[IPython 技巧](https://www.cnblogs.com/chenqionghe/p/12217529.html)

## 4.jupyter 的使用

Jupyter（猪皮特）

### 4.1 jupyter 介绍

jupyter 就是以前的 IPython Notebook，是一种新兴的交互式数据分析与记录工具。

它通过浏览器访问本地或者远端的 IPython 进程，并利用浏览器的图形界面，增强 IPython 的可视化输出。jupyter 定义了一种全新的文件格式，文件的后缀名是 ipynb。ipynb 文件包含了代码，用以说明每一步的计算和输出。也就是说，ipynb 文件完整记录了计算过程中的所有相关信息，并且，能够支持图片、视频和公式等副文本格式，是科学计算、数据分析和编程教学的优秀工具。

正是由于 jupyter 丰富的可视化输出，其广泛应用于以下场景：

- 编程教学；

- 数据分析；

- 科学计算；

- 幻灯片演示。

### 4.2 jupyter notebook 的使用

```shell
# 安装 Jupyter 和 Jupyter Notebook 到您的 Python 环境中。
pip install jupyter
pip install jupyter notebook==6.1.0

# 安装 jupyter_contrib_nbextensions 扩展包。
pip install jupyter_contrib_nbextensions

#安装一些插件并启用插件管理器
jupyter nbextensions_configurator install --user
jupyter nbextensions_configurator enable --user
```

开启 jupyter

1.Linux 下，打开命令行，重新生成一个 jupyter 配置文件：

```shell
$ jupyter notebook --generate-config
Writing default config to: /home/hujianli/.jupyter/jupyter_notebook_config.py
```

2.修个配置文件，找到这个新生成的文件：

- Linux: `/home/hujianli/.jupyter/jupyter_notebook_config.py`

- Windows: `C:\Users\18793\.jupyter\jupyter_notebook_config.py`

```
搜索 NotebookApp.allow_password_change，改为：NotebookApp.allow_password_change=False ，记得去掉注释的#
```

3.回到 Linuxs 命令行，运行 jupyter notebook password

```shell
$ jupyter notebook password

# 输入两次密码,我这里设置123456 测试使用
Enter password:
Verify password:
[NotebookPasswordApp] Wrote hashed password to /home/hujianli/.jupyter/jupyter_notebook_config.json
```

在 jupyter_notebook_config.py 中找到下面的行，取消注释并修改。

```shell
$ cat /home/hujianli/.jupyter/jupyter_notebook_config.py|grep -v "^#"|grep -v "^$"
c.NotebookApp.allow_credentials = False
c.NotebookApp.allow_password_change = False
# 星号代表任意ip，这个跟mysql的权限设置一样，所以说是互通的
c.NotebookApp.ip = '*'
c.NotebookApp.notebook_dir = '/data/jupyter'
#不自动打开浏览器
c.NotebookApp.open_browser = False
#就是把生成的密码json文件里面的一串密码放这里
c.NotebookApp.password = 'argon2:$argon2id$v=19$m=10240,t=10,p=8$Fg1/ibZ7CifMOahxeKVefw$QCIAXslhaDonokdqoHXx+Q'
#可自行指定一个端口, 访问时使用该端口
c.NotebookApp.port = 9999
```

```shell
# 可以通过设置--no-browser和--ip=0.0.0.0 进行外部访问。如果不指定ip，默认IP是localhost，也就是只有本地才能访问。
# 开启时，自动弹出浏览器
jupyter notebook


#后台运行：
nohup jupyter notebook >~/jupyter.log 2>&1 &
```

点击 Nbextensionsa 安装插件。

下面列举几个比较有用的扩展

```shell
Code prettify
Codefolding
Collapsible Headings
ExecuteTime
Highlight selected word
Highlighter
Hinterland
Notify
Scratchpad
Toggle all line numbers
Table of Contents (2)
Variable Inspector
table of content
snippets
codefolding
autopep8
hide input
split cell notebook
zenmode
```

[jupyter-lab 启动一个类似在线编辑的页面](https://mp.weixin.qq.com/s/RHFDU3w4E2fwB437PxiLuQ)

[玩转 Jupyter Notebook2-(推荐 16 个超实用插件)](https://zhuanlan.zhihu.com/p/258976438?utm_oi=803714813804044288)

!!! example "参考文献"

    [Jupyter Notebook配置使用教程](https://zhuanlan.zhihu.com/p/54302333)

    [Jupyter Notebook入门教程(超详细)](https://blog.csdn.net/qq_40918859/article/details/125067935)

    [泣血整理，Jupyter Notebook最常用的五大配置技巧](https://zhuanlan.zhihu.com/p/166165379)

## 5.Pycharm

官方下载地址: [传送门](https://www.jetbrains.com/pycharm/download)

### 5.1 Pycharm 破解

参考文献：

- https://www.quanxiaoha.com/goland-pojie/goland-pojie-202421.html

将上面文档内容，提取后放置到百度云地址如下

- 链接: https://pan.baidu.com/s/1Su2OnSM2teEgjd-q4D8GRA
- 提取码: bwau

备用地址：

```sh
# 激活脚本网盘下载链接:
链接：https://pan.baidu.com/s/1XAgqbICLKTb3rsim6i8e-g?pwd=c0bh
提取码：c0bh

# 备用链接 1:
链接：https://pan.baidu.com/s/197_7mobtHW1iV3QZXE9pyQ?pwd=w795
提取码：w795

# 备用链接 2（蓝奏网盘）：
https://wwv.lanzouh.com/ivGcA270tnzc
```

!!! info "参考文献"

[python-pycharm windows 安装](https://www.cnblogs.com/scajy/p/9781446.html)

ubuntu20.04 上安装

```sh
sudo snap install pycharm-professional --classic
```

[Linux 软件包管理工具 Snap 常用命令](https://www.jianshu.com/p/70622b2e9c5d)

```sh
# 查看当前已安装的 snap 应用程序列表
$ snap list

# 在 snap 仓库中搜索指定程序
$ snap find solitaire

# 查看 snap 应用程序（简称为 snap）的详细信息
$ snap info solitaire

# snap install 命令可以安装新的 snap：
$ sudo snap install solitaire

# 如果需要删除某个 snap，使用 snap remove 命令即可：
$ sudo snap remove solitaire

```

> 注意 也可以通过禁用来代替删除。使用 `snap disable` 命令即可。要想重新恢复 snap，可以使用 `snap enable` 命令。

### 5.2 Pycharm 中使用 GitHub

!!! example "参考文献"

    https://www.cnblogs.com/feixuelove1009/p/5955332.html

### 5.3 Pycharm 常用快捷键大全

Pycharm 中一些不为人知的技巧

| 功能                               | 说明                                                                                                       |
| ---------------------------------- | ---------------------------------------------------------------------------------------------------------- |
| 快速查找文件                       | 用快捷`Ctrl + E`可打开最近访问过的文件或者用`Ctrl+Shift+E`打开最近编辑过的我文件                           |
| 万能搜索                           | 连续按两下 Shitf 键可以搜索文件名、类名、方法名，还可以搜索目录名，搜索目录的技巧是在在关键字前面加斜杠/。 |
| 全局项目范围内搜索文件里面的关键字 | `Ctrl + Shfit + F`，或者 `Ctrl + Shfit + R`全局替换                                                        |
| 历史粘贴版                         | `Ctrl + Shift + V`可访问历史粘贴板                                                                         |
| 分割窗口                           | Pycharm 的默认配置没有设置分割的快捷键,你可以在 Settings 中的 Keymap 自定义快捷键                          |
| 智能提示                           | 使用`Alt + Enter`智能提示你选择合适的操作                                                                  |
| 任意位置换行                       | 使用`Shfit + Enter`另起一行，这样无需把光标移到末尾去操作                                                  |
| 单行执行某段代码                   | 单行执行：选中代码然后`alt +shift + e`                                                                     |

**编辑**

| 快捷键                   | 说明                                |
| ------------------------ | ----------------------------------- |
| Ctrl + Space             | 基本代码完成                        |
| Ctrl + Alt + Space       | 快速导入任意类                      |
| Ctrl + Shift + Enter     | 语句完成                            |
| Ctrl + P                 | 参数信息                            |
| Ctrl + Q                 | 快速查看文档                        |
| F1                       | Web 文档                            |
| Shift + F1               | 进入 web 文档主页                   |
| Ctrl + Shift + Z         | 重做                                |
| Ctrl +                   | 悬浮/单击鼠标左键 简介/进入代码定义 |
| Ctrl + F1                | 显示错误描述/警告信息               |
| Alt + Insert             | 自动生成代码                        |
| Ctrl + O                 | 重新方法                            |
| Ctrl + Alt + T           | 选中                                |
| Ctrl + /                 | 行注释/取消行注释                   |
| Ctrl + Shift + /         | 块注释/取消块注释                   |
| Ctrl + W                 | 选中增加的代码块                    |
| Ctrl + Shift + W         | 回到之前状态                        |
| Ctrl + Shift + ]/[       | 选定代码块结束/开始                 |
| Alt + Enter              | 快速修正                            |
| Ctrl + Alt + L           | 代码格式化                          |
| Ctrl + Alt + O           | 优化导入                            |
| Ctrl + Alt + I           | 自动缩进                            |
| Tab / Shift + Tab        | 缩进/取消缩进                       |
| Ctrl+X/Shift+Delete      | 剪切                                |
| Ctrl+C/Ctrl+Insert       | 复制                                |
| Ctrl+V/Shift+Insert      | 粘贴                                |
| Ctrl + Shift + V         | 最近缓冲区粘贴                      |
| Ctrl + D                 | 复制                                |
| Ctrl + Y                 | 删除                                |
| Ctrl + Shift + J         | 添加智能线                          |
| Ctrl + Enter             | 智能线切割                          |
| Shift + Enter            | 换行                                |
| Ctrl + Shift + U         | 区域或代码块间切换                  |
| Ctrl + Delete            | 删除到字符末尾                      |
| Ctrl + Backspace         | 删除到字符开始                      |
| Ctrl + Numpad+/-         | 展开/折叠代码块                     |
| Ctrl + shift + Numpad+/- | 展开/折叠所有代码块                 |
| Ctrl + F4                | 关闭选项卡                          |

**查找/替换**

| 快捷键                              | 说明                   |
| ----------------------------------- | ---------------------- |
| F3                                  | 下一个                 |
| Shift + F3                          | 前一个                 |
| Ctrl + R                            | 替换                   |
| Ctrl + Shift + F 或 连按 2 次 shift | 全局查找               |
| Ctrl + Shift + R                    | 全局替换               |
| alt +shift + e                      | 单行执行：选中代码执行 |

**运行和调试**

| 快捷键             | 说明                |
| ------------------ | ------------------- |
| Alt + Shift + F10  | 运行模式配置        |
| Alt + Shift + F9   | 调试模式配置        |
| Shift + F10        | 运行                |
| Shift + F9         | 调试                |
| Ctrl + Shift + F10 | 运行编辑器配置      |
| Ctrl + Alt + R     | 运行 manage.py 任务 |
| Shift + F8         | 退出                |
| Alt + F9           | 运行游标            |
| Alt + F8           | 验证表达式          |
| Ctrl + Alt + F8    | 快速验证表达式      |
| F9                 | 恢复程序            |
| Ctrl + F8          | 断点开关            |
| Ctrl + Shift + F8  | 查看断点            |

!!! info "Pycharm 教程"

      [20个Pycharm最实用最高效的快捷键(动态展示)](https://mp.weixin.qq.com/s/e5uMtf8Ss6tDjchOZyW-hw)

      [Pycharm教程](https://www.yiibai.com/pycharm)

!!! tip "Pycharm 常用快捷键"

      https://mp.weixin.qq.com/s/1KNb8QCa1dPu8fAi41Ci9A
      https://www.cnblogs.com/mollyviron/p/9297381.html
      https://www.2bboy.com/archives/153.html

### 5.4 Pycharm 插件

1. Chinese (Simplified) Language Pack EAP: 汉化
2. .ignore: git .ignore 模板
3. .env file support: .env 文件格式支持
4. CodeGlance Pro: 代码小地图嵌入到编辑器窗格中。 使用自定义颜色进行语法高亮，同时使用明暗主题。
5. Key Promoter X: 如何用键盘键替换繁琐的鼠标工作。
6. Rainbow Brackets: 通过颜色，快速区分括号对应的代码块。
7. TONGYI Lingma is an AI : 支持中文，支持自定义模型。
8. Requirement: 自动检查 Requirement 文件是否和实际环境匹配
9. Translation: 翻译。
10. Material Theme UI: Material Theme UI 也是一个通用的 UI 主题，美化 UI 界面，免费版提供的功能足够使用。
11. Atom Material Icons: 美化 Pycharm 图标。
12. Json Parser: 在右侧有显示，JSON Parser 是一个用于验证和格式化 JSON 字符串的轻量级插件。
13. Git Commit Template: 参考被提倡的 git cimmit 规范。
14. GitToolBox: 可以在代码中很方便的获取 git commit 信息。
15. kubernetes：Kubernetes support
16. Jenkins Pipeline Linter: Jenkinsfile 文件语法检查
17. Python smart execute: 选中测试部分代码，右键 execute，在控制台 debug 选中部分代码
18. ReST Console: 测试 API 接口
19. Reloadium: Python 热重载调试工具。它可以在不重新运行程序的前提下，查看程序修改后的运行效果
20. .env files support: 配置文件支持
21. Json parse: json 字符在线格式校验
22. Codeium: ai 代码生成和补全，是一款很好用的个人免费 AI 代码自动提示工具，是 Copilot（收费）的平替。
23. Cody： AI 编程助手，通过阅读整个代码库和代码图，帮助开发人员写代码并回答问题。

参考文献： https://szthanatos.github.io/series/wsl2/coding_with_wsl2_08/

Codeium 在 IDEA 里的 3 个坑：

- 无法 log in
- downloading language server
- 中文乱码

解决办法： <https://blog.csdn.net/zhtisi/article/details/130790718>

【AI】Codeium：强大且免费的 AI 智能编程助手

参考文献：

<https://blog.verysu.com/aritcle/ai/1409>

### 5.5 Pycharm 文件自动添加说明

1. 打开 pycharm，选择 File-Settings
2. 依次选择 Editor--Color&Style--File and Templates--Python-Script，并在图中编辑模板内容

Pycharm 中设置 py 文件头部注释信息

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Copyright: (c)  : @Time ${DATE} ${HOUR}  @Author  : hjl
# @Site    : ${SITE}
# @File    : ${NAME}.py
# @Project: ${PROJECT_NAME}
# @Software: ${PRODUCT_NAME}
# @Desc    :
# GNU General Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)
```

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Author hjl
# Copyright (c) 2024 Hewlett-Packard Development Company, Hjl.
# All Rights Reserved.
#
#    Licensed under the Apache License, Version 2.0 (the "License"); you may
#    not use this file except in compliance with the License. You may obtain
#    a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
#    Unless required by applicable law or agreed to in writing, software
#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
#    License for the specific language governing permissions and limitations
#    under the License.
```

也可以 在 Python 程序在头部添加 GPL 许可证信息

```python
"""
GNU General Public License v3.0

Copyright (C) 2024 hjl

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.
"""
```

shell 脚本模版

```sh
#!/bin/bash
#####################################
# @Project Name : ${PROJECT_NAME}
# @Author       : hjl
# @Version: v1.0.0
# @Time         : ${DATE} ${TIME}
# @File         : c
# @Software     : ${PRODUCT_NAME}
# @Description  : scripts function describe
# @Usage: ./${NAME}.sh
#####################################
```

```sh
#!/bin/bash
###############################################################
######        scripts function describe
######        Author：hjl
######        Create_Date：${DATE} ${TIME}
######        LastModified：${DATE} ${TIME}
######        Warning：notice Yum Dir Path
###############################################################
```

可参考

PyCharm 预定义创建代码模板

- https://blog.gxusb.com/archives/pycharm-code-template.html

Pycharm 高级配置 自定义文件、方法模板

- https://www.cnblogs.com/lduml/p/12681821.html

### 5.6 Pycharm 自动生成注释内容

Docstring format 可通过下方路径进行设置，包括五种风格：Plain、Epytext、reStructuredText、Numpy、Google。

File -> Settings -> Tools -> Python Integrated Tools -> Docstrings -> Docstring format

参考文献：

- https://blog.csdn.net/dkjkls/article/details/88933950

### 5.7 Pycharm 远程开发调试

[Pycharm 远程开发调试](https://www.yuque.com/wslynn/python/pt9ntg#KrD5l)

[pycharm 远程 ssh 调试](https://www.yuque.com/wei01/tl0iqs/og504c)

[Pycharm 使用远程的 python 环境](https://blog.51cto.com/u_14457/8632291)

### 5.8 PyCharm 配置 Vue 编码环境

PyCharm 配置 Vue 编码环境只需在 PyCharm 中安装 Vue 插件即可。

PyCharm 再次打开项目文件夹 books_frontend 后，下一步在 PyCharm 配置 Vue 的运行指令。

单击界面右上方的 Add Configuration...打开 Run/Debug Configurations 界面；

然后在当前界面单击“+” 按钮并选择 npm 选项；最后在 npm 配置界面的 Scripts 中填写 serve 即可。

## 6. VSCode

### 6.1 软件准备

鉴于 PyCharm 是收费的工具，不少同学在想方设法寻找破解之法。

而 VSCode 是免费开源的工具，并且是微软旗下产品，如果能够媲美 PyCharm 的话，也不失为一个良好的选择。

VSCode 是一个相当优秀的 IDE ，具备开源、跨平台、模块化、插件丰富、启动时间快、颜值高、可高度定制等等优秀的特质，最近几年流行度也是越来越高。

今天来跟大家分享下在 VSCode 下配置和使用 Python ，作为对 PyCharm 的替代选择之一。

### 6.2 Python 安装

关于 Python 的安装，可以从 Python 官网下载 Python 进行安装，也可以通过 Anaconda 来安装，建议直接安装`Anaconda`。

`Anaconda`是一个开源的 Python 发行版本，其包含了 conda 、 Python 等 100 多个科学包及其依赖项。

> Anaconda 官方网站下载地址如下：

> <https://www.anaconda.com/products/individual>

在编写此文时， Anaconda 对应的 Python 版本是 Python 3.8 ，大家可以下载跟电脑系统对应的版本进行安装。

!!! example "更多参考"

    [conda的安装与使用 2.0版](https://www.jianshu.com/p/edaa744ea47d)

    [conda常用命令](https://blog.csdn.net/zhayushui/article/details/80433768)

    [Python软件包及环境管理器conda实战篇](https://www.cnblogs.com/yinzhengjie/p/13659317.html)

### 6.3 VSCode 安装

关于 VS Code 安装，在微软官方网站：

提供免费下载，

> <https://code.visualstudio.com>

VS Code 支持 Windows, Linux , Mac OS 三种操作系统，建议去官方下载，不要在第三方软件下载网站下载。

### 6.4 在终端运行程序

安装 python 插件包

<https://marketplace.visualstudio.com/items?itemName=donjayamanne.python-extension-pack>

安装 pylint 及 pylint-django

```sh
pip install pylint pylint-django
```

在没有安装其他 Python 插件的情况下，可以在 VSCode 中通过使用终端(Terminal)直接运行 python 代码,使用这种方式，可以省去配置过程。

在 VS Code 菜单栏选择 “view - Terminal” （中文菜单：查看 — 终端），或者直接快捷键`「 Ctrl + ‘ 」`打开终端，会在下方产生一个 CMD 控制台。

可以在终端中通过输入`python xxx.py`来运行程序，效果如下：

```shell

$ python3 hello-world.py
Hello world
```

### 6.5 vscode 常用插件

下面介绍下几个常用的插件：

!!! info "python 相关"

    - Chinese Languate Pack：中文语言包，简体中文包
    - jackiotyu/vscode-quick-reference：备忘清单-开发者快速参考 (Reference)
    - Python: 提供了代码分析，高亮，规范化，以及重构等很多基本功能
    - Python Extension Pack: 这个扩展包打包了一些最流行的Python扩展。
    - Pylance ：类型信息、自动导入、类型检查诊断等相关功能
    - Livecode for Python：可以实时查看python变量，加强了vscode的debug和可视化能力。
    - Python Snippets(Ferhat Yalçın)：输入命令生成代码片段 pro
    - python snippets: 输入命令生成代码片段
    - Python Snippets 3 (Pro)：输入命令生成代码片段 pro
    - Better Comments：该插件可以帮助开发者准确的注释代码
    - Python Indent：换行自动正确缩进
    - Project Manager 这是用来管理你的代码的项目的插件，通过这个插件就可以实现在不同的项目中互相切换
    - MarsCode AI: Coding Assistant： 豆包 字节的AI模型
    - indent-rainbow-blocks：高亮（每行代码之前的）缩进 使得代码前的缩进有颜色标注，便于查看各个代码行的缩进位置
    - Bracket Pair Colorizer: 列出来括号高亮的效果，尤其是多组嵌套括号
    - Markdown Preview Enhanced：Markdown插件
    - Markdown All in One: 写Markdown时的语法自动补全等
    - One Dark Pro: VSCode自带的主题用着怎么也不爽、所以想着换一个、找了很久之后遇到了One Dark Pro
    - vscode-icons/Material Icon Theme: 显示图标,文件图标集，支持绝大部分文件类型；给不同类型的文件显示不同的图标
    - flake8: 代码错误提示.安装flake8之后写代码的时候编辑器就会提示哪里出错，代码格式不规范也会提示
    - yapf: 自动格式化代码,安装yapf之后在VScode中按Alt+Shift+F即可自动格式化代码
    - Python Docstring Generator: 自动生成函数的注释格式，通过tab键快速切换填充编写相应的注释
    - Path Autocomplete: 自动感知当前目录下所有的文件，只需要您选择就行
    - koroFileHeader：文件头注释（ctrl+alt+i） 和函数头注释（ctrl+alt+t）快捷工具，使用快捷键一键生成；
    - Gitlens：可以帮助你管理github，也可以查看历史记录
    - Settings Sync：自动将VS code的配置上传到
    - Pylnit:快捷生成_init_文件。
    - Git History Diff: 显示git历史修改记录和git历史提交
    - Git Graph： 视图显示git graph分支和commit历史
    - Python Debugger：Python调试插件
    - Pip Manager: 安装包管理
    - Python Environment Manager：Python虚拟环境管理
    - Guides: 缩进虚线阅读起来会非常的优美。

!!! info "前端相关"

    - Auto Rename Tag：重命名一个HTML / XML标签时，自动重命名配对的HTML / XML标签。
    - Beautify:在VS code中美化javascript，JSON，CSS，Sass和HTML。
    - Easy LESS:每次保存less文件时，自动生成一个css文件。
    - HTML Preview：在vs code中预览html文件。
    - JS-CSS-HTML Formatter：此扩展程序包装了js-beautify，可以格式化JS，CSS，HTML，JSON文件。
    - px to rem & rpx (cssrem)：在单位px和rem间相互转化。
    - Vetur：美化VUE代码的模块，支持高亮，格式化，错误检查等功能。

!!! info "shell 相关"

    - shellman: 智能提示和自动补全，shellman全部搞定
    - Visual Studio Code Shell Snippets: Shell Snippets 智能提示和自动补全
    - Better Shell Snippets: Shell Snippets 智能提示和自动补全
    - shellcheck: 语法错误检查
    - shell-format: 脚本格式化(快捷键：Alt+Shift+F)
    - Code Runner：右键运行

!!! info "k8s 相关"

    - Kubernetes: DevOps人员对Kubernetes应用程序进行故障排除。
    - Kubernetes Apply: 通过kubectl来应用和移除yaml文件
    - Kubernetes Snippets：生成kubernetes yaml模版文件
    - Kubernetes Templates：生成kubernetes yaml模版文件
    - Kubernetes YAML Formatter： kubernetes yaml文件格式化

配置 VSCode 舒心的写 Python 代码

- https://huaisha1224.github.io/2019/02/13/VSCode-for-Python/

VS Code 搭建编写 Shell 环境（WSL）

- https://www.cnblogs.com/testopsfeng/p/13190839.html

vscode python 环境配置

- https://www.yswqjymdx.com/posts/vscode-python环境配置/

史上最好用的编辑器：VSCode

- https://book.crifan.org/books/best_editor_vscode/website/

### 6.6 vscode settings 常用的设置

常用配置(settings.json)

```json
{
  // 工作台主题和图标配置
  "workbench.colorTheme": "Default Dark+", // 设置VSCode的颜色主题为默认的暗色主题。
  "workbench.iconTheme": "material-icon-theme", // 设置VSCode的图标主题为Material图标主题,需要安装Material Icon Theme扩展
  // Git配置
  "git.enableSmartCommit": true, // 启用智能提交，允许在暂存所有更改时直接提交。
  "git.ignoreLegacyWarning": true, // 忽略Git的旧版本警告。
  "git.autofetch": true, // 启用Git自动拉取。
  "git.confirmSync": false, // 在同步Git存储库时不需要确认。
  "gitlens.historyExplorer.enabled": true, // 启用Git历史记录浏览器扩展。
  "explorer.confirmDragAndDrop": false, // 在文件资源管理器中拖放文件时不需要确认。
  "search.followSymlinks": false, // 在搜索时不要跟随符号链接。
  // 编辑器配置
  "editor.bracketPairColorization.enabled": true, // 启用括号颜色匹配。
  "editor.guides.bracketPairs": "active", // 在活动括号对旁边显示引导线。
  "editor.tabSize": 2, // 设置编辑器的缩进大小为2个空格。
  "editor.detectIndentation": false, // 禁用自动检测缩进
  "editor.parameterHints.enabled": false, //输入时函数参数提示
  "editor.formatOnSave": true, // #值设置为true时，每次保存的时候自动格式化；
  "editor.formatOnType": true, //输入一行时格式化代码
  "editor.formatOnPaste": true, //黏贴时格式化代码
  "editor.suggest.snippetsPreventQuickSuggestions": true, // 启用自动建议。
  "eslint.format.enable": true,
  "editor.mouseWheelZoom": true, // 允许使用鼠标滚轮进行缩放。
  "update.mode": "none", // 禁用自动更新。
  // 删除二次确认,可以使用 cmd + z 撤销掉删除行为
  "explorer.confirmDelete": false,
  // Internal terminal
  // 使用 code runner 作为终端
  "code-runner.runInTerminal": true,
  // 每次默认打开终端的 path 在当前打开的文件目录下
  "code-runner.fileDirectoryAsCwd": true,
  "editor.defaultFormatter": null,
  "editor.wordWrap": "on", // 启用自动换行
  "editor.fontSize": 16, // 编辑器中的字体
  "editor.lineHeight": 17, // 设置编辑器的行高为17。
  "editor.lineNumbers": "on", //开启行数提示
  "editor.rulers": [79, 120], // 设置编辑器标尺
  "editor.renderLineHighlight": "all", //当前行高亮方式
  "editor.hover.delay": 300, // 显示缩进指南。
  "editor.indentGuides": "none", //缩进参考线显示
  "editor.snippetSuggestions": "top", // 控制代码片段的建议是如何显示,是否允许自定义的snippet片段提示
  "editor.quickSuggestions": {
    //开启自动显示建议
    "other": true,
    "comments": true,
    "strings": true
  },
  // 代码片段支持 tab-completion,on: 打开tab-completion 功能。
  // off: 关闭 tab-completion 功能，这是_默认值_。onlySnippets: 只对代码片段打开 tab-completion。
  "editor.tabCompletion": "onlySnippets",
  "editor.codeActionsOnSave": {
    "source.fixAll": "explicit",
    "source.fixAll.eslint": "explicit",
    "source.organizeImports": "explicit"
  },
  "workbench.colorCustomizations": {
    // 定制工作台颜色。
    "editorRuler.foreground": "#ff4081" // 设置标尺前景色为粉色。
  },
  "editor.suggestSelection": "first", // 设置建议列表的选择行为。
  "files.autoGuessEncoding": true, // 启用文件编码自动猜测。
  "breadcrumbs.enabled": false, // 禁用面包屑导航。
  // 文件保存配置
  "files.autoSave": "onFocusChange", //失去焦点后自动保存
  "files.autoSaveDelay": 500,
  "files.trimTrailingWhitespace": true, // 保存时自动去除文件末尾的空白字符。
  "files.trimFinalNewlines": true, // 保存时自动去除文件末尾的换行符。
  "files.encoding": "utf8", // 设置文件编码为UTF-8。
  "files.eol": "\n", // 行尾序列"\n",linux uninx格式
  "bashIde.shfmt.simplifyCode": true,
  "terminal.integrated.inheritEnv": false, // 不继承外部环境变量。
  "vetur.experimental.templateInterpolationService": true, // 启用Vetur的模板插值服务。
  "terminal.integrated.env.windows": {
    // 为Windows终端设置环境变量
    "PYTHONPATH": "${workspaceFolder}" // 设置PYTHONPATH环境变量。
  },
  // 插件配置
  "extensions.ignoreRecommendations": false, // 关闭 vscode 推荐插件的行为
  "extensions.autoUpdate": "onlyEnabledExtensions", // 仅对已启用的扩展进行自动更新。
  // 语言特定配置
  "[markdown]": {
    "editor.wordWrap": "on",
    "editor.quickSuggestions": {
      "comments": "off",
      "strings": "off",
      "other": "off"
    }
  },
  "[json]": {
    // 对json文件，使用 JSON语言功能 进行格式化
    "editor.defaultFormatter": "vscode.json-language-features"
  },
  "[typescript]": {
    "editor.tabSize": 2
  },
  "[javascript]": {
    "editor.tabSize": 2
  },
  "[python]": {
    "editor.tabSize": 4, // Python文件的Tab大小
    "editor.insertSpaces": true, // 插入空格而不是Tab
    "editor.rulers": [79, 120], // 显示80和140字符的参考线
    "editor.renderWhitespace": "all", // 显示所有空白字符
    "editor.wordWrap": "off", // 关闭单词换行
    "editor.formatOnSave": true, // 在保存时自动格式化代码
    "editor.defaultFormatter": "ms-python.black-formatter", // 设置Python的默认格式化工具为Black 需先安装 pip install black
    "editor.formatOnType": true
  },
  "python.formatting.blackArgs": [
    "--skip-string-normalization",
    "--line-length 120"
  ],
  "python.analysis.useLibraryCodeForTypes": true, // 使用库代码进行类型推断
  "python.formatting.provider": "black", // 使用Black作为代码格式化工具
  // "python.formatting.provider": "yapf", ///启用yapf，首先需要pip3 install yapf
  "python.linting.flake8Enabled": true, // 启用Flake8进行代码检查,首先需要pip3 install falke8
  "python.linting.pylintEnabled": false, // 启用Pylint进行代码检查
  "python.linting.enabled": true, // 启用Python代码检查
  "python.languageServer": "Pylance",
  "python.jediEnabled": true,
  "python.autoComplete.addBrackets": true,
  "python.linting.flake8Args": [
    // 设置Flake8的最大行长度
    "--max-line-length=120",
    "--ignore=E501"
  ],
  "python.linting.pylintArgs": [
    // 使用Pylint的Django插件
    "--load-plugins=pylint_django",
    "--disable=all",
    "--max-line-length=100", // 设置最大行长度
    "--enable=F,E,unreachable,duplicate-key,unnecessary-semicolon,global-variable-not-assigned,unused-variable,binary-op-exception,bad-format-string,anomalous-backslash-in-string,bad-open-mode",
    //http://pylint-messages.wikidot.com/all-codes
    "--disable=C0301" // Line too long
  ],
  "pylint.importStrategy": "useBundled",
  "pylint.args": [
    "--disable=invalid-name,missing-module-docstring",
    "--disable=W0612,W0631,W0703,W0621,W0613,W0611,W1308,C0411,C0111,C0103,C0301,C0304,C0305,E1101,R0913,R0914,R0915,R0903",
    "--errors-only",
    "--disable=E0401",
    "--disable-msg=E0611",
    "--disable=C0111",
    "--max-line-length=120"
  ],
  "[shellscript]": {
    "editor.defaultFormatter": "foxundermoon.shell-format", // 设置Shell脚本的默认格式化工具
    "editor.formatOnSave": true // 保存时自动格式化
  },
  "[go]": {
    "editor.defaultFormatter": "gopls", // 设置Golang的默认格式化工具为gopls
    "editor.insertSpaces": false,
    "editor.formatOnSave": true, // 保存时自动格式化
    "editor.codeActionsOnSave": {
      "source.organizeImports": "explicit"
    },
    "editor.suggest.snippetsPreventQuickSuggestions": false
  },
  "go.formatTool": "gofmt",
  "go.lintOnSave": "file",
  "go.autocompleteUnimportedPackages": true,
  "go.installDependenciesWhenBuilding": true,
  "gopls": {
    "build.experimentalWorkspaceModule": true
  },
  "go.toolsManagement.autoUpdate": true,
  "[dockerfile]": {
    "editor.tabSize": 4,
    "editor.insertSpaces": true,
    "editor.wordWrap": "off",
    "editor.autoIndent": "advanced",
    "files.trimTrailingWhitespace": true,
    "files.insertFinalNewline": true,
    "editor.formatOnSave": true,
    "editor.defaultFormatter": "ms-azuretools.vscode-docker.dockerfile"
  },
  "vs-kubernetes": {
    "vs-kubernetes.crd-code-completion": "disabled"
  },
  "code-runner.clearPreviousOutput": true,
  "jenkins.pipeline.linter.connector.url": "http://106.xx.xx.8:30088/pipeline-model-converter/validate",
  "jenkins.pipeline.linter.connector.token": "xxxxx",
  "jenkins.pipeline.linter.connector.user": "admin",
  // 函数注释
  "fileheader.cursorMode": {
    "description": "", // 函数注释生成之后，光标移动到这里
    "param": "", // param 开启函数参数自动提取 需要将光标放在函数行或者函数上方的空白行
    "return": ""
  },
  "workbench.editor.enablePreview": false,
  // vscode 的 diff 行为默认会忽略尾部空字符，为了更精准的控制文件尾，我们需要更加敏感，所以关闭忽略行为。
  "diffEditor.ignoreTrimWhitespace": false,
  "python.analysis.completeFunctionParens": true,
  // 在使用搜索功能时，将这些文件夹/文件排除在外
  "search.exclude": {
    "**/node_modules": true,
    "**/bower_components": true,
    "**/target": true,
    "**/logs": true
  },
  // 这些文件将不会显示在工作空间中
  "files.exclude": {
    "**/.csv": true,
    "**/.parquet": true,
    "**/.pkl": true,
    "**/.xls": true,
    "**/.git": true,
    "**/.svn": true,
    "**/.hg": true,
    "**/CVS": true,
    "**/.DS_Store": true,
    "**/*.js": {
      "when": "$(basename).ts" // ts编译后生成的js文件将不会显示在工作空中
    },
    "**/node_modules": true,
    "**/Thumbs.db": true,
    "**/__pycache__": true,
    "**/*.pyc": true
  },
  "python.analysis.autoImportCompletions": true,
  "workbench.tree.renderIndentGuides": "always",
  "workbench.settings.applyToAllProfiles": ["editor.guides.indentation"],
  "editor.guides.indentation": true,
  // 文件夹紧凑模式显示
  "explorer.compactFolders": false,
  "files.associations": {
    "*.py": "python",
    "*.sh": "shellscript"
  },
  "window.customTitleBarVisibility": "windowed",
  // github copilot settings
  "github.copilot.chat.welcomeMessage": "always",
  // 设置Copilot本地语言
  "github.copilot.chat.localeOverride": "zh-CN",
  // 启用快速建议。使用 Tabnine 或 github copilot 等自动补全插件都需要开启的选项。
  "editor.inlineSuggest.enabled": true,
  // 允许 Copilot 代码操作建议,这些操作可能包括重构代码、优化代码结构、修复可错误等
  "github.copilot.editor.enableCodeActions": true,
  // 允许 Copilot 提供迭代修复建议
  "github.copilot.editor.iterativeFixing": true,
  // 允许 Copilot 提供自动补全
  "github.copilot.editor.enableAutoCompletions": true,
  // 设置 Copilot 生效的文件类型,false 表示禁用copilot, 设置 true 表示启用
  "github.copilot.enable": {
    "plaintext": false,
    "ini": false,
    "markdown": true,
    "*": true
  },
  "github.copilot.advanced": {
    // 生成的代码字数, 默认为 500
    "length": 4000,
    // 内联提示的个数, 默认为3
    "inlineSuggestCount": 5,
    "top_p": 1,
    "temperature": "0.8",
    // 控制Completions Panel中建议个数，默认为 10
    "listCount": 10,
    "stops": {
      "*": ["\n\n\n"],
      "python": ["\ndef ", "\nclass ", "\nif ", "\n\n#"]
    },
    "debug.showScores": true,
    "indentationMode": {
      "python": false,
      "javascript": false,
      "javascriptreact": false,
      "jsx": false,
      "typescript": false,
      "typescriptreact": false,
      "go": false,
      "ruby": false,
      "*": true
    }
  },
  "terminal.integrated.defaultProfile.windows": "Command Prompt"
}
```

VS Code 中的 Python 环境

- <https://vscode.github.net.cn/docs/python/environments#google_vignette>

### 6.7 调试项目

调试快捷键大致如下：

- F5：暂停/继续。
- F10：单步跳过
- F11：单步进入
- Shif + F11：跳出
- F9：切换断点
- Ctrl+F5: 以非调试模式运行

### 6.8 Vscode 配合远程服务器进行 python 项目开发

1.安装插件

插件名称：Remote - SSH 2.配置

[Vscode 配合远程服务器进行 python 项目开发](https://www.cnblogs.com/noob-l/p/14629236.html)

[vscode 实现远程 linux 服务器上 Python 开发](https://www.cnblogs.com/chenhuabin/p/13946762.html)

### 6.9 vscode 同步文件到服务器

1.下载 VScode 并安装 sftp 插件

2.配置

使用快捷键 CTRL+SHIFT+P 打开命令行，选择 SFTP: Config 打开用户设置，即会在项目根目录下生成.vscode 文件夹，修改其中的 sftp.json 文件。

记录我的 json 文件如下所示：

```json
{
    "name": "朝阳服务器",
    "host": "XXXXXX",
    "protocol": "sftp",
    "port": XXX,
    "username": "root",
    "password": "XXX",
    "remotePath": "/root/rsync",
    "uploadOnSave": true,
    "useTempFile": false,
    "openSsh": false,
    "ignore": [
        "**/.vscode/**",
        "**/.git/**",
        "**/.DS_Store"
    ],
    "watcher": {
        "files": "*",
        "autoUpload": false,
        "autoDelete": false
    }
}
```

3.使用

每次保存(CTRL+S)都会将文件同步到服务器上；当需要对全部工程文件进行同步时，可以在 VScode 的文件夹处单击右键进行具体选择。

[vscode 同步文件到服务器](https://www.yuque.com/cuiliang0302/python/fvv3gu3v4lnzbgub)

[VScode 使用 sftp 插件](https://blog.csdn.net/qq_41033254/article/details/107426206)

[VSCode 快捷键集合，动画展示](https://www.vscheatsheet.com/)

!!! tip "vscode 进阶：Python 开发环境配置"

    https://zhuanlan.zhihu.com/p/345806901

    https://www.yuque.com/u2278269/gq5x74/gst4x6

### 6.10 Vscode 配置虚拟环境

- https://www.yuque.com/zziv/python/ws6uhe

## 7.WSL2 开发环境 30 分钟指北

- https://szthanatos.github.io/series/wsl2/

Ubuntu 安装最新版本 Python

- https://szthanatos.github.io/post/python/python_install_on_ubuntu/

## 8.vim 配置 Python 开发环境

```sh
sudo apt-get update # 更新软件列表
sudo apt-get install -y vim # 安装Vim
```

(1)查看用户目录下是否有.vimrc 文件。新安装的 Vim 默认在用户目录下是没有.vimre 配置文件的，所以需要自己手动新建一个.vimrc 文件

```sh
$ mkdir ~/.vim
$ touch .vimrc
# $ ls -la ~/.vim*
-rw------- 1 hujianli hujianli 33802 5月  11 22:13 /home/hujianli/.viminfo
-rw-rw-r-- 1 hujianli hujianli  1815 12月 17 11:17 /home/hujianli/.vimrc

# 查看用户目录下.vim开头的所有文件详细属性，参数-a是该目录下所#有文件，包含隐藏文件。参数-1是显示当前查询显示的文件详细属性
```

(2)下载 Vim 插件管理器。 Vim 插件多元化，每个插件都安装在.vim 下，当插件众多的时候，往往很难区分某个文件是哪个插件的，所以我们通过 pathogen 来进行插件管理。

pathogen 在.vim/bundle 中给每个插件都分配了一个文件夹，这样通过控制这个文件夹就能使得插件的增删容易起来，

```sh
mkdir -p ~/.vim/autoload # 创建autoload目录用于自动加载插件
mkdir -p ~/.vim/bundle #创建 bundle 用于保存插件目录
curl -LSso ~/.vim/autoload/pathogen.vim https://tpo.pe/pathogen.vim # 安装pathogen.vim
```

Vundle

Vim 有多个扩展管理器，但是我们强烈推荐 Vundle。你可以把它想象成 Vim 的 pip。有了 Vundle，安装和更新包这种事情不费吹灰之力。

我们现在来安装 Vundle：

```sh
git clone https://github.com/gmarik/Vundle.vim.git ~/.vim/bundle/Vundle.vim
```

(3)下载 python-mode 插件。 python-mode 是一个集成了语法高亮、断点调试、PEP8 格式化、支持 Python 虚拟环境、自动 Pythor 缩进、代码块折叠显示、代码检查以及代码重构等功能于一体的强大插件。

```sh
cd ~/.vim/bundle/
git clone https://github.com/klen/python-mode.git
```

(4)创建.vimre 文件。新安装的 Vim 默认是没有.vimrc 文件的，需要我们手动新增。

打开文件后，按 ⅰ 进入插入模式，输入下列代码："加载 vim 插件管理器"

```sh
set nocompatible
set history=100
filetype on
filetype plugin on
filetype indent on
set autoread
set mouse=a
syntax enable
set cursorline
hi cursorline guibg=#00ff00
hi CursorColumn guibg=#00ff00
set nofen
set fdl=0
set expandtab
set tabstop=4
set shiftwidth=4
set softtabstop=4
set smarttab
set ai
set si
set wrap
set sw=4
# 使用命令时按Tab键显示图形菜单提示
set wildmenu
set ruler
set cmdheight=1
set lz
set backspace=eol,start,indent
set whichwrap+=<,>,h,l
set magic
set noerrorbells
set novisualbell
set showmatch
set mat=2
set hlsearch
set ignorecase
set encoding=utf-8
set fileencodings=utf-8
set termencoding=utf-8
set smartindent
set cin
set showmatch
set guioptions-=T
set guioptions-=m
set vb t_vb=
set laststatus=2
set pastetoggle=<F9>
set background=dark
syntax on
set nu

highlight Search ctermbg=black  ctermfg=white guifg=white guibg=black
autocmd BufNewFile *.py,*.cc,*.sh,*.java exec ":call SetTitle()"
func SetTitle()
    if expand("%:e") == 'sh'
        call setline(1, "#!/bin/bash")
        call setline(2, "#Author:hujianli")
        call setline(3, "#Blog:http://https://hujianli94.github.io")
        call setline(4, "#Time:".strftime("%F %T"))
        call setline(5, "#Name:".expand("%"))
        call setline(6, "#Version:V1.0")
        call setline(7, "#Description:This is a test script.")
    endif
endfunc


set nocompatible
filetype off
set rtp+=~/.vim/bundle/Vundle.vim

"NERDTree config
map <F4> :NERDTreeToggle<CR>  " F4一键开关目录树
autocmd bufenter * if (winnr("$") == 1 && exists("b:NERDTreeType") &&b:NERDTreeType == "primary") | q | endif  " 当目录树窗口为最后一个窗口时自动退出vim


call vundle#begin()
Plugin 'https://github.com/scrooloose/nerdtree.git'
Plugin 'VundleVim/Vundle.vim'
Plugin 'https://github.com/davidhalter/jedi-vim.git'
call vundle#end()
filetype plugin indent on
```

参考文献：

<https://github.com/python-mode/python-mode>

<https://vim80.readthedocs.io/zh/latest/faq/vimandpython.html>

<https://www.linuxprobe.com/python-mode-vim.html>
