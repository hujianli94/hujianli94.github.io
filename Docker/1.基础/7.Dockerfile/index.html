<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="stay hungry,stay foolish"><meta name=author content=hujainli94><link href=https://hujianli94.github.io/Docker/1.%E5%9F%BA%E7%A1%80/7.Dockerfile/ rel=canonical><link href=../6.Docker%E7%BD%91%E7%BB%9C/ rel=prev><link href=../8.docker-compose/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.11"><title>7.Dockerfile - DevOps运维开发</title><link rel=stylesheet href=../../../assets/stylesheets/main.7e359304.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13.274 9.537v-.001l-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074ZM4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75Z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.484 4.484 0 0 1-.563-1.191 3.835 3.835 0 0 1-.05-2.063 4.647 4.647 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .748.748 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.425 2.425 0 0 1-.507-.441 3.075 3.075 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19a.884.884 0 0 1 .01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.737 3.737 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353V.75Z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343h-.001a8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746Zm1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275ZM6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L6.94 8 4.97 6.03a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018Z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.249 1.249 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429Zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006a.036.036 0 0 0-.004-.009l-.006-.006-.008-.001c-.003 0-.006.002-.009.004Z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.488 3.488 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A4.997 4.997 0 0 1 8 16a4.997 4.997 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5.036 5.036 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.677 1.677 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06Zm.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.172.172 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173Z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5Zm4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0Z"/></svg>');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><link rel=stylesheet href=https://file.cdn.shafish.cn/blog/css/vssue.css><link rel=stylesheet href=https://file.cdn.shafish.cn/blog/css/video-js.min.css><link rel=stylesheet href=https://file.cdn.shafish.cn/blog/css/video.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","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"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","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",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=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",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#7dockerfile class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../.. title=DevOps运维开发 class="md-header__button md-logo" aria-label=DevOps运维开发 data-md-component=logo> <img src=../../../assets/images/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> DevOps运维开发 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 7.Dockerfile </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label=切换至深色模式 type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title=切换至深色模式 for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent=blue aria-label=切换至浅色模式 type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title=切换至浅色模式 for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=查找> <a href=javascript:void(0) class="md-search__icon md-icon" title=分享 aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hujianli94/hujianli94.github.io title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> hujianli94.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> 首页 </a> </li> <li class=md-tabs__item> <a href=../../../k8s/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.k8s/ class=md-tabs__link> k8s </a> </li> <li class=md-tabs__item> <a href=../../../Kubernetes/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Kubernetes/ class=md-tabs__link> Kubernetes </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Docker/ class=md-tabs__link> Docker </a> </li> <li class=md-tabs__item> <a href=../../../Golang/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Go-Web%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/ class=md-tabs__link> Golang </a> </li> <li class=md-tabs__item> <a href=../../../Python/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Pythjon-auto-ops/ class=md-tabs__link> Python </a> </li> <li class=md-tabs__item> <a href=../../../Python-vs-Go/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Python-vs-Go/ class=md-tabs__link> Python-vs-Go </a> </li> <li class=md-tabs__item> <a href=../../../Linux/Shell/Shell%E7%AE%80%E4%BB%8B/ class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../../Other/tools/1.PicGo%E5%9B%BE%E5%BA%8A/ class=md-tabs__link> Other </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=DevOps运维开发 class="md-nav__button md-logo" aria-label=DevOps运维开发 data-md-component=logo> <img src=../../../assets/images/logo.png alt=logo> </a> DevOps运维开发 </label> <div class=md-nav__source> <a href=https://github.com/hujianli94/hujianli94.github.io title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> hujianli94.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> 首页 </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> k8s </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> k8s </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> 0.学习线路 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> 0.学习线路 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.k8s/ class=md-nav__link> <span class=md-ellipsis> Kubernetes从入门到实践 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> 1.容器的发展史 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> 1.容器的发展史 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/1.%E5%AE%B9%E5%99%A8%E7%9A%84%E5%8F%91%E5%B1%95%E5%8F%B2/1.1%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B%E7%9A%84%E5%8F%91%E5%B1%95/ class=md-nav__link> <span class=md-ellipsis> 1.1开发过程的发展 </span> </a> </li> <li class=md-nav__item> <a href=../../../k8s/1.%E5%AE%B9%E5%99%A8%E7%9A%84%E5%8F%91%E5%B1%95%E5%8F%B2/1.2%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%84%E7%9A%84%E5%8F%91%E5%B1%95/ class=md-nav__link> <span class=md-ellipsis> 1.2应用架构的发展 </span> </a> </li> <li class=md-nav__item> <a href=../../../k8s/1.%E5%AE%B9%E5%99%A8%E7%9A%84%E5%8F%91%E5%B1%95%E5%8F%B2/1.3%E9%83%A8%E7%BD%B2%E6%89%93%E5%8C%85%E7%9A%84%E5%8F%91%E5%B1%95/ class=md-nav__link> <span class=md-ellipsis> 1.3部署打包的发展 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> 2.Kubernetes的核心概念 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> 2.Kubernetes的核心概念 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/2.Kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5/2.1Kubernetes%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%9E%B6%E6%9E%84/ class=md-nav__link> <span class=md-ellipsis> 2.1Kubernetes的设计架构 </span> </a> </li> <li class=md-nav__item> <a href=../../../k8s/2.Kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5/2.2Kubernetes%E7%9A%84%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1/ class=md-nav__link> <span class=md-ellipsis> 2.2Kubernetes的核心对象 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> 3.Kubernetes的安装和部署 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> 3.Kubernetes的安装和部署 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/3.Kubernetes%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2/3.1kubeadm%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/ class=md-nav__link> <span class=md-ellipsis> 3.1kubeadm搭建开发环境 </span> </a> </li> <li class=md-nav__item> <a href=../../../k8s/3.Kubernetes%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2/3.2kubeadm%E6%90%AD%E5%BB%BA%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83/ class=md-nav__link> <span class=md-ellipsis> 3.2kubeadm搭建生产环境 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class=md-ellipsis> 4.Pod </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> 4.Pod </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/4.Pod/4.1Pod%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/ class=md-nav__link> <span class=md-ellipsis> 4.1Pod的基本操作 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex=0> <span class=md-ellipsis> 5.控制器 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> 5.控制器 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/5.%E6%8E%A7%E5%88%B6%E5%99%A8/5.1Deployment/ class=md-nav__link> <span class=md-ellipsis> 5.1Deployment </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Kubernetes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> 0.学习线路 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> 0.学习线路 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Kubernetes/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Kubernetes/ class=md-nav__link> <span class=md-ellipsis> Kubernetes </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> 1.安装篇 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> 1.安装篇 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Kubernetes/1.%E5%AE%89%E8%A3%85%E7%AF%87/1.Kubeadm%E5%AE%89%E8%A3%85%E9%AB%98%E5%8F%AF%E7%94%A8K8s%E9%9B%86%E7%BE%A4/ class=md-nav__link> <span class=md-ellipsis> Kubeadm安装高可用集群 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/1.%E5%AE%89%E8%A3%85%E7%AF%87/2.%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E8%A3%85%E9%AB%98%E5%8F%AF%E7%94%A8K8s%E9%9B%86%E7%BE%A4/ class=md-nav__link> <span class=md-ellipsis> 二进制安装高可用K8s集群 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/1.%E5%AE%89%E8%A3%85%E7%AF%87/3.%E5%AE%89%E8%A3%85%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/ class=md-nav__link> <span class=md-ellipsis> 安装常用工具 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/1.%E5%AE%89%E8%A3%85%E7%AF%87/4.Kubeadm%E5%AE%89%E8%A3%85%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/ class=md-nav__link> <span class=md-ellipsis> Kubeadm安装开发环境 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/1.%E5%AE%89%E8%A3%85%E7%AF%87/5.K3s%E5%92%8CMinikube/ class=md-nav__link> <span class=md-ellipsis> K3s和Minikube </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> 2.基础篇 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> 2.基础篇 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Kubernetes/2.%E5%9F%BA%E7%A1%80%E7%AF%87/3.Docker%E5%9F%BA%E7%A1%80/ class=md-nav__link> <span class=md-ellipsis> Docker基础 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/2.%E5%9F%BA%E7%A1%80%E7%AF%87/4.Kubernetes%E7%9A%84%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/ class=md-nav__link> <span class=md-ellipsis> Kubernetes的基础概念 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/2.%E5%9F%BA%E7%A1%80%E7%AF%87/5.Kubernetes%E8%B0%83%E5%BA%A6%E5%9F%BA%E7%A1%80/ class=md-nav__link> <span class=md-ellipsis> Kubernetes调度基础 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/2.%E5%9F%BA%E7%A1%80%E7%AF%87/6.Kubernetes%E6%9C%8D%E5%8A%A1%E5%8F%91%E5%B8%83%E5%9F%BA%E7%A1%80/ class=md-nav__link> <span class=md-ellipsis> Kubernetes服务发布基础 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/2.%E5%9F%BA%E7%A1%80%E7%AF%87/7.Kubernetes%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> Kubernetes配置管理 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> 3.进阶篇 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> 3.进阶篇 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Kubernetes/3.%E8%BF%9B%E9%98%B6%E7%AF%87/8.Kubernetes%E5%AD%98%E5%82%A8%E5%85%A5%E9%97%A8/ class=md-nav__link> <span class=md-ellipsis> Kubernetes存储入门 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/3.%E8%BF%9B%E9%98%B6%E7%AF%87/9.Kubernetes%E9%AB%98%E7%BA%A7%E8%B0%83%E5%BA%A6/ class=md-nav__link> <span class=md-ellipsis> Kubernetes高级调度 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> 4.高级篇 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> 4.高级篇 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Kubernetes/4.%E9%AB%98%E7%BA%A7%E7%AF%87/12.%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AD%98%E5%82%A8Rook/ class=md-nav__link> <span class=md-ellipsis> 云原生存储Rook </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/4.%E9%AB%98%E7%BA%A7%E7%AF%87/13.%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%B9%E5%99%A8%E5%8C%96/ class=md-nav__link> <span class=md-ellipsis> 中间件容器化 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> 5.运维篇 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> 5.运维篇 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Kubernetes/5.%E8%BF%90%E7%BB%B4%E7%AF%87/14.Kubernetes%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86/ class=md-nav__link> <span class=md-ellipsis> Kubernetes日志收集 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/5.%E8%BF%90%E7%BB%B4%E7%AF%87/15.Kubernetes%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/ class=md-nav__link> <span class=md-ellipsis> Kubernetes监控告警 </span> </a> </li> <li class=md-nav__item> <a href=../../../Kubernetes/5.%E8%BF%90%E7%BB%B4%E7%AF%87/16.%E6%9C%8D%E5%8A%A1%E5%8F%91%E5%B8%83Ingress%E8%BF%9B%E9%98%B6/ class=md-nav__link> <span class=md-ellipsis> 服务发布Ingress进阶 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex=0> <span class=md-ellipsis> 6.DevOps篇 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> 6.DevOps篇 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Kubernetes/6.DevOps%E7%AF%87/17.DevOps%E5%AE%9E%E8%B7%B5/ class=md-nav__link> <span class=md-ellipsis> DevOps实践 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Docker </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class=md-ellipsis> 0.学习线路 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> 0.学习线路 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Docker/ class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2 checked> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> 1.基础 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=true> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> 1.基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../1.%E5%AE%89%E8%A3%85Docker/ class=md-nav__link> <span class=md-ellipsis> 1.安装Docker </span> </a> </li> <li class=md-nav__item> <a href=../2.Docker%E9%95%9C%E5%83%8F/ class=md-nav__link> <span class=md-ellipsis> 2.Docker镜像 </span> </a> </li> <li class=md-nav__item> <a href=../3.Docker%E5%AE%B9%E5%99%A8/ class=md-nav__link> <span class=md-ellipsis> 3.Docker容器 </span> </a> </li> <li class=md-nav__item> <a href=../4.%E4%BC%81%E4%B8%9A%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93harbor/ class=md-nav__link> <span class=md-ellipsis> 4.企业私有仓库harbor </span> </a> </li> <li class=md-nav__item> <a href=../5.Docker%E6%95%B0%E6%8D%AE/ class=md-nav__link> <span class=md-ellipsis> 5.Docker数据 </span> </a> </li> <li class=md-nav__item> <a href=../6.Docker%E7%BD%91%E7%BB%9C/ class=md-nav__link> <span class=md-ellipsis> 6.Docker网络 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 7.Dockerfile </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 7.Dockerfile </span> </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-dockerfile指令 class=md-nav__link> <span class=md-ellipsis> 1. Dockerfile指令 </span> </a> </li> <li class=md-nav__item> <a href=#2dockerfile自定义镜像 class=md-nav__link> <span class=md-ellipsis> 2.Dockerfile自定义镜像 </span> </a> <nav class=md-nav aria-label=2.Dockerfile自定义镜像> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-查看运行容器的dockerfile工具 class=md-nav__link> <span class=md-ellipsis> 2.1 查看运行容器的Dockerfile工具 </span> </a> </li> <li class=md-nav__item> <a href=#22-查看docker容器运行命令的所有参数 class=md-nav__link> <span class=md-ellipsis> 2.2 查看docker容器运行命令的所有参数 </span> </a> </li> <li class=md-nav__item> <a href=#23-热门dockerfile示例 class=md-nav__link> <span class=md-ellipsis> 2.3 热门Dockerfile示例 </span> </a> <nav class=md-nav aria-label="2.3 热门Dockerfile示例"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx class=md-nav__link> <span class=md-ellipsis> Nginx </span> </a> </li> <li class=md-nav__item> <a href=#python class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=#django class=md-nav__link> <span class=md-ellipsis> Django </span> </a> </li> <li class=md-nav__item> <a href=#flask class=md-nav__link> <span class=md-ellipsis> Flask </span> </a> </li> <li class=md-nav__item> <a href=#golang class=md-nav__link> <span class=md-ellipsis> Golang </span> </a> </li> <li class=md-nav__item> <a href=#nodejs class=md-nav__link> <span class=md-ellipsis> Node.js </span> </a> </li> <li class=md-nav__item> <a href=#redis class=md-nav__link> <span class=md-ellipsis> Redis </span> </a> </li> <li class=md-nav__item> <a href=#mysql class=md-nav__link> <span class=md-ellipsis> MySQL </span> </a> </li> <li class=md-nav__item> <a href=#mongodb class=md-nav__link> <span class=md-ellipsis> Mongodb </span> </a> </li> <li class=md-nav__item> <a href=#postgres class=md-nav__link> <span class=md-ellipsis> Postgres </span> </a> </li> <li class=md-nav__item> <a href=#httpd class=md-nav__link> <span class=md-ellipsis> httpd </span> </a> </li> <li class=md-nav__item> <a href=#java class=md-nav__link> <span class=md-ellipsis> Java </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3dockerfile编写优化 class=md-nav__link> <span class=md-ellipsis> 3.Dockerfile编写优化 </span> </a> <nav class=md-nav aria-label=3.Dockerfile编写优化> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31-使用小的基础镜像 class=md-nav__link> <span class=md-ellipsis> 3.1 使用小的基础镜像 </span> </a> <nav class=md-nav aria-label="3.1 使用小的基础镜像"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#应用已安装环境的镜像 class=md-nav__link> <span class=md-ellipsis> 应用已安装环境的镜像 </span> </a> </li> <li class=md-nav__item> <a href=#busterstretchjessie class=md-nav__link> <span class=md-ellipsis> buster/stretch/jessie </span> </a> </li> <li class=md-nav__item> <a href=#slim class=md-nav__link> <span class=md-ellipsis> slim </span> </a> </li> <li class=md-nav__item> <a href=#alpine class=md-nav__link> <span class=md-ellipsis> alpine </span> </a> </li> <li class=md-nav__item> <a href=#选择镜像 class=md-nav__link> <span class=md-ellipsis> 选择镜像 </span> </a> </li> <li class=md-nav__item> <a href=#关于版本的说明 class=md-nav__link> <span class=md-ellipsis> 关于版本的说明 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#32-指令链式运行 class=md-nav__link> <span class=md-ellipsis> 3.2 指令链式运行 </span> </a> </li> <li class=md-nav__item> <a href=#33-变动的指令放到最后 class=md-nav__link> <span class=md-ellipsis> 3.3 变动的指令放到最后 </span> </a> </li> <li class=md-nav__item> <a href=#34-首选数组而不是字符串语法 class=md-nav__link> <span class=md-ellipsis> 3.4 首选数组而不是字符串语法 </span> </a> <nav class=md-nav aria-label="3.4 首选数组而不是字符串语法"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cmd class=md-nav__link> <span class=md-ellipsis> CMD </span> </a> </li> <li class=md-nav__item> <a href=#entrypoint class=md-nav__link> <span class=md-ellipsis> ENTRYPOINT </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#35-每个run指令后删除多余文件 class=md-nav__link> <span class=md-ellipsis> 3.5 每个RUN指令后删除多余文件 </span> </a> </li> <li class=md-nav__item> <a href=#36-copy而不是add class=md-nav__link> <span class=md-ellipsis> 3.6 COPY而不是ADD </span> </a> </li> <li class=md-nav__item> <a href=#37-使用dockerignore class=md-nav__link> <span class=md-ellipsis> 3.7 使用.dockerignore </span> </a> </li> <li class=md-nav__item> <a href=#38-利用多阶段构建 class=md-nav__link> <span class=md-ellipsis> 3.8 利用多阶段构建 </span> </a> </li> <li class=md-nav__item> <a href=#39-写dockerfile的一些技巧 class=md-nav__link> <span class=md-ellipsis> 3.9 写Dockerfile的一些技巧 </span> </a> <nav class=md-nav aria-label="3.9 写Dockerfile的一些技巧"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1用-python--m-pip-而不是-pip class=md-nav__link> <span class=md-ellipsis> 1.用 python -m pip 而不是 pip </span> </a> </li> <li class=md-nav__item> <a href=#2让-apt-get-install-更安静 class=md-nav__link> <span class=md-ellipsis> 2.让 apt-get install 更安静 </span> </a> </li> <li class=md-nav__item> <a href=#3让-curl-和-wget-更安静 class=md-nav__link> <span class=md-ellipsis> 3.让 curl 和 wget 更安静 </span> </a> </li> <li class=md-nav__item> <a href=#4用axel而不是curl或者wget class=md-nav__link> <span class=md-ellipsis> 4.用axel而不是curl或者wget </span> </a> </li> <li class=md-nav__item> <a href=#5设置容器时间同步 class=md-nav__link> <span class=md-ellipsis> 5.设置容器时间同步 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#310-docker-build镜像创建 class=md-nav__link> <span class=md-ellipsis> 3.10 docker build镜像创建 </span> </a> </li> <li class=md-nav__item> <a href=#311-dockerfile参考 class=md-nav__link> <span class=md-ellipsis> 3.11 dockerfile参考 </span> </a> </li> <li class=md-nav__item> <a href=#312-添加healthcheck class=md-nav__link> <span class=md-ellipsis> 3.12 添加HEALTHCHECK </span> </a> </li> <li class=md-nav__item> <a href=#313-dockerfile优化实例 class=md-nav__link> <span class=md-ellipsis> 3.13 Dockerfile优化实例 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4buildkit class=md-nav__link> <span class=md-ellipsis> 4.BuildKit </span> </a> <nav class=md-nav aria-label=4.BuildKit> <ul class=md-nav__list> <li class=md-nav__item> <a href=#41-安装buildx class=md-nav__link> <span class=md-ellipsis> 4.1 安装buildx </span> </a> </li> <li class=md-nav__item> <a href=#42-buildx示例 class=md-nav__link> <span class=md-ellipsis> 4.2 buildx示例 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5dockerfile实践 class=md-nav__link> <span class=md-ellipsis> 5.Dockerfile实践 </span> </a> <nav class=md-nav aria-label=5.Dockerfile实践> <ul class=md-nav__list> <li class=md-nav__item> <a href=#51-构建nginx基础镜像 class=md-nav__link> <span class=md-ellipsis> 5.1 构建Nginx基础镜像 </span> </a> </li> <li class=md-nav__item> <a href=#52-构建php基础镜像 class=md-nav__link> <span class=md-ellipsis> 5.2 构建PHP基础镜像 </span> </a> </li> <li class=md-nav__item> <a href=#53-构建tomcat基础镜像 class=md-nav__link> <span class=md-ellipsis> 5.3 构建Tomcat基础镜像 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6dockerfile工具 class=md-nav__link> <span class=md-ellipsis> 6.Dockerfile工具 </span> </a> </li> <li class=md-nav__item> <a href=#7参考文献 class=md-nav__link> <span class=md-ellipsis> 7.参考文献 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../8.docker-compose/ class=md-nav__link> <span class=md-ellipsis> 8.docker-compose </span> </a> </li> <li class=md-nav__item> <a href=../9.Docker%E7%9B%B8%E5%85%B3%E8%84%9A%E6%9C%AC/ class=md-nav__link> <span class=md-ellipsis> 9.Docker相关脚本 </span> </a> </li> <li class=md-nav__item> <a href=../10.Docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/ class=md-nav__link> <span class=md-ellipsis> 10.Docker常用命令 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> 2.实战案例 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> 2.实战案例 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../2.%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/1.%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ class=md-nav__link> <span class=md-ellipsis> 1.操作系统 </span> </a> </li> <li class=md-nav__item> <a href=../../2.%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/2.Web%E6%9C%8D%E5%8A%A1%E4%B8%8E%E5%BA%94%E7%94%A8/ class=md-nav__link> <span class=md-ellipsis> 2.Web服务与应用 </span> </a> </li> <li class=md-nav__item> <a href=../../2.%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/3.%E6%8C%81%E7%BB%AD%E5%BC%80%E5%8F%91%E4%B8%8E%E7%AE%A1%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 3.持续开发与管理 </span> </a> </li> <li class=md-nav__item> <a href=../../2.%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/4.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8/ class=md-nav__link> <span class=md-ellipsis> 4.数据库应用 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> 3.Devops </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> 3.Devops </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../3.Devops/1.confcenter-docker/ class=md-nav__link> <span class=md-ellipsis> 1.confcenter-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/2.simaple-jenkins/ class=md-nav__link> <span class=md-ellipsis> 2.simaple-jenkins </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/3.docker-nginx-spa/ class=md-nav__link> <span class=md-ellipsis> 3.docker-nginx-spa </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/4.fileserver-docker/ class=md-nav__link> <span class=md-ellipsis> 4.fileserver-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/5.haproxy-docker/ class=md-nav__link> <span class=md-ellipsis> 5.haproxy-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/6.mysql-docker/ class=md-nav__link> <span class=md-ellipsis> 6.mysql-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/7.frp-docker/ class=md-nav__link> <span class=md-ellipsis> 7.frp-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/8.coredns-docker/ class=md-nav__link> <span class=md-ellipsis> 8.coredns-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/9.simple-harbor/ class=md-nav__link> <span class=md-ellipsis> 9.simple-harbor </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/10.redis-docker/ class=md-nav__link> <span class=md-ellipsis> 10.redis-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/11.nexus3-docker/ class=md-nav__link> <span class=md-ellipsis> 11.nexus3-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/12.openvpn-docker/ class=md-nav__link> <span class=md-ellipsis> 12.openvpn-docker.md </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/13.nfs-docker/ class=md-nav__link> <span class=md-ellipsis> 13.nfs-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/14.jumpserver-docker/ class=md-nav__link> <span class=md-ellipsis> 14.jumpserver-docker.md </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/15.ansible-docker/ class=md-nav__link> <span class=md-ellipsis> 15.ansible-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/16.minio-docker/ class=md-nav__link> <span class=md-ellipsis> 16.minio-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/17.vaultwarden-docker/ class=md-nav__link> <span class=md-ellipsis> 17.vaultwarden-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/18.kasm-docker/ class=md-nav__link> <span class=md-ellipsis> 18.kasm-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/19.nginx-docker/ class=md-nav__link> <span class=md-ellipsis> 19.nginx-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/20.kafka-docker/ class=md-nav__link> <span class=md-ellipsis> 20.kafka-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/21.golang-docker/ class=md-nav__link> <span class=md-ellipsis> 21.golang-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/22.postgres-docker/ class=md-nav__link> <span class=md-ellipsis> 22.postgres-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/23.nginx-download-docker/ class=md-nav__link> <span class=md-ellipsis> 23.nginx-download-docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/24.helm%E9%83%A8%E7%BD%B2%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1/ class=md-nav__link> <span class=md-ellipsis> 24.helm部署常用服务 </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/25.Python%E6%93%8D%E4%BD%9CDocker/ class=md-nav__link> <span class=md-ellipsis> 25.Python操作Docker </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/26.docker-compose-devops/ class=md-nav__link> <span class=md-ellipsis> 26.docker-compose-devops </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/27.DevOps%E4%B8%8B%E7%9A%84Shell%E8%84%9A%E6%9C%AC/ class=md-nav__link> <span class=md-ellipsis> 27.DevOps下的Shell脚本 </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/28.Devops%E4%B8%8B%E7%9A%84Python%E8%84%9A%E6%9C%AC/ class=md-nav__link> <span class=md-ellipsis> 28.Devops下的Python脚本 </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/29.Vagrant%E8%99%9A%E6%8B%9F%E6%9C%BA/ class=md-nav__link> <span class=md-ellipsis> 29.Vagrant虚拟机 </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/30.VMware-workstation/ class=md-nav__link> <span class=md-ellipsis> 30.VMware Workstation </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/31.VirtualBox/ class=md-nav__link> <span class=md-ellipsis> 31.VirtualBox </span> </a> </li> <li class=md-nav__item> <a href=../../3.Devops/32.Devops%E7%9B%B8%E5%85%B3%E5%AD%98%E5%82%A8%E5%BA%93/ class=md-nav__link> <span class=md-ellipsis> 32.Devops相关存储库 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Golang </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Golang </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_1> <label class=md-nav__link for=__nav_5_1 id=__nav_5_1_label tabindex=0> <span class=md-ellipsis> 0.学习线路 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> 0.学习线路 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Go-Web%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/ class=md-nav__link> <span class=md-ellipsis> Go Web开发实战 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> 1.Go基础 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> 1.Go基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/1.Go%E5%9F%BA%E7%A1%80/1.%E5%AE%89%E8%A3%85Go/ class=md-nav__link> <span class=md-ellipsis> 安装Go </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/1.Go%E5%9F%BA%E7%A1%80/2.%E7%AC%AC%E4%B8%80%E4%B8%AAGo%E7%A8%8B%E5%BA%8F/ class=md-nav__link> <span class=md-ellipsis> 第一个Go程序 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/1.Go%E5%9F%BA%E7%A1%80/3.Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/ class=md-nav__link> <span class=md-ellipsis> Go基础语法 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/1.Go%E5%9F%BA%E7%A1%80/4.Go-Module/ class=md-nav__link> <span class=md-ellipsis> Go Module </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/1.Go%E5%9F%BA%E7%A1%80/5.Go-%E6%A0%87%E5%87%86%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/ class=md-nav__link> <span class=md-ellipsis> Go 标准目录结构 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> 2.Go-Web基础 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> 2.Go-Web基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/2.Go-Web%E5%9F%BA%E7%A1%80/5.%E7%AC%AC%E4%B8%80%E4%B8%AAGo-Web%E7%A8%8B%E5%BA%8F/ class=md-nav__link> <span class=md-ellipsis> 第一个Go Web程序 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/2.Go-Web%E5%9F%BA%E7%A1%80/6.Web%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86%E7%AE%80%E4%BB%8B/ class=md-nav__link> <span class=md-ellipsis> Web程序运行原理简介 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/2.Go-Web%E5%9F%BA%E7%A1%80/7.net-http%E5%8C%85/ class=md-nav__link> <span class=md-ellipsis> net/http包 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/2.Go-Web%E5%9F%BA%E7%A1%80/8.html-template%E5%8C%85/ class=md-nav__link> <span class=md-ellipsis> html/template包 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex=0> <span class=md-ellipsis> 3.Go-Web请求处理 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> 3.Go-Web请求处理 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/3.Go-Web%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/9.%E7%AE%80%E5%8D%95Web%E6%9C%8D%E5%8A%A1%E5%99%A8/ class=md-nav__link> <span class=md-ellipsis> 简单Web服务器 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/3.Go-Web%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/10.%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82/ class=md-nav__link> <span class=md-ellipsis> 处理请求 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/3.Go-Web%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/11.session%E5%92%8Ccookie/ class=md-nav__link> <span class=md-ellipsis> session和cookie </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex=0> <span class=md-ellipsis> 4.Go访问数据库 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> 4.Go访问数据库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/4.Go%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93/12.Go%E6%93%8D%E4%BD%9CMySQL/ class=md-nav__link> <span class=md-ellipsis> Go操作MySQL </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/4.Go%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93/13.Go%E6%93%8D%E4%BD%9CRedis/ class=md-nav__link> <span class=md-ellipsis> Go操作Redis </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/4.Go%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93/14.Go%E6%93%8D%E4%BD%9CMongoDB/ class=md-nav__link> <span class=md-ellipsis> Go操作MongoDB </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/4.Go%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93/15.Go%E7%9A%84%E5%B8%B8%E8%A7%81ORM%E5%BA%93/ class=md-nav__link> <span class=md-ellipsis> Go的常见ORM库 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/4.Go%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93/16.Go%E6%93%8D%E4%BD%9CSQLite/ class=md-nav__link> <span class=md-ellipsis> Go操作SQLite </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_6> <label class=md-nav__link for=__nav_5_6 id=__nav_5_6_label tabindex=0> <span class=md-ellipsis> 5.Go高级网络编程 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_6_label aria-expanded=false> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> 5.Go高级网络编程 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/5.Go%E9%AB%98%E7%BA%A7%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/17.Go-Socket%E7%BC%96%E7%A8%8B/ class=md-nav__link> <span class=md-ellipsis> Go Socket编程 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/5.Go%E9%AB%98%E7%BA%A7%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/18.Go-RPC%E7%BC%96%E7%A8%8B/ class=md-nav__link> <span class=md-ellipsis> Go RPC编程 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/5.Go%E9%AB%98%E7%BA%A7%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/19.Go-%E5%BE%AE%E6%9C%8D%E5%8A%A1/ class=md-nav__link> <span class=md-ellipsis> Go 微服务 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_7> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0> <span class=md-ellipsis> 6.Go文件处理 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_7_label aria-expanded=false> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> 6.Go文件处理 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/6.Go%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/20.%E5%A4%84%E7%90%86%E7%9B%AE%E5%BD%95%E4%B8%8E%E6%96%87%E4%BB%B6/ class=md-nav__link> <span class=md-ellipsis> 处理目录与文件 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/6.Go%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/21.%E5%A4%84%E7%90%86XML%E6%96%87%E4%BB%B6/ class=md-nav__link> <span class=md-ellipsis> 处理XML文件 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/6.Go%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/22.%E5%A4%84%E7%90%86JSON%E6%96%87%E4%BB%B6/ class=md-nav__link> <span class=md-ellipsis> 处理JSON文件 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/6.Go%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/23.%E5%A4%84%E7%90%86CSV%E6%96%87%E4%BB%B6/ class=md-nav__link> <span class=md-ellipsis> 处理CSV文件 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/6.Go%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/24.%E5%A4%84%E7%90%86Go%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95/ class=md-nav__link> <span class=md-ellipsis> 处理Go日志记录 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/6.Go%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/25.%E5%A4%84%E7%90%86%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 处理正则表达式 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/6.Go%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/26.%E5%A4%84%E7%90%86Excel%E6%96%87%E4%BB%B6/ class=md-nav__link> <span class=md-ellipsis> 处理Excel文件 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_8> <label class=md-nav__link for=__nav_5_8 id=__nav_5_8_label tabindex=0> <span class=md-ellipsis> 7.Go并发编程 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_8_label aria-expanded=false> <label class=md-nav__title for=__nav_5_8> <span class="md-nav__icon md-icon"></span> 7.Go并发编程 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/7.Go%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/26.%E5%B9%B6%E5%8F%91-%E5%B9%B6%E8%A1%8C/ class=md-nav__link> <span class=md-ellipsis> 并发 并行 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/7.Go%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/27.%E8%BF%9B%E7%A8%8B-%E7%BA%BF%E7%A8%8B-%E5%8D%8F%E7%A8%8B/ class=md-nav__link> <span class=md-ellipsis> 进程 线程 协程 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/7.Go%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/28.Go%E5%B9%B6%E5%8F%91%E6%A8%A1%E5%9E%8B/ class=md-nav__link> <span class=md-ellipsis> Go并发模型 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/7.Go%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/29.goroutine%E5%92%8Cchannel/ class=md-nav__link> <span class=md-ellipsis> goroutine和channel </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/7.Go%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/30.sync%E5%AE%9E%E7%8E%B0%E5%B9%B6%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> sync实现并发 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/7.Go%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/31.Go%E5%B9%B6%E5%8F%91%E7%9A%84Web%E5%BA%94%E7%94%A8/ class=md-nav__link> <span class=md-ellipsis> Go并发的Web应用 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_9> <label class=md-nav__link for=__nav_5_9 id=__nav_5_9_label tabindex=0> <span class=md-ellipsis> 8.Go标准库 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_9_label aria-expanded=false> <label class=md-nav__title for=__nav_5_9> <span class="md-nav__icon md-icon"></span> 8.Go标准库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/32.time/ class=md-nav__link> <span class=md-ellipsis> time </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/33.strings/ class=md-nav__link> <span class=md-ellipsis> strings </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/34.bytes/ class=md-nav__link> <span class=md-ellipsis> bytes </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/35.json/ class=md-nav__link> <span class=md-ellipsis> json </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/36.io-bufio/ class=md-nav__link> <span class=md-ellipsis> io/bufio </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/37.fmt/ class=md-nav__link> <span class=md-ellipsis> fmt </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/38.strconv/ class=md-nav__link> <span class=md-ellipsis> strconv </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/39.regexp/ class=md-nav__link> <span class=md-ellipsis> regexp </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/40.log/ class=md-nav__link> <span class=md-ellipsis> log </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/41.reflect-unsafe/ class=md-nav__link> <span class=md-ellipsis> reflect/unsafe </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/42.os-path-filepath/ class=md-nav__link> <span class=md-ellipsis> os/path/filepath </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/43.unicode/ class=md-nav__link> <span class=md-ellipsis> unicode </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/44.flag/ class=md-nav__link> <span class=md-ellipsis> flag </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/45.net-url/ class=md-nav__link> <span class=md-ellipsis> net/url </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/46.net-http/ class=md-nav__link> <span class=md-ellipsis> net/http </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/47.sort/ class=md-nav__link> <span class=md-ellipsis> sort </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/8.Go%E6%A0%87%E5%87%86%E5%BA%93/48.errors/ class=md-nav__link> <span class=md-ellipsis> errors </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_10> <label class=md-nav__link for=__nav_5_10 id=__nav_5_10_label tabindex=0> <span class=md-ellipsis> 9.Go三方库 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_10_label aria-expanded=false> <label class=md-nav__title for=__nav_5_10> <span class="md-nav__icon md-icon"></span> 9.Go三方库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/0.%E5%BC%80%E6%BA%90%E8%87%AA%E5%B7%B1%E7%9A%84Go%E5%BA%93/ class=md-nav__link> <span class=md-ellipsis> 开源自己的Go库 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/1.cobra/ class=md-nav__link> <span class=md-ellipsis> Cobra </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/2.viper/ class=md-nav__link> <span class=md-ellipsis> Viper </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/3.Zap/ class=md-nav__link> <span class=md-ellipsis> Zap </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/4.mahonia/ class=md-nav__link> <span class=md-ellipsis> mahonia </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/5.ssh/ class=md-nav__link> <span class=md-ellipsis> ssh </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/6.fsnotify/ class=md-nav__link> <span class=md-ellipsis> fsnotify </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/7.yaml/ class=md-nav__link> <span class=md-ellipsis> yaml </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/8.tail/ class=md-nav__link> <span class=md-ellipsis> tail </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/9.gRPC/ class=md-nav__link> <span class=md-ellipsis> gRPC </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/10.gopsutil/ class=md-nav__link> <span class=md-ellipsis> gopsutil </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/11.go-awesome/ class=md-nav__link> <span class=md-ellipsis> go-awesome </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/9.Go%E4%B8%89%E6%96%B9%E5%BA%93/12.dmidecode/ class=md-nav__link> <span class=md-ellipsis> dmidecode </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_11> <label class=md-nav__link for=__nav_5_11 id=__nav_5_11_label tabindex=0> <span class=md-ellipsis> 10.Go-RESTful-API接口开发 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_11_label aria-expanded=false> <label class=md-nav__title for=__nav_5_11> <span class="md-nav__icon md-icon"></span> 10.Go-RESTful-API接口开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/10.Go-RESTful-API%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91/1.%E4%BB%80%E4%B9%88%E6%98%AFRESTful-API/ class=md-nav__link> <span class=md-ellipsis> 1.什么是RESTful-API </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/10.Go-RESTful-API%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91/2.GORMv2/ class=md-nav__link> <span class=md-ellipsis> 2.GORMv2 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/10.Go-RESTful-API%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91/3.Gin%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BD%BF%E7%94%A8/ class=md-nav__link> <span class=md-ellipsis> 3.Gin框架的使用 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/10.Go-RESTful-API%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91/4.%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E7%AB%AF/ class=md-nav__link> <span class=md-ellipsis> 4.图书管理系统-前端 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/10.Go-RESTful-API%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91/5.%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E7%AB%AF/ class=md-nav__link> <span class=md-ellipsis> 5.图书管理系统-后端 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/10.Go-RESTful-API%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91/6.Gin%2BVue%E5%85%A5%E9%97%A8%E9%A1%B9%E7%9B%AE/ class=md-nav__link> <span class=md-ellipsis> 6.Gin+Vue入门项目 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_12> <label class=md-nav__link for=__nav_5_12 id=__nav_5_12_label tabindex=0> <span class=md-ellipsis> 11.Web前端 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_12_label aria-expanded=false> <label class=md-nav__title for=__nav_5_12> <span class="md-nav__icon md-icon"></span> 11.Web前端 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/11.Web%E5%89%8D%E7%AB%AF/1.HTML%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80/ class=md-nav__link> <span class=md-ellipsis> 1.HTML标记语言 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/11.Web%E5%89%8D%E7%AB%AF/2.CSS%E6%A0%B7%E5%BC%8F%E8%AF%AD%E8%A8%80/ class=md-nav__link> <span class=md-ellipsis> 2.CSS样式语言 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/11.Web%E5%89%8D%E7%AB%AF/3.JavaScript%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80/ class=md-nav__link> <span class=md-ellipsis> 3.JavaScript客户端脚本语言 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/11.Web%E5%89%8D%E7%AB%AF/4.JavaScript%E5%BA%93-JQuery/ class=md-nav__link> <span class=md-ellipsis> 4.JavaScript库:JQuery </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_13> <label class=md-nav__link for=__nav_5_13 id=__nav_5_13_label tabindex=0> <span class=md-ellipsis> 12.Vue前端开发 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_13_label aria-expanded=false> <label class=md-nav__title for=__nav_5_13> <span class="md-nav__icon md-icon"></span> 12.Vue前端开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/1.%E8%AE%A4%E8%AF%86Vue.js/ class=md-nav__link> <span class=md-ellipsis> 1.认识Vue.js.md </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/2.Vue%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/ class=md-nav__link> <span class=md-ellipsis> 2.Vue常用指令 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/3.Vue%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7/ class=md-nav__link> <span class=md-ellipsis> 3.Vue常用属性 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/4.Vue%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E4%B9%8B%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/ class=md-nav__link> <span class=md-ellipsis> 4.Vue常用指令之流程控制 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/5.Vue%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A/ class=md-nav__link> <span class=md-ellipsis> 5.Vue常用指令之数据双向绑定 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/6.Vue%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90/ class=md-nav__link> <span class=md-ellipsis> 6.Vue生命周期钩子 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/7.VueCli%E8%84%9A%E6%89%8B%E6%9E%B6/ class=md-nav__link> <span class=md-ellipsis> 7.VueCli脚手架 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/8.Vue%E7%BB%84%E4%BB%B6/ class=md-nav__link> <span class=md-ellipsis> 8.Vue组件 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/9.Vue%E8%B7%AF%E7%94%B1/ class=md-nav__link> <span class=md-ellipsis> 9.Vue路由 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/10.Vuex%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 10.Vuex状态管理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/11.%E5%89%8D%E5%90%8E%E7%AB%AF%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92-Axios/ class=md-nav__link> <span class=md-ellipsis> 11.前后端数据交互 Axios </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/12.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/12.Element-Plus/ class=md-nav__link> <span class=md-ellipsis> 12.Element Plus </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_14> <label class=md-nav__link for=__nav_5_14 id=__nav_5_14_label tabindex=0> <span class=md-ellipsis> 13.K8s管理系统项目实战 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_14_label aria-expanded=false> <label class=md-nav__title for=__nav_5_14> <span class="md-nav__icon md-icon"></span> 13.K8s管理系统项目实战 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/13.K8s%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/1.K8s%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E7%AB%AFAPI%E5%BC%80%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> K8s管理系统-后端API开发 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/13.K8s%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/2.K8s%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> K8s管理系统-前端开发 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_15> <label class=md-nav__link for=__nav_5_15 id=__nav_5_15_label tabindex=0> <span class=md-ellipsis> 14.Go开发的三方平台 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_15_label aria-expanded=false> <label class=md-nav__title for=__nav_5_15> <span class="md-nav__icon md-icon"></span> 14.Go开发的三方平台 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/14.Go%E5%BC%80%E5%8F%91%E7%9A%84%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0/0.%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8Go%E5%81%9A%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> 为什么使用Go做后端开发 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/14.Go%E5%BC%80%E5%8F%91%E7%9A%84%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0/1.TBak-System%E5%A4%87%E4%BB%BD%E5%B9%B3%E5%8F%B0/ class=md-nav__link> <span class=md-ellipsis> TBak System备份平台 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/14.Go%E5%BC%80%E5%8F%91%E7%9A%84%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0/2.kubernetes%E5%AE%B9%E5%99%A8%E4%BA%91%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/ class=md-nav__link> <span class=md-ellipsis> kubernetes容器云管理平台 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/14.Go%E5%BC%80%E5%8F%91%E7%9A%84%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0/3.Go%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/ class=md-nav__link> <span class=md-ellipsis> Go命令行工具 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/14.Go%E5%BC%80%E5%8F%91%E7%9A%84%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0/4.%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/ class=md-nav__link> <span class=md-ellipsis> nps </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/14.Go%E5%BC%80%E5%8F%91%E7%9A%84%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0/5.go-web%E9%A1%B9%E7%9B%AE/ class=md-nav__link> <span class=md-ellipsis> go-web项目 </span> </a> </li> <li class=md-nav__item> <a href=../../../Golang/14.Go%E5%BC%80%E5%8F%91%E7%9A%84%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0/6.go-%E4%B8%89%E6%96%B9%E5%B7%A5%E5%85%B7%E7%AE%80%E5%8D%95%E5%85%A5%E9%97%A8/ class=md-nav__link> <span class=md-ellipsis> go-三方工具简单入门 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_16> <label class=md-nav__link for=__nav_5_16 id=__nav_5_16_label tabindex=0> <span class=md-ellipsis> 15.容器化Go </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_16_label aria-expanded=false> <label class=md-nav__title for=__nav_5_16> <span class="md-nav__icon md-icon"></span> 15.容器化Go </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Golang/15.%E5%AE%B9%E5%99%A8%E5%8C%96Go/0.%E6%9E%84%E5%BB%BAGo%E5%BA%94%E7%94%A8docker%E9%95%9C%E5%83%8F/ class=md-nav__link> <span class=md-ellipsis> 构建Go应用docker镜像 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Python </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1> <label class=md-nav__link for=__nav_6_1 id=__nav_6_1_label tabindex=0> <span class=md-ellipsis> 0.学习线路 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1> <span class="md-nav__icon md-icon"></span> 0.学习线路 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Pythjon-auto-ops/ class=md-nav__link> <span class=md-ellipsis> Python Linux管理与自动化运维 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2> <label class=md-nav__link for=__nav_6_2 id=__nav_6_2_label tabindex=0> <span class=md-ellipsis> 1.Python基础篇 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> 1.Python基础篇 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python/1.Python%E5%9F%BA%E7%A1%80%E7%AF%87/1.Python%E7%94%9F%E6%80%81%E5%B7%A5%E5%85%B7/ class=md-nav__link> <span class=md-ellipsis> 1.Python生态工具 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/1.Python%E5%9F%BA%E7%A1%80%E7%AF%87/2.Python%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E5%AE%89%E8%A3%85/ class=md-nav__link> <span class=md-ellipsis> 2.Python第三方库安装 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/1.Python%E5%9F%BA%E7%A1%80%E7%AF%87/3.Python%E5%B7%A5%E4%BD%9C%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 3.Python工作环境管理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/1.Python%E5%9F%BA%E7%A1%80%E7%AF%87/4.Python%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/ class=md-nav__link> <span class=md-ellipsis> 4.Python开发环境 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/1.Python%E5%9F%BA%E7%A1%80%E7%AF%87/5.Python%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/ class=md-nav__link> <span class=md-ellipsis> 5.Python数据结构 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/1.Python%E5%9F%BA%E7%A1%80%E7%AF%87/6.Python%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84/ class=md-nav__link> <span class=md-ellipsis> 6.Python项目的组织结构 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/1.Python%E5%9F%BA%E7%A1%80%E7%AF%87/7.Python%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/ class=md-nav__link> <span class=md-ellipsis> 7.Python代码规范 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/1.Python%E5%9F%BA%E7%A1%80%E7%AF%87/8.Python%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0/ class=md-nav__link> <span class=md-ellipsis> 8.Python内置函数 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> 2.Python运维开发 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> 2.Python运维开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/1.%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/ class=md-nav__link> <span class=md-ellipsis> 1.命令行工具 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/2.%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 2.文本处理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/3.Linux%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 3.Linux系统管理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/4.%E7%9B%91%E6%8E%A7Linux/ class=md-nav__link> <span class=md-ellipsis> 4.监控Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/5.%E6%96%87%E6%A1%A3%E4%B8%8E%E6%8A%A5%E5%91%8A/ class=md-nav__link> <span class=md-ellipsis> 5.文档与报告 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/6.%E7%BD%91%E7%BB%9C/ class=md-nav__link> <span class=md-ellipsis> 6.网络 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/7.%E8%87%AA%E5%8A%A8%E5%8C%96%E7%AE%A1%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 7.自动化管理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/8.%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/ class=md-nav__link> <span class=md-ellipsis> 8.常用模块 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/9.Python%E6%89%93%E9%80%A0MySQL%E4%B8%93%E5%AE%B6%E7%B3%BB%E7%BB%9F/ class=md-nav__link> <span class=md-ellipsis> 9.Python打造MySQL专家系统 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/10.%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%BC%80%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> 10.自动化运维系统的开发 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/11.%E5%8D%8E%E4%B8%BA%E4%BA%91Python%E6%BC%94%E7%A4%BA%E4%BB%A3%E7%A0%81/ class=md-nav__link> <span class=md-ellipsis> 11.华为云Python演示代码 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/12.%E5%8D%8E%E4%B8%BA%E4%BA%91Go%E6%BC%94%E7%A4%BA%E4%BB%A3%E7%A0%81/ class=md-nav__link> <span class=md-ellipsis> 12.华为云Go演示代码 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/%E9%99%84-%E8%BF%90%E7%BB%B4%E7%9B%B8%E5%85%B3%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/ class=md-nav__link> <span class=md-ellipsis> 附-运维相关开源项目 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/%E9%99%84-awesome-python-cn/ class=md-nav__link> <span class=md-ellipsis> 附-awesome-python-cn </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/%E9%99%84-CMDB/ class=md-nav__link> <span class=md-ellipsis> 附-CMDB </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/2.Python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/%E9%99%84-Django-web%E5%BC%80%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> 附-Django-web开发 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4> <label class=md-nav__link for=__nav_6_4 id=__nav_6_4_label tabindex=0> <span class=md-ellipsis> 3.Python测试开发 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4> <span class="md-nav__icon md-icon"></span> 3.Python测试开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/1.Python2%E4%B8%8EPython3%E5%8C%BA%E5%88%AB/ class=md-nav__link> <span class=md-ellipsis> 1.Python2与Python3区别 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/2.Windows%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85Python/ class=md-nav__link> <span class=md-ellipsis> 2.Windows环境安装Python </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/3.Linux%E5%A4%9A%E7%89%88%E6%9C%ACPython%E5%AE%89%E8%A3%85/ class=md-nav__link> <span class=md-ellipsis> 3.Linux多版本Python安装 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/4.Python%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/ class=md-nav__link> <span class=md-ellipsis> 4.Python虚拟环境安装 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/5.Pycharm%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/ class=md-nav__link> <span class=md-ellipsis> 5.Pycharm安装与使用 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/6.Python%E9%97%B4%E6%8E%A5%E5%AE%9A%E4%B9%89%E5%B8%B8%E9%87%8F/ class=md-nav__link> <span class=md-ellipsis> 6.Python间接定义常量 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/7.Python%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E8%A1%A8%E8%BE%BE%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 7.Python运算符与表达式 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/8.%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5/ class=md-nav__link> <span class=md-ellipsis> 8.逻辑控制语句 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/9.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BB%8B%E7%BB%8D/ class=md-nav__link> <span class=md-ellipsis> 9.数据结构 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/10.%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D/ class=md-nav__link> <span class=md-ellipsis> 10.函数介绍 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/11.%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/ class=md-nav__link> <span class=md-ellipsis> 11.类与对象 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/12.%E6%89%93%E5%8C%85%E4%B8%8E%E5%8F%91%E5%B8%83/ class=md-nav__link> <span class=md-ellipsis> 12.打包与发布 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/13.%E5%BC%82%E5%B8%B8%E6%8D%95%E8%8E%B7%E4%B8%8E%E5%A4%84%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 13.异常捕获与处理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/14.%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/ class=md-nav__link> <span class=md-ellipsis> 14.并发编程 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/15.%E6%A0%87%E5%87%86%E5%BA%93%E5%92%8C%E4%B8%89%E6%96%B9%E5%BA%93/ class=md-nav__link> <span class=md-ellipsis> 15.标准库和三方库 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/16.vue-cli%E8%84%9A%E6%89%8B%E6%9E%B6/ class=md-nav__link> <span class=md-ellipsis> 16.vue-cli脚手架 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/3.Python%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91/17.%E6%A1%88%E4%BE%8B%E5%AE%9E%E8%B7%B5-%E4%BB%BB%E5%8A%A1%E5%88%97%E8%A1%A8/ class=md-nav__link> <span class=md-ellipsis> 17.案例实践-任务列表 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_5> <label class=md-nav__link for=__nav_6_5 id=__nav_6_5_label tabindex=0> <span class=md-ellipsis> 4.Flask-Web全栈开发 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_5> <span class="md-nav__icon md-icon"></span> 4.Flask-Web全栈开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/1.Flask%E5%89%8D%E5%A5%8F/ class=md-nav__link> <span class=md-ellipsis> 1.Flask前缀 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/2.%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE/ class=md-nav__link> <span class=md-ellipsis> 2.项目配置 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/3.URL%E4%B8%8E%E8%A7%86%E5%9B%BE/ class=md-nav__link> <span class=md-ellipsis> 3.URL与视图 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/4.Jinja2%E6%A8%A1%E6%9D%BF/ class=md-nav__link> <span class=md-ellipsis> 4.Jinja2模板 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/5.%E6%95%B0%E6%8D%AE%E5%BA%93/ class=md-nav__link> <span class=md-ellipsis> 5.数据库 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/6.%E8%A1%A8%E5%8D%95/ class=md-nav__link> <span class=md-ellipsis> 6.表单 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/7.Flask%E8%BF%9B%E9%98%B6/ class=md-nav__link> <span class=md-ellipsis> 7.Flask进阶 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/8.%E7%BC%93%E5%AD%98%E7%B3%BB%E7%BB%9F/ class=md-nav__link> <span class=md-ellipsis> 8.缓存系统 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/9.Flask%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/ class=md-nav__link> <span class=md-ellipsis> 9.Flask项目实战 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/10.WebSock%E5%AE%9E%E6%88%98/ class=md-nav__link> <span class=md-ellipsis> 10.WebSock实战 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/11.Flask%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/ class=md-nav__link> <span class=md-ellipsis> 11.Flask异步编程 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/%E9%99%84-%E4%BD%BF%E7%94%A8Pytest%E6%B5%8B%E8%AF%95Flask/ class=md-nav__link> <span class=md-ellipsis> 附-使用Pytest测试Flask </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/%E9%99%84-Flask%E5%B8%B8%E7%94%A8%E6%89%A9%E5%B1%95/ class=md-nav__link> <span class=md-ellipsis> 附-Flask常用扩展 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/%E9%99%84-Flask%E5%92%8CRedis%E9%98%9F%E5%88%97%E7%9A%84%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1/ class=md-nav__link> <span class=md-ellipsis> 附-Flask和Redis队列的异步任务 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/%E9%99%84-Flask%E5%92%8CVue.js%E5%BC%80%E5%8F%91%E5%8D%95%E9%A1%B5%E5%BA%94%E7%94%A8/ class=md-nav__link> <span class=md-ellipsis> 附-Flask和Vue.js开发单页应用 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/%E9%99%84-Flask%E5%AE%B9%E5%99%A8%E5%8C%96%E5%AE%9E%E8%B7%B5/ class=md-nav__link> <span class=md-ellipsis> 附-Flask容器化实践 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/4.Flask-Web%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/%E9%99%84-Flask%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/ class=md-nav__link> <span class=md-ellipsis> 附-Flask数据模型 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_6> <label class=md-nav__link for=__nav_6_6 id=__nav_6_6_label tabindex=0> <span class=md-ellipsis> 5.Web开发与自动化测试 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_6> <span class="md-nav__icon md-icon"></span> 5.Web开发与自动化测试 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python/5.Web%E5%BC%80%E5%8F%91%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/1.%E6%89%A9%E5%B1%95%E5%BA%93%E7%9A%84%E5%AE%89%E8%A3%85/ class=md-nav__link> <span class=md-ellipsis> 1.扩展库的安装 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_7> <label class=md-nav__link for=__nav_6_7 id=__nav_6_7_label tabindex=0> <span class=md-ellipsis> 6.CMDB项目实战 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_7_label aria-expanded=false> <label class=md-nav__title for=__nav_6_7> <span class="md-nav__icon md-icon"></span> 6.CMDB项目实战 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python/6.CMDB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/0.DRF%E5%89%8D%E5%A5%8F/ class=md-nav__link> <span class=md-ellipsis> 0.DRF前奏 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/6.CMDB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/1.DRF%E5%85%A5%E9%97%A8/ class=md-nav__link> <span class=md-ellipsis> 1.DRF入门 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/6.CMDB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/2.DRF%E8%BF%9B%E9%98%B6/ class=md-nav__link> <span class=md-ellipsis> 2.DRF进阶 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/6.CMDB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/3.CMDB%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> 3.CMDB后端开发 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/6.CMDB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/4.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91-%E4%B8%8A/ class=md-nav__link> <span class=md-ellipsis> 4.Vue前端开发-上 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/6.CMDB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/5.Vue%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91-%E4%B8%8B/ class=md-nav__link> <span class=md-ellipsis> 5.Vue前端开发-下 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/6.CMDB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/6.Element-Plus%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6%E5%BA%93/ class=md-nav__link> <span class=md-ellipsis> 6.Element-Plus前端组件库 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/6.CMDB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/7.CMDB%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91-%E4%B8%8A/ class=md-nav__link> <span class=md-ellipsis> 7.CMDB前端开发-上 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python/6.CMDB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/8.CMDB%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91-%E4%B8%8B/ class=md-nav__link> <span class=md-ellipsis> 8.CMDB前端开发-下 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Python-vs-Go </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Python-vs-Go </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_1> <label class=md-nav__link for=__nav_7_1 id=__nav_7_1_label tabindex=0> <span class=md-ellipsis> 0.线路 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_1> <span class="md-nav__icon md-icon"></span> 0.线路 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python-vs-Go/0.%E5%AD%A6%E4%B9%A0%E7%BA%BF%E8%B7%AF/0.Python-vs-Go/ class=md-nav__link> <span class=md-ellipsis> Python-vs-Go </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2> <label class=md-nav__link for=__nav_7_2 id=__nav_7_2_label tabindex=0> <span class=md-ellipsis> 1.对比 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2> <span class="md-nav__icon md-icon"></span> 1.对比 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/1.Hello-World/ class=md-nav__link> <span class=md-ellipsis> Hello-World </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/2.Print/ class=md-nav__link> <span class=md-ellipsis> Print </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/3.%E6%B3%A8%E9%87%8A/ class=md-nav__link> <span class=md-ellipsis> 注释 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/4.%E5%A4%9A%E8%A1%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/ class=md-nav__link> <span class=md-ellipsis> 多行字符串 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/5.Lists/ class=md-nav__link> <span class=md-ellipsis> Lists </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/6.Map/ class=md-nav__link> <span class=md-ellipsis> Map </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/7.Booleans/ class=md-nav__link> <span class=md-ellipsis> Booleans </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/8.Forloop/ class=md-nav__link> <span class=md-ellipsis> Forloop </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/9.Range/ class=md-nav__link> <span class=md-ellipsis> Range </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/10.Switch/ class=md-nav__link> <span class=md-ellipsis> Switch </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/11.%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0/ class=md-nav__link> <span class=md-ellipsis> 可变参数函数 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/12.%E6%97%B6%E9%97%B4%E8%AE%A1%E7%AE%97/ class=md-nav__link> <span class=md-ellipsis> 时间计算 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/13.%E5%87%BD%E6%95%B0%E7%9A%84%E9%97%AD%E5%8C%85/ class=md-nav__link> <span class=md-ellipsis> 函数的闭包 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/14.%E9%80%80%E5%87%BA%E5%A4%84%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 退出处理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/15.%E5%BC%82%E5%B8%B8%E6%8D%95%E8%8E%B7/ class=md-nav__link> <span class=md-ellipsis> 异常捕获 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/16.%E5%8F%AF%E5%8F%98%E9%A1%B9/ class=md-nav__link> <span class=md-ellipsis> 可变项 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/17.%E7%B1%BB/ class=md-nav__link> <span class=md-ellipsis> 类 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/18.%E6%96%B9%E6%B3%95/ class=md-nav__link> <span class=md-ellipsis> 方法 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/19.%E5%B9%B6%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> 并发 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/20.Args/ class=md-nav__link> <span class=md-ellipsis> Args </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/21.%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97%E5%88%AB%E5%90%8D/ class=md-nav__link> <span class=md-ellipsis> 导入模块别名 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/22.%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%8C%96/ class=md-nav__link> <span class=md-ellipsis> 字符串格式化 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/23.%E5%8E%BB%E9%87%8D/ class=md-nav__link> <span class=md-ellipsis> 去重 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/24.%E5%B8%A6%E9%A2%9C%E8%89%B2%E6%89%93%E5%8D%B0/ class=md-nav__link> <span class=md-ellipsis> 带颜色打印 </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/25.python-example/ class=md-nav__link> <span class=md-ellipsis> Python By Example </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/1.%E5%AF%B9%E6%AF%94/26.go-example/ class=md-nav__link> <span class=md-ellipsis> Go By Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3> <label class=md-nav__link for=__nav_7_3 id=__nav_7_3_label tabindex=0> <span class=md-ellipsis> 2.进阶 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3> <span class="md-nav__icon md-icon"></span> 2.进阶 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Python-vs-Go/2.%E8%BF%9B%E9%98%B6/1.%E4%BD%BF%E7%94%A8RPC/ class=md-nav__link> <span class=md-ellipsis> 使用RPC </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/2.%E8%BF%9B%E9%98%B6/2.%E4%BD%BF%E7%94%A8MySQL/ class=md-nav__link> <span class=md-ellipsis> 使用MySQL </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/2.%E8%BF%9B%E9%98%B6/3.%E4%BD%BF%E7%94%A8Redis/ class=md-nav__link> <span class=md-ellipsis> 使用Redis </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/2.%E8%BF%9B%E9%98%B6/4.%E4%BD%BF%E7%94%A8MongoDB/ class=md-nav__link> <span class=md-ellipsis> 使用MongoDB </span> </a> </li> <li class=md-nav__item> <a href=../../../Python-vs-Go/2.%E8%BF%9B%E9%98%B6/5.%E7%BB%83%E6%89%8B%E9%A1%B9%E7%9B%AE%E6%8E%A8%E8%8D%90/ class=md-nav__link> <span class=md-ellipsis> 练手项目推荐 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_1> <label class=md-nav__link for=__nav_8_1 id=__nav_8_1_label tabindex=0> <span class=md-ellipsis> Shell </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_1_label aria-expanded=false> <label class=md-nav__title for=__nav_8_1> <span class="md-nav__icon md-icon"></span> Shell </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/Shell/Shell%E7%AE%80%E4%BB%8B/ class=md-nav__link> <span class=md-ellipsis> Shell 教程概述 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/1.%E7%AC%AC%E4%B8%80%E4%B8%AAshell%E7%A8%8B%E5%BA%8F/ class=md-nav__link> <span class=md-ellipsis> 1.第一个 Shell 程序 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/2.Shell%E5%8F%98%E9%87%8F%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/ class=md-nav__link> <span class=md-ellipsis> 2.Shell变量和字符串 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/3.Shell%E5%8F%82%E6%95%B0/ class=md-nav__link> <span class=md-ellipsis> 3.Shell参数 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/4.Shell%E6%95%B0%E7%BB%84/ class=md-nav__link> <span class=md-ellipsis> 4.Shell数组 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/5.Shell%E8%BF%90%E7%AE%97%E7%AC%A6/ class=md-nav__link> <span class=md-ellipsis> 5.Shell运算符 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/6.Shell-echo_printf%E5%91%BD%E4%BB%A4/ class=md-nav__link> <span class=md-ellipsis> 6.Shell echo/printf 命令 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/7.Shell-test%E5%91%BD%E4%BB%A4/ class=md-nav__link> <span class=md-ellipsis> 7.Shell test命令 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/8.Shell%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/ class=md-nav__link> <span class=md-ellipsis> 8.Shell流程控制 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/9.Shell%E5%87%BD%E6%95%B0/ class=md-nav__link> <span class=md-ellipsis> 9.Shell函数 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/10.Shell%E8%BE%93%E5%85%A5_%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91/ class=md-nav__link> <span class=md-ellipsis> 10.Shell输入/输出重定向 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/11.Shell%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 11.Shell正则表达式 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/12.Shell%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bgrep/ class=md-nav__link> <span class=md-ellipsis> 12.Shell三剑客之grep </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/13.Shell%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bsed/ class=md-nav__link> <span class=md-ellipsis> 13.Shell三剑客之sed </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/14.Shell%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bawk/ class=md-nav__link> <span class=md-ellipsis> 14.Shell三剑客之awk </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/15.Shell%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/ class=md-nav__link> <span class=md-ellipsis> 15.Shell常用工具 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/16.Shell%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE/ class=md-nav__link> <span class=md-ellipsis> 16.Shell实战项目 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/17.Shell%E8%84%9A%E6%9C%AC%E7%A4%BA%E4%BE%8B/ class=md-nav__link> <span class=md-ellipsis> 17.Shell脚本示例 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/18.Shell%E8%84%9A%E6%9C%AC%E7%9A%84%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7/ class=md-nav__link> <span class=md-ellipsis> 18.Shell脚本的参数解析工具 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/19.%E5%AE%9E%E7%94%A8Shell%E8%84%9A%E6%9C%AC%E6%A1%88%E4%BE%8B/ class=md-nav__link> <span class=md-ellipsis> 19.实用Shell脚本案例 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/20.Shell%E8%84%9A%E6%9C%AC%E7%9A%84%E8%A7%84%E8%8C%83/ class=md-nav__link> <span class=md-ellipsis> 20.Shell脚本的规范 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/21.Shell%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%B9%B6%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> 21.Shell多进程并发 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/%E9%99%84-shell%E5%85%B6%E5%AE%83%E8%B5%84%E6%BA%90/ class=md-nav__link> <span class=md-ellipsis> 附-shell其它资源 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Shell/%E9%99%84-vim%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/ class=md-nav__link> <span class=md-ellipsis> 附-vim常用操作 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2> <label class=md-nav__link for=__nav_8_2 id=__nav_8_2_label tabindex=0> <span class=md-ellipsis> Ansible </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_2_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2> <span class="md-nav__icon md-icon"></span> Ansible </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/Ansible/1.Ansible%E5%85%A5%E9%97%A8%E5%92%8C%E5%AE%9E%E8%B7%B5/ class=md-nav__link> <span class=md-ellipsis> 1.Ansible入门和实践 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Ansible/2.Ansible-wiki/ class=md-nav__link> <span class=md-ellipsis> 2.Ansible-wiki </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_3> <label class=md-nav__link for=__nav_8_3 id=__nav_8_3_label tabindex=0> <span class=md-ellipsis> Git </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_3_label aria-expanded=false> <label class=md-nav__title for=__nav_8_3> <span class="md-nav__icon md-icon"></span> Git </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/Git/1.Git%E5%9F%BA%E7%A1%80/ class=md-nav__link> <span class=md-ellipsis> 1.Git基础 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Git/2.%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/ class=md-nav__link> <span class=md-ellipsis> 2.远程仓库 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Git/3.%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 3.分支管理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Git/4.%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86%E7%AD%96%E7%95%A5/ class=md-nav__link> <span class=md-ellipsis> 4.分支管理策略 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Git/7.%E4%BD%BF%E7%94%A8Github/ class=md-nav__link> <span class=md-ellipsis> 7.使用Github </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Git/8.%E5%AE%9E%E8%B7%B5GitHub-Flow/ class=md-nav__link> <span class=md-ellipsis> 8.实践GitHub Flow </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Git/9.%E5%AE%9E%E8%B7%B5Git-Flow/ class=md-nav__link> <span class=md-ellipsis> 9.实践Git Flow </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Git/10.%E9%A1%B9%E7%9B%AE%E8%A7%84%E8%8C%83/ class=md-nav__link> <span class=md-ellipsis> 10.项目规范 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_4> <label class=md-nav__link for=__nav_8_4 id=__nav_8_4_label tabindex=0> <span class=md-ellipsis> KVM </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_4_label aria-expanded=false> <label class=md-nav__title for=__nav_8_4> <span class="md-nav__icon md-icon"></span> KVM </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/KVM/1.kvm%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/ class=md-nav__link> <span class=md-ellipsis> 1.kvm相关命令 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/KVM/2.kvm%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%88%9B%E5%BB%BA/ class=md-nav__link> <span class=md-ellipsis> 2.kvm虚拟机创建 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/KVM/3.kvm%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/ class=md-nav__link> <span class=md-ellipsis> 3.kvm网络配置 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_5> <label class=md-nav__link for=__nav_8_5 id=__nav_8_5_label tabindex=0> <span class=md-ellipsis> Nginx </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_5_label aria-expanded=false> <label class=md-nav__title for=__nav_8_5> <span class="md-nav__icon md-icon"></span> Nginx </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/Nginx/1.Nginx%E7%AE%80%E4%BB%8B/ class=md-nav__link> <span class=md-ellipsis> 1.Nginx简介 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/2.Nginx%E5%AE%89%E8%A3%85%E5%8F%8A%E5%90%AF%E5%8A%A8/ class=md-nav__link> <span class=md-ellipsis> 2.Nginx安装及启动 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/3.Nginx%E9%85%8D%E7%BD%AE/ class=md-nav__link> <span class=md-ellipsis> 3.Nginx配置 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/4.Nginx%E9%85%8D%E7%BD%AE%E4%B8%8B%E8%BD%BD%E7%AB%99%E7%82%B9/ class=md-nav__link> <span class=md-ellipsis> 4.Nginx配置下载站点 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/5.Nginx%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/ class=md-nav__link> <span class=md-ellipsis> 5.Nginx访问控制 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/6.Nginx%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA/ class=md-nav__link> <span class=md-ellipsis> 6.Nginx虚拟主机 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/7.Nginx%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90/ class=md-nav__link> <span class=md-ellipsis> 7.Nginx静态资源 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/8.Nginx%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE/ class=md-nav__link> <span class=md-ellipsis> 8.Nginx缓存配置 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/9.Nginx%E6%AD%A3%E5%8F%8D%E4%BB%A3%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 9.Nginx正反向代理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/10.Nginx%E9%98%B2%E7%9B%97%E9%93%BE/ class=md-nav__link> <span class=md-ellipsis> 10.Nginx防盗链 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/11.Nginx%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/ class=md-nav__link> <span class=md-ellipsis> 11.Nginx负载均衡 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/12.Nginx%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/ class=md-nav__link> <span class=md-ellipsis> 12.Nginx动静分离 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/13.Nginx%E8%B7%A8%E5%9F%9F%E9%85%8D%E7%BD%AE/ class=md-nav__link> <span class=md-ellipsis> 13.Nginx跨域配置 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/14.Nginx%E9%87%8D%E5%AE%9A%E5%90%91/ class=md-nav__link> <span class=md-ellipsis> 14.Nginx重定向 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/15.Nginx-HTTPS/ class=md-nav__link> <span class=md-ellipsis> 15.Nginx HTTPS </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/16.%E9%99%84-Nginx-location%E8%AF%AD%E6%B3%95/ class=md-nav__link> <span class=md-ellipsis> 16.附-Nginx-location语法 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/Nginx/17.%E9%99%84-Nginx%E4%BB%A3%E7%90%86%E7%9B%B8%E5%85%B3%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> 17.附-Nginx代理相关模块解析 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_6> <label class=md-nav__link for=__nav_8_6 id=__nav_8_6_label tabindex=0> <span class=md-ellipsis> System </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_6_label aria-expanded=false> <label class=md-nav__title for=__nav_8_6> <span class="md-nav__icon md-icon"></span> System </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/System/1.%E7%B3%BB%E7%BB%9F%E9%95%9C%E5%83%8F%E5%92%8C%E8%BD%AF%E4%BB%B6%E6%BA%90/ class=md-nav__link> <span class=md-ellipsis> 1.系统镜像和软件源 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/2.Linux%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/ class=md-nav__link> <span class=md-ellipsis> 2.Linux安全加固 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/3.Systemd/ class=md-nav__link> <span class=md-ellipsis> 3.Systemd </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/4.Superivisor/ class=md-nav__link> <span class=md-ellipsis> 4.Superivisor </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/5.SSH%E7%99%BB%E5%BD%95Linux%E6%98%BE%E7%A4%BA%E6%A8%AA%E5%B9%85/ class=md-nav__link> <span class=md-ellipsis> 5.SSH登录Linux显示横幅 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/6.Linux%E4%B8%AD%E7%AB%AF%E5%8F%A3%E5%8D%A0%E7%94%A8%E6%8E%92%E6%9F%A5/ class=md-nav__link> <span class=md-ellipsis> 6.Linux中端口占用排查 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/7.%E4%BD%BF%E7%94%A8curl%E5%8F%91%E9%80%81REST-API%E8%AF%B7%E6%B1%82/ class=md-nav__link> <span class=md-ellipsis> 7.使用curl发送REST API请求 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/8.%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%A8%A1%E7%B3%8A%E6%9F%A5%E6%89%BE%E5%99%A8fzf/ class=md-nav__link> <span class=md-ellipsis> 8.命令行模糊查找器fzf </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/9.Centos7.9%E7%B3%BB%E7%BB%9F%E7%9B%98%E6%89%A9%E5%AE%B9/ class=md-nav__link> <span class=md-ellipsis> 9.Centos7.9系统盘扩容 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/10.Centos%E5%9C%A8%E7%BA%BF-%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96/ class=md-nav__link> <span class=md-ellipsis> 10.Centos在线-离线安装依赖 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/11.rsync-ssh/ class=md-nav__link> <span class=md-ellipsis> 11.rsync ssh使用 </span> </a> </li> <li class=md-nav__item> <a href=../../../Linux/System/12.%E5%90%84%E5%A4%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%81%9ARAID/ class=md-nav__link> <span class=md-ellipsis> 12.各大服务器做RAID </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_7> <label class=md-nav__link for=__nav_8_7 id=__nav_8_7_label tabindex=0> <span class=md-ellipsis> Serveices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_7_label aria-expanded=false> <label class=md-nav__title for=__nav_8_7> <span class="md-nav__icon md-icon"></span> Serveices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/Serveices/0.ubuntu-desktop-vmware/ class=md-nav__link> <span class=md-ellipsis> ubuntu-desktop-vmware </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Other </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Other </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_1> <label class=md-nav__link for=__nav_9_1 id=__nav_9_1_label tabindex=0> <span class=md-ellipsis> tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_1_label aria-expanded=false> <label class=md-nav__title for=__nav_9_1> <span class="md-nav__icon md-icon"></span> tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Other/tools/1.PicGo%E5%9B%BE%E5%BA%8A/ class=md-nav__link> <span class=md-ellipsis> 1.PicGo图床 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/tools/2.PicX%E5%9B%BE%E5%BA%8A/ class=md-nav__link> <span class=md-ellipsis> 2.Picx图床 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/tools/3.Markdown%E8%AF%AD%E6%B3%95/ class=md-nav__link> <span class=md-ellipsis> 3.Markdown语法 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/tools/4.KeyManager/ class=md-nav__link> <span class=md-ellipsis> 4.KeyManager </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/tools/5.mkdocs-material%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/ class=md-nav__link> <span class=md-ellipsis> 5.mkdocs-material搭建博客 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/tools/6.sphinx%E6%9E%84%E5%BB%BA%E5%8D%9A%E5%AE%A2/ class=md-nav__link> <span class=md-ellipsis> 6.sphinx构建博客 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/tools/7.%E4%BC%81%E4%B8%9A%E7%BA%A7VPN%E8%BD%AF%E4%BB%B6AnyLink/ class=md-nav__link> <span class=md-ellipsis> 7.企业级VPN软件AnyLink </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/tools/8.%E5%B9%B3%E5%8F%B0%E5%8F%8A%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/ class=md-nav__link> <span class=md-ellipsis> 8.平台及工具汇总 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/tools/9.%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 9.自动更新系统代理 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/tools/10.Bash-to-Bat-Converter/ class=md-nav__link> <span class=md-ellipsis> 10.Bash-to-Bat-Converter </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_2> <label class=md-nav__link for=__nav_9_2 id=__nav_9_2_label tabindex=0> <span class=md-ellipsis> windows </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_2_label aria-expanded=false> <label class=md-nav__title for=__nav_9_2> <span class="md-nav__icon md-icon"></span> windows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Other/windows/1.%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E4%B8%8B%E8%BD%BD/ class=md-nav__link> <span class=md-ellipsis> 1.常用软件下载 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/windows/2.windows%E6%9F%A5%E7%9C%8B%E7%AB%AF%E5%8F%A3%E5%8D%A0%E7%94%A8/ class=md-nav__link> <span class=md-ellipsis> 2.windows查看端口占用 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/windows/3.Win11%E9%95%9C%E5%83%8F%E4%B8%8B%E8%BD%BD%E3%80%81%E5%A3%81%E7%BA%B8%E5%8F%8AKMS%E6%BF%80%E6%B4%BB/ class=md-nav__link> <span class=md-ellipsis> 3.Win11镜像下载、壁纸及KMS激活 </span> </a> </li> <li class=md-nav__item> <a href=../../../Other/windows/4.windows%E4%B8%8Bnetcat%E5%AE%89%E8%A3%85/ class=md-nav__link> <span class=md-ellipsis> 4.windows下netcat安装 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_3> <label class=md-nav__link for=__nav_9_3 id=__nav_9_3_label tabindex=0> <span class=md-ellipsis> Interview </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_3_label aria-expanded=false> <label class=md-nav__title for=__nav_9_3> <span class="md-nav__icon md-icon"></span> Interview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Other/Interview/0.%E9%9D%A2%E8%AF%95%E5%AE%9D%E5%85%B8/ class=md-nav__link> <span class=md-ellipsis> 面试宝典 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-dockerfile指令 class=md-nav__link> <span class=md-ellipsis> 1. Dockerfile指令 </span> </a> </li> <li class=md-nav__item> <a href=#2dockerfile自定义镜像 class=md-nav__link> <span class=md-ellipsis> 2.Dockerfile自定义镜像 </span> </a> <nav class=md-nav aria-label=2.Dockerfile自定义镜像> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-查看运行容器的dockerfile工具 class=md-nav__link> <span class=md-ellipsis> 2.1 查看运行容器的Dockerfile工具 </span> </a> </li> <li class=md-nav__item> <a href=#22-查看docker容器运行命令的所有参数 class=md-nav__link> <span class=md-ellipsis> 2.2 查看docker容器运行命令的所有参数 </span> </a> </li> <li class=md-nav__item> <a href=#23-热门dockerfile示例 class=md-nav__link> <span class=md-ellipsis> 2.3 热门Dockerfile示例 </span> </a> <nav class=md-nav aria-label="2.3 热门Dockerfile示例"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx class=md-nav__link> <span class=md-ellipsis> Nginx </span> </a> </li> <li class=md-nav__item> <a href=#python class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=#django class=md-nav__link> <span class=md-ellipsis> Django </span> </a> </li> <li class=md-nav__item> <a href=#flask class=md-nav__link> <span class=md-ellipsis> Flask </span> </a> </li> <li class=md-nav__item> <a href=#golang class=md-nav__link> <span class=md-ellipsis> Golang </span> </a> </li> <li class=md-nav__item> <a href=#nodejs class=md-nav__link> <span class=md-ellipsis> Node.js </span> </a> </li> <li class=md-nav__item> <a href=#redis class=md-nav__link> <span class=md-ellipsis> Redis </span> </a> </li> <li class=md-nav__item> <a href=#mysql class=md-nav__link> <span class=md-ellipsis> MySQL </span> </a> </li> <li class=md-nav__item> <a href=#mongodb class=md-nav__link> <span class=md-ellipsis> Mongodb </span> </a> </li> <li class=md-nav__item> <a href=#postgres class=md-nav__link> <span class=md-ellipsis> Postgres </span> </a> </li> <li class=md-nav__item> <a href=#httpd class=md-nav__link> <span class=md-ellipsis> httpd </span> </a> </li> <li class=md-nav__item> <a href=#java class=md-nav__link> <span class=md-ellipsis> Java </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3dockerfile编写优化 class=md-nav__link> <span class=md-ellipsis> 3.Dockerfile编写优化 </span> </a> <nav class=md-nav aria-label=3.Dockerfile编写优化> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31-使用小的基础镜像 class=md-nav__link> <span class=md-ellipsis> 3.1 使用小的基础镜像 </span> </a> <nav class=md-nav aria-label="3.1 使用小的基础镜像"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#应用已安装环境的镜像 class=md-nav__link> <span class=md-ellipsis> 应用已安装环境的镜像 </span> </a> </li> <li class=md-nav__item> <a href=#busterstretchjessie class=md-nav__link> <span class=md-ellipsis> buster/stretch/jessie </span> </a> </li> <li class=md-nav__item> <a href=#slim class=md-nav__link> <span class=md-ellipsis> slim </span> </a> </li> <li class=md-nav__item> <a href=#alpine class=md-nav__link> <span class=md-ellipsis> alpine </span> </a> </li> <li class=md-nav__item> <a href=#选择镜像 class=md-nav__link> <span class=md-ellipsis> 选择镜像 </span> </a> </li> <li class=md-nav__item> <a href=#关于版本的说明 class=md-nav__link> <span class=md-ellipsis> 关于版本的说明 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#32-指令链式运行 class=md-nav__link> <span class=md-ellipsis> 3.2 指令链式运行 </span> </a> </li> <li class=md-nav__item> <a href=#33-变动的指令放到最后 class=md-nav__link> <span class=md-ellipsis> 3.3 变动的指令放到最后 </span> </a> </li> <li class=md-nav__item> <a href=#34-首选数组而不是字符串语法 class=md-nav__link> <span class=md-ellipsis> 3.4 首选数组而不是字符串语法 </span> </a> <nav class=md-nav aria-label="3.4 首选数组而不是字符串语法"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cmd class=md-nav__link> <span class=md-ellipsis> CMD </span> </a> </li> <li class=md-nav__item> <a href=#entrypoint class=md-nav__link> <span class=md-ellipsis> ENTRYPOINT </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#35-每个run指令后删除多余文件 class=md-nav__link> <span class=md-ellipsis> 3.5 每个RUN指令后删除多余文件 </span> </a> </li> <li class=md-nav__item> <a href=#36-copy而不是add class=md-nav__link> <span class=md-ellipsis> 3.6 COPY而不是ADD </span> </a> </li> <li class=md-nav__item> <a href=#37-使用dockerignore class=md-nav__link> <span class=md-ellipsis> 3.7 使用.dockerignore </span> </a> </li> <li class=md-nav__item> <a href=#38-利用多阶段构建 class=md-nav__link> <span class=md-ellipsis> 3.8 利用多阶段构建 </span> </a> </li> <li class=md-nav__item> <a href=#39-写dockerfile的一些技巧 class=md-nav__link> <span class=md-ellipsis> 3.9 写Dockerfile的一些技巧 </span> </a> <nav class=md-nav aria-label="3.9 写Dockerfile的一些技巧"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1用-python--m-pip-而不是-pip class=md-nav__link> <span class=md-ellipsis> 1.用 python -m pip 而不是 pip </span> </a> </li> <li class=md-nav__item> <a href=#2让-apt-get-install-更安静 class=md-nav__link> <span class=md-ellipsis> 2.让 apt-get install 更安静 </span> </a> </li> <li class=md-nav__item> <a href=#3让-curl-和-wget-更安静 class=md-nav__link> <span class=md-ellipsis> 3.让 curl 和 wget 更安静 </span> </a> </li> <li class=md-nav__item> <a href=#4用axel而不是curl或者wget class=md-nav__link> <span class=md-ellipsis> 4.用axel而不是curl或者wget </span> </a> </li> <li class=md-nav__item> <a href=#5设置容器时间同步 class=md-nav__link> <span class=md-ellipsis> 5.设置容器时间同步 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#310-docker-build镜像创建 class=md-nav__link> <span class=md-ellipsis> 3.10 docker build镜像创建 </span> </a> </li> <li class=md-nav__item> <a href=#311-dockerfile参考 class=md-nav__link> <span class=md-ellipsis> 3.11 dockerfile参考 </span> </a> </li> <li class=md-nav__item> <a href=#312-添加healthcheck class=md-nav__link> <span class=md-ellipsis> 3.12 添加HEALTHCHECK </span> </a> </li> <li class=md-nav__item> <a href=#313-dockerfile优化实例 class=md-nav__link> <span class=md-ellipsis> 3.13 Dockerfile优化实例 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4buildkit class=md-nav__link> <span class=md-ellipsis> 4.BuildKit </span> </a> <nav class=md-nav aria-label=4.BuildKit> <ul class=md-nav__list> <li class=md-nav__item> <a href=#41-安装buildx class=md-nav__link> <span class=md-ellipsis> 4.1 安装buildx </span> </a> </li> <li class=md-nav__item> <a href=#42-buildx示例 class=md-nav__link> <span class=md-ellipsis> 4.2 buildx示例 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5dockerfile实践 class=md-nav__link> <span class=md-ellipsis> 5.Dockerfile实践 </span> </a> <nav class=md-nav aria-label=5.Dockerfile实践> <ul class=md-nav__list> <li class=md-nav__item> <a href=#51-构建nginx基础镜像 class=md-nav__link> <span class=md-ellipsis> 5.1 构建Nginx基础镜像 </span> </a> </li> <li class=md-nav__item> <a href=#52-构建php基础镜像 class=md-nav__link> <span class=md-ellipsis> 5.2 构建PHP基础镜像 </span> </a> </li> <li class=md-nav__item> <a href=#53-构建tomcat基础镜像 class=md-nav__link> <span class=md-ellipsis> 5.3 构建Tomcat基础镜像 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6dockerfile工具 class=md-nav__link> <span class=md-ellipsis> 6.Dockerfile工具 </span> </a> </li> <li class=md-nav__item> <a href=#7参考文献 class=md-nav__link> <span class=md-ellipsis> 7.参考文献 </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=7dockerfile>7.Dockerfile<a class=headerlink href=#7dockerfile title="Permanent link">&para;</a></h1> <h2 id=1-dockerfile指令>1. Dockerfile指令<a class=headerlink href=#1-dockerfile指令 title="Permanent link">&para;</a></h2> <p><strong>Docker Dockerfile</strong></p> <p><a href=https://www.runoob.com/docker/docker-dockerfile.html>https://www.runoob.com/docker/docker-dockerfile.html</a></p> <p><a href=https://www.cnblogs.com/ssgeek/p/15600966.html>https://www.cnblogs.com/ssgeek/p/15600966.html</a></p> <p>Dockerfile中的指令及说明</p> <table> <thead> <tr> <th>指令</th> <th>说明</th> </tr> </thead> <tbody> <tr> <td>FROM</td> <td>指定创建基础镜像</td> </tr> <tr> <td>MAINTAINER</td> <td>指定维护者信息</td> </tr> <tr> <td>RUN</td> <td>运行命令</td> </tr> <tr> <td>CMD</td> <td>指定启动容器时默认执行的命令</td> </tr> <tr> <td>LABEL</td> <td>指定生成镜像的元数据标签信息</td> </tr> <tr> <td>EXPOSE</td> <td>声明镜像内服务所监听的端口</td> </tr> <tr> <td>ENV</td> <td>指定环境变量</td> </tr> <tr> <td>ADD</td> <td>复制指定的src下的内容到容器中的dest</td> </tr> <tr> <td>COPY</td> <td>复制本地主机的src路径下的内容到镜像中的dest下</td> </tr> <tr> <td>ENTRYPOINT</td> <td>指定镜像的默认入口</td> </tr> <tr> <td>VOLUME</td> <td>创建数据卷挂载点</td> </tr> <tr> <td>USER</td> <td>指定运行容器时的用户名或UID</td> </tr> <tr> <td>WORKDIR</td> <td>配置工作目录</td> </tr> <tr> <td>ARG</td> <td>指定镜像内使用的参数（例如版本号信息等）</td> </tr> <tr> <td>ONBUILD</td> <td>当作为其他镜像的基础镜像时，所执行的创建操作指令</td> </tr> <tr> <td>STOPSIGNAL</td> <td>容器退出的信号值</td> </tr> <tr> <td>HEALTHCHECK</td> <td>如何进行健康检查</td> </tr> <tr> <td>SHELL</td> <td>指定使用shell时的默认shell类型</td> </tr> </tbody> </table> <h2 id=2dockerfile自定义镜像>2.Dockerfile自定义镜像<a class=headerlink href=#2dockerfile自定义镜像 title="Permanent link">&para;</a></h2> <h3 id=21-查看运行容器的dockerfile工具>2.1 查看运行容器的Dockerfile工具<a class=headerlink href=#21-查看运行容器的dockerfile工具 title="Permanent link">&para;</a></h3> <ul> <li>项目地址：<a href=https://github.com/P3GLEG/Whaler>Whaler(opens new window)</a></li> <li>项目说明：能够查看在运行容器的Dockerfile的工具，有时候我们可能会维护一个没有Dockerfile的容器，即可借助此工具。</li> <li>相关文章：<a href=https://samaritan.ai/blog/reversing-docker-images-into-dockerfiles/ >博文介绍</a></li> </ul> <h3 id=22-查看docker容器运行命令的所有参数>2.2 查看docker容器运行命令的所有参数<a class=headerlink href=#22-查看docker容器运行命令的所有参数 title="Permanent link">&para;</a></h3> <ul> <li>项目地址：<a href=https://github.com/lavie/runlike>runlike(opens new window)</a></li> <li>项目说明：给定一个现有的 docker 容器，打印运行它的副本所需的命令行。</li> <li>相关文章：README</li> </ul> <p>可以将运行的docker 推导反写为docker-compose文件</p> <p>一些需要注意的事项：</p> <ul> <li> <p>当 docker run 命令中声明了参数时，Docker 守护程序会忽略 CMD 命令。</p> </li> <li> <p>与CMD不同的是，由ENTRYPOINT启动的程序不会被docker run命令行指定的参数所覆盖，而且，这些命令行参数会被当作参数传递给ENTRYPOINT指定的程序。不过，docker run 命令的<code>--entrypoint</code>选项的参数可覆盖ENTRYPOINT指令指定的程序</p> </li> <li> <p>Dockfile中，如果没有使用CMD指定启动命令，则会继承上一个镜像的默认启动命令；CMD 容器的默认启动命令，有且只能有一条；</p> </li> </ul> <p>根据Dockerfile生成新的镜像命令中,build 创建新的镜像；<code>-t</code>指定新镜像的名字和标签；<code>.</code>指定Dockerfile文件所在的目录</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>docker<span class=w> </span>build<span class=w> </span>-t<span class=w> </span>imagename:latest<span class=w> </span>Dockerfile所在目录
</code></pre></div> <p>容器和镜像之间的主要区别在于顶部 可写层。对容器的所有添加新数据或修改现有数据的写入都存储在此 可写层 中。删除容器时，可写层也会被删除。基础镜像保持不变。</p> <p>这里利用了<code>写时复制技术(COW,copy on write)</code> , 对于开发的小伙伴，可以结合享元设计模式理解，对于运维的小伙伴，可以结合 Openstack 组件 Glance 原理来理解</p> <p>用通俗的话讲，当修改时，会把数据复制到容器层修改。</p> <p>当新增的时候直接在容器层新增，当删除时，会屏蔽镜像层。</p> <p>Docker 通过读取给定的指令来自动构建镜像。<code>遵循特定的格式和指令集，其中的 每一条指令在容器镜像中创建一个层。这些层是堆叠的，每个层都是与前一层相比的变化的增量</code></p> <p>这里我们以 <code>redis:7</code> 这个官方镜像为例,看看一个标准的 Dockerfile 如何书写，可以看到镜像构建了 16 层。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>$<span class=w> </span>docker<span class=w> </span><span class=nb>history</span><span class=w> </span>--human<span class=o>=</span><span class=nb>true</span><span class=w>  </span>redis:7
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>IMAGE<span class=w>          </span>CREATED<span class=w>       </span>CREATED<span class=w> </span>BY<span class=w>                                      </span>SIZE<span class=w>      </span>COMMENT
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>19c51d4327cf<span class=w>   </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop)  CMD [&quot;redis-server&quot;]         0B</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop)  EXPOSE 6379                  0B</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop)  ENTRYPOINT [&quot;docker-entry…   0B</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop) COPY file:e873a0e3c13001b5…   661B</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop) WORKDIR /data                 0B</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop)  VOLUME [/data]               0B</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span>mkdir<span class=w> </span>/data<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>chown<span class=w> </span>redis:redis<span class=w> </span>…<span class=w>   </span>0B
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=nb>set</span><span class=w> </span>-eux<span class=p>;</span><span class=w>   </span><span class=nv>savedAptMark</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>apt-m…<span class=w>   </span>32MB
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop)  ENV REDIS_DOWNLOAD_SHA=06…   0B</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop)  ENV REDIS_DOWNLOAD_URL=ht…   0B</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>&lt;missing&gt;<span class=w>      </span><span class=m>6</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop)  ENV REDIS_VERSION=7.0.8      0B</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>&lt;missing&gt;<span class=w>      </span><span class=m>7</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=nb>set</span><span class=w> </span>-eux<span class=p>;</span><span class=w>  </span><span class=nv>savedAptMark</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>apt-ma…<span class=w>   </span><span class=m>4</span>.13MB
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>&lt;missing&gt;<span class=w>      </span><span class=m>7</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop)  ENV GOSU_VERSION=1.14        0B</span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>&lt;missing&gt;<span class=w>      </span><span class=m>7</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span>groupadd<span class=w> </span>-r<span class=w> </span>-g<span class=w> </span><span class=m>999</span><span class=w> </span>redis<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>usera…<span class=w>   </span>329kB
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>&lt;missing&gt;<span class=w>      </span><span class=m>7</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop)  CMD [&quot;bash&quot;]                 0B</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>&lt;missing&gt;<span class=w>      </span><span class=m>7</span><span class=w> </span>weeks<span class=w> </span>ago<span class=w>   </span>/bin/sh<span class=w> </span>-c<span class=w> </span><span class=c1>#(nop) ADD file:e2398d0bf516084b2…   80.5MB</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>┌──<span class=o>[</span>root@vms107.liruilongs.github.io<span class=o>]</span>-<span class=o>[</span>/etc/systemd<span class=o>]</span>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>└─<span class=nv>$docker</span><span class=w> </span><span class=nb>history</span><span class=w> </span>--human<span class=o>=</span><span class=nb>true</span><span class=w>  </span>redis:7<span class=w> </span><span class=p>|</span><span class=w> </span>wc<span class=w> </span>-l
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=m>17</span>
</code></pre></div> <p>涉及 两个Dockerfile文件构建的镜像</p> <p>基础镜像构建</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>FROM<span class=w> </span>scratch
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>ADD<span class=w> </span>rootfs.tar.xz<span class=w> </span>/
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>CMD<span class=w> </span><span class=o>[</span><span class=s2>&quot;bash&quot;</span><span class=o>]</span>
</code></pre></div> <p>reids镜像构建 <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>FROM</span><span class=w> </span><span class=s>debian:bullseye-slim</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=c># add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=k>RUN</span><span class=w> </span>groupadd<span class=w> </span>-r<span class=w> </span>-g<span class=w> </span><span class=m>999</span><span class=w> </span>redis<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>useradd<span class=w> </span>-r<span class=w> </span>-g<span class=w> </span>redis<span class=w> </span>-u<span class=w> </span><span class=m>999</span><span class=w> </span>redis
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=c># grab gosu for easy step-down from root</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=c># https://github.com/tianon/gosu/releases</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=k>ENV</span><span class=w> </span>GOSU_VERSION<span class=w> </span><span class=m>1</span>.16
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-eux<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w> </span><span class=nv>savedAptMark</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>apt-mark<span class=w> </span>showmanual<span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w> </span>apt-get<span class=w> </span>update<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span>ca-certificates<span class=w> </span>dirmngr<span class=w> </span>gnupg<span class=w> </span>wget<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=w> </span><span class=nv>dpkgArch</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>dpkg<span class=w> </span>--print-architecture<span class=w> </span><span class=p>|</span><span class=w> </span>awk<span class=w> </span>-F-<span class=w> </span><span class=s1>&#39;{ print $NF }&#39;</span><span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=w> </span>wget<span class=w> </span>-O<span class=w> </span>/usr/local/bin/gosu<span class=w> </span><span class=s2>&quot;https://github.com/tianon/gosu/releases/download/</span><span class=nv>$GOSU_VERSION</span><span class=s2>/gosu-</span><span class=nv>$dpkgArch</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=w> </span>wget<span class=w> </span>-O<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span><span class=s2>&quot;https://github.com/tianon/gosu/releases/download/</span><span class=nv>$GOSU_VERSION</span><span class=s2>/gosu-</span><span class=nv>$dpkgArch</span><span class=s2>.asc&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=w> </span><span class=nb>export</span><span class=w> </span><span class=nv>GNUPGHOME</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>mktemp<span class=w> </span>-d<span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=w> </span>gpg<span class=w> </span>--batch<span class=w> </span>--keyserver<span class=w> </span>hkps://keys.openpgp.org<span class=w> </span>--recv-keys<span class=w> </span>B42F6819007F00F88E364FD4036A9C25BF357DD4<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=w> </span>gpg<span class=w> </span>--batch<span class=w> </span>--verify<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span>/usr/local/bin/gosu<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=w> </span>gpgconf<span class=w> </span>--kill<span class=w> </span>all<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span><span class=s2>&quot;</span><span class=nv>$GNUPGHOME</span><span class=s2>&quot;</span><span class=w> </span>/usr/local/bin/gosu.asc<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=w> </span>apt-mark<span class=w> </span>auto<span class=w> </span><span class=s1>&#39;.*&#39;</span><span class=w> </span>&gt;<span class=w> </span>/dev/null<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a><span class=w> </span><span class=o>[</span><span class=w> </span>-z<span class=w> </span><span class=s2>&quot;</span><span class=nv>$savedAptMark</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>apt-mark<span class=w> </span>manual<span class=w> </span><span class=nv>$savedAptMark</span><span class=w> </span>&gt;<span class=w> </span>/dev/null<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a><span class=w> </span>apt-get<span class=w> </span>purge<span class=w> </span>-y<span class=w> </span>--auto-remove<span class=w> </span>-o<span class=w> </span>APT::AutoRemove::RecommendsImportant<span class=o>=</span>false<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=w> </span>chmod<span class=w> </span>+x<span class=w> </span>/usr/local/bin/gosu<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a><span class=w> </span>gosu<span class=w> </span>--version<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=w> </span>gosu<span class=w> </span>nobody<span class=w> </span>true
<a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>
<a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=k>ENV</span><span class=w> </span>REDIS_VERSION<span class=w> </span><span class=m>7</span>.0.9
<a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=k>ENV</span><span class=w> </span>REDIS_DOWNLOAD_URL<span class=w> </span>http://download.redis.io/releases/redis-7.0.9.tar.gz
<a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=k>ENV</span><span class=w> </span>REDIS_DOWNLOAD_SHA<span class=w> </span>f77135c2a47c9151d4028bfea3b34470ab4d324d1484f79a84c6f32a3cfb9f65
<a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a>
<a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-eux<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a><span class=w> </span><span class=nv>savedAptMark</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>apt-mark<span class=w> </span>showmanual<span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a><span class=w> </span>apt-get<span class=w> </span>update<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a><span class=w>  </span>ca-certificates<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a><span class=w>  </span>wget<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a><span class=w>  </span><span class=se>\</span>
<a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a><span class=w>  </span>dpkg-dev<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a><span class=w>  </span>gcc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a><span class=w>  </span>libc6-dev<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-44 name=__codelineno-3-44 href=#__codelineno-3-44></a><span class=w>  </span>libssl-dev<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-45 name=__codelineno-3-45 href=#__codelineno-3-45></a><span class=w>  </span>make<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-46 name=__codelineno-3-46 href=#__codelineno-3-46></a><span class=w> </span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-47 name=__codelineno-3-47 href=#__codelineno-3-47></a><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-48 name=__codelineno-3-48 href=#__codelineno-3-48></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-49 name=__codelineno-3-49 href=#__codelineno-3-49></a><span class=w> </span>wget<span class=w> </span>-O<span class=w> </span>redis.tar.gz<span class=w> </span><span class=s2>&quot;</span><span class=nv>$REDIS_DOWNLOAD_URL</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-50 name=__codelineno-3-50 href=#__codelineno-3-50></a><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$REDIS_DOWNLOAD_SHA</span><span class=s2> *redis.tar.gz&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>sha256sum<span class=w> </span>-c<span class=w> </span>-<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-51 name=__codelineno-3-51 href=#__codelineno-3-51></a><span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>/usr/src/redis<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-52 name=__codelineno-3-52 href=#__codelineno-3-52></a><span class=w> </span>tar<span class=w> </span>-xzf<span class=w> </span>redis.tar.gz<span class=w> </span>-C<span class=w> </span>/usr/src/redis<span class=w> </span>--strip-components<span class=o>=</span><span class=m>1</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-53 name=__codelineno-3-53 href=#__codelineno-3-53></a><span class=w> </span>rm<span class=w> </span>redis.tar.gz<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-54 name=__codelineno-3-54 href=#__codelineno-3-54></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-55 name=__codelineno-3-55 href=#__codelineno-3-55></a>#<span class=w> </span>disable<span class=w> </span>Redis<span class=w> </span>protected<span class=w> </span>mode<span class=w> </span><span class=o>[</span><span class=m>1</span><span class=o>]</span><span class=w> </span>as<span class=w> </span>it<span class=w> </span>is<span class=w> </span>unnecessary<span class=w> </span><span class=k>in</span><span class=w> </span>context<span class=w> </span>of<span class=w> </span>Docker
<a id=__codelineno-3-56 name=__codelineno-3-56 href=#__codelineno-3-56></a><span class=c># (ports are not automatically exposed when running inside Docker, but rather explicitly by specifying -p / -P)</span>
<a id=__codelineno-3-57 name=__codelineno-3-57 href=#__codelineno-3-57></a><span class=c># [1]: https://github.com/redis/redis/commit/edd4d555df57dc84265fdfb4ef59a4678832f6da</span>
<a id=__codelineno-3-58 name=__codelineno-3-58 href=#__codelineno-3-58></a><span class=w> </span>grep<span class=w> </span>-E<span class=w> </span><span class=s1>&#39;^ *createBoolConfig[(]&quot;protected-mode&quot;,.*, *1 *,.*[)],$&#39;</span><span class=w> </span>/usr/src/redis/src/config.c<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-59 name=__codelineno-3-59 href=#__codelineno-3-59></a><span class=w> </span>sed<span class=w> </span>-ri<span class=w> </span><span class=s1>&#39;s!^( *createBoolConfig[(]&quot;protected-mode&quot;,.*, *)1( *,.*[)],)$!\10\2!&#39;</span><span class=w> </span>/usr/src/redis/src/config.c<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-60 name=__codelineno-3-60 href=#__codelineno-3-60></a><span class=w> </span>grep<span class=w> </span>-E<span class=w> </span><span class=s1>&#39;^ *createBoolConfig[(]&quot;protected-mode&quot;,.*, *0 *,.*[)],$&#39;</span><span class=w> </span>/usr/src/redis/src/config.c<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-61 name=__codelineno-3-61 href=#__codelineno-3-61></a>#<span class=w> </span><span class=k>for</span><span class=w> </span>future<span class=w> </span>reference,<span class=w> </span>we<span class=w> </span>modify<span class=w> </span>this<span class=w> </span>directly<span class=w> </span><span class=k>in</span><span class=w> </span>the<span class=w> </span><span class=nb>source</span><span class=w> </span>instead<span class=w> </span>of<span class=w> </span>just<span class=w> </span>supplying<span class=w> </span>a<span class=w> </span>default<span class=w> </span>configuration<span class=w> </span>flag<span class=w> </span>because<span class=w> </span>apparently<span class=w> </span><span class=s2>&quot;if you specify any argument to redis-server, [it assumes] you are going to specify everything&quot;</span>
<a id=__codelineno-3-62 name=__codelineno-3-62 href=#__codelineno-3-62></a><span class=c># see also https://github.com/docker-library/redis/issues/4#issuecomment-50780840</span>
<a id=__codelineno-3-63 name=__codelineno-3-63 href=#__codelineno-3-63></a><span class=c># (more exactly, this makes sure the default behavior of &quot;save on SIGTERM&quot; stays functional by default)</span>
<a id=__codelineno-3-64 name=__codelineno-3-64 href=#__codelineno-3-64></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-65 name=__codelineno-3-65 href=#__codelineno-3-65></a>#<span class=w> </span>https://github.com/jemalloc/jemalloc/issues/467<span class=w> </span>--<span class=w> </span>we<span class=w> </span>need<span class=w> </span>to<span class=w> </span>patch<span class=w> </span>the<span class=w> </span><span class=s2>&quot;./configure&quot;</span><span class=w> </span><span class=k>for</span><span class=w> </span>the<span class=w> </span>bundled<span class=w> </span>jemalloc<span class=w> </span>to<span class=w> </span>match<span class=w> </span>how<span class=w> </span>Debian<span class=w> </span>compiles,<span class=w> </span><span class=k>for</span><span class=w> </span>compatibility
<a id=__codelineno-3-66 name=__codelineno-3-66 href=#__codelineno-3-66></a><span class=c># (also, we do cross-builds, so we need to embed the appropriate &quot;--build=xxx&quot; values to that &quot;./configure&quot; invocation)</span>
<a id=__codelineno-3-67 name=__codelineno-3-67 href=#__codelineno-3-67></a><span class=w> </span><span class=nv>gnuArch</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>dpkg-architecture<span class=w> </span>--query<span class=w> </span>DEB_BUILD_GNU_TYPE<span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-68 name=__codelineno-3-68 href=#__codelineno-3-68></a><span class=w> </span><span class=nv>extraJemallocConfigureFlags</span><span class=o>=</span><span class=s2>&quot;--build=</span><span class=nv>$gnuArch</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-69 name=__codelineno-3-69 href=#__codelineno-3-69></a>#<span class=w> </span>https://salsa.debian.org/debian/jemalloc/-/blob/c0a88c37a551be7d12e4863435365c9a6a51525f/debian/rules#L8-23
<a id=__codelineno-3-70 name=__codelineno-3-70 href=#__codelineno-3-70></a><span class=w> </span><span class=nv>dpkgArch</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>dpkg<span class=w> </span>--print-architecture<span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-71 name=__codelineno-3-71 href=#__codelineno-3-71></a><span class=w> </span><span class=k>case</span><span class=w> </span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>dpkgArch</span><span class=p>##*-</span><span class=si>}</span><span class=s2>&quot;</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-72 name=__codelineno-3-72 href=#__codelineno-3-72></a><span class=w>  </span>amd64<span class=w> </span><span class=p>|</span><span class=w> </span>i386<span class=w> </span><span class=p>|</span><span class=w> </span>x32<span class=o>)</span><span class=w> </span><span class=nv>extraJemallocConfigureFlags</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$extraJemallocConfigureFlags</span><span class=s2> --with-lg-page=12&quot;</span><span class=w> </span><span class=p>;;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-73 name=__codelineno-3-73 href=#__codelineno-3-73></a><span class=w>  </span>*<span class=o>)</span><span class=w> </span><span class=nv>extraJemallocConfigureFlags</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$extraJemallocConfigureFlags</span><span class=s2> --with-lg-page=16&quot;</span><span class=w> </span><span class=p>;;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-74 name=__codelineno-3-74 href=#__codelineno-3-74></a><span class=w> </span><span class=k>esac</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-75 name=__codelineno-3-75 href=#__codelineno-3-75></a><span class=w> </span><span class=nv>extraJemallocConfigureFlags</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$extraJemallocConfigureFlags</span><span class=s2> --with-lg-hugepage=21&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-76 name=__codelineno-3-76 href=#__codelineno-3-76></a><span class=w> </span>grep<span class=w> </span>-F<span class=w> </span><span class=s1>&#39;cd jemalloc &amp;&amp; ./configure &#39;</span><span class=w> </span>/usr/src/redis/deps/Makefile<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-77 name=__codelineno-3-77 href=#__codelineno-3-77></a><span class=w> </span>sed<span class=w> </span>-ri<span class=w> </span><span class=s1>&#39;s!cd jemalloc &amp;&amp; ./configure !&amp;&#39;</span><span class=s2>&quot;</span><span class=nv>$extraJemallocConfigureFlags</span><span class=s2>&quot;</span><span class=s1>&#39; !&#39;</span><span class=w> </span>/usr/src/redis/deps/Makefile<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-78 name=__codelineno-3-78 href=#__codelineno-3-78></a><span class=w> </span>grep<span class=w> </span>-F<span class=w> </span><span class=s2>&quot;cd jemalloc &amp;&amp; ./configure </span><span class=nv>$extraJemallocConfigureFlags</span><span class=s2> &quot;</span><span class=w> </span>/usr/src/redis/deps/Makefile<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-79 name=__codelineno-3-79 href=#__codelineno-3-79></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-80 name=__codelineno-3-80 href=#__codelineno-3-80></a><span class=w> </span><span class=nb>export</span><span class=w> </span><span class=nv>BUILD_TLS</span><span class=o>=</span>yes<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-81 name=__codelineno-3-81 href=#__codelineno-3-81></a><span class=w> </span>make<span class=w> </span>-C<span class=w> </span>/usr/src/redis<span class=w> </span>-j<span class=w> </span><span class=s2>&quot;</span><span class=k>$(</span>nproc<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span>all<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-82 name=__codelineno-3-82 href=#__codelineno-3-82></a><span class=w> </span>make<span class=w> </span>-C<span class=w> </span>/usr/src/redis<span class=w> </span>install<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-83 name=__codelineno-3-83 href=#__codelineno-3-83></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-84 name=__codelineno-3-84 href=#__codelineno-3-84></a>#<span class=w> </span>TODO<span class=w> </span>https://github.com/redis/redis/pull/3494<span class=w> </span><span class=o>(</span>deduplicate<span class=w> </span><span class=s2>&quot;redis-server&quot;</span><span class=w> </span>copies<span class=o>)</span>
<a id=__codelineno-3-85 name=__codelineno-3-85 href=#__codelineno-3-85></a><span class=w> </span><span class=nv>serverMd5</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>md5sum<span class=w> </span>/usr/local/bin/redis-server<span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d<span class=s1>&#39; &#39;</span><span class=w> </span>-f1<span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=nb>export</span><span class=w> </span>serverMd5<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-86 name=__codelineno-3-86 href=#__codelineno-3-86></a><span class=w> </span>find<span class=w> </span>/usr/local/bin/redis*<span class=w> </span>-maxdepth<span class=w> </span><span class=m>0</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-87 name=__codelineno-3-87 href=#__codelineno-3-87></a><span class=w>  </span>-type<span class=w> </span>f<span class=w> </span>-not<span class=w> </span>-name<span class=w> </span>redis-server<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-88 name=__codelineno-3-88 href=#__codelineno-3-88></a><span class=w>  </span>-exec<span class=w> </span>sh<span class=w> </span>-eux<span class=w> </span>-c<span class=w> </span><span class=s1>&#39; \</span>
<a id=__codelineno-3-89 name=__codelineno-3-89 href=#__codelineno-3-89></a><span class=s1>   md5=&quot;$(md5sum &quot;$1&quot; | cut -d&quot; &quot; -f1)&quot;; \</span>
<a id=__codelineno-3-90 name=__codelineno-3-90 href=#__codelineno-3-90></a><span class=s1>   test &quot;$md5&quot; = &quot;$serverMd5&quot;; \</span>
<a id=__codelineno-3-91 name=__codelineno-3-91 href=#__codelineno-3-91></a><span class=s1>  &#39;</span><span class=w> </span>--<span class=w> </span><span class=s1>&#39;{}&#39;</span><span class=w> </span><span class=s1>&#39;;&#39;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-92 name=__codelineno-3-92 href=#__codelineno-3-92></a><span class=w>  </span>-exec<span class=w> </span>ln<span class=w> </span>-svfT<span class=w> </span><span class=s1>&#39;redis-server&#39;</span><span class=w> </span><span class=s1>&#39;{}&#39;</span><span class=w> </span><span class=s1>&#39;;&#39;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-93 name=__codelineno-3-93 href=#__codelineno-3-93></a><span class=w> </span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-94 name=__codelineno-3-94 href=#__codelineno-3-94></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-95 name=__codelineno-3-95 href=#__codelineno-3-95></a><span class=w> </span>rm<span class=w> </span>-r<span class=w> </span>/usr/src/redis<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-96 name=__codelineno-3-96 href=#__codelineno-3-96></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-97 name=__codelineno-3-97 href=#__codelineno-3-97></a><span class=w> </span>apt-mark<span class=w> </span>auto<span class=w> </span><span class=s1>&#39;.*&#39;</span><span class=w> </span>&gt;<span class=w> </span>/dev/null<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-98 name=__codelineno-3-98 href=#__codelineno-3-98></a><span class=w> </span><span class=o>[</span><span class=w> </span>-z<span class=w> </span><span class=s2>&quot;</span><span class=nv>$savedAptMark</span><span class=s2>&quot;</span><span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>apt-mark<span class=w> </span>manual<span class=w> </span><span class=nv>$savedAptMark</span><span class=w> </span>&gt;<span class=w> </span>/dev/null<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-99 name=__codelineno-3-99 href=#__codelineno-3-99></a><span class=w> </span>find<span class=w> </span>/usr/local<span class=w> </span>-type<span class=w> </span>f<span class=w> </span>-executable<span class=w> </span>-exec<span class=w> </span>ldd<span class=w> </span><span class=s1>&#39;{}&#39;</span><span class=w> </span><span class=s1>&#39;;&#39;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-100 name=__codelineno-3-100 href=#__codelineno-3-100></a><span class=w>  </span><span class=p>|</span><span class=w> </span>awk<span class=w> </span><span class=s1>&#39;/=&gt;/ { print $(NF-1) }&#39;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-101 name=__codelineno-3-101 href=#__codelineno-3-101></a><span class=w>  </span><span class=p>|</span><span class=w> </span>sort<span class=w> </span>-u<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-102 name=__codelineno-3-102 href=#__codelineno-3-102></a><span class=w>  </span><span class=p>|</span><span class=w> </span>xargs<span class=w> </span>-r<span class=w> </span>dpkg-query<span class=w> </span>--search<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-103 name=__codelineno-3-103 href=#__codelineno-3-103></a><span class=w>  </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d:<span class=w> </span>-f1<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-104 name=__codelineno-3-104 href=#__codelineno-3-104></a><span class=w>  </span><span class=p>|</span><span class=w> </span>sort<span class=w> </span>-u<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-105 name=__codelineno-3-105 href=#__codelineno-3-105></a><span class=w>  </span><span class=p>|</span><span class=w> </span>xargs<span class=w> </span>-r<span class=w> </span>apt-mark<span class=w> </span>manual<span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-106 name=__codelineno-3-106 href=#__codelineno-3-106></a><span class=w> </span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-107 name=__codelineno-3-107 href=#__codelineno-3-107></a><span class=w> </span>apt-get<span class=w> </span>purge<span class=w> </span>-y<span class=w> </span>--auto-remove<span class=w> </span>-o<span class=w> </span>APT::AutoRemove::RecommendsImportant<span class=o>=</span>false<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-108 name=__codelineno-3-108 href=#__codelineno-3-108></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-109 name=__codelineno-3-109 href=#__codelineno-3-109></a><span class=w> </span>redis-cli<span class=w> </span>--version<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-3-110 name=__codelineno-3-110 href=#__codelineno-3-110></a><span class=w> </span>redis-server<span class=w> </span>--version
<a id=__codelineno-3-111 name=__codelineno-3-111 href=#__codelineno-3-111></a>
<a id=__codelineno-3-112 name=__codelineno-3-112 href=#__codelineno-3-112></a><span class=k>RUN</span><span class=w> </span>mkdir<span class=w> </span>/data<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>chown<span class=w> </span>redis:redis<span class=w> </span>/data
<a id=__codelineno-3-113 name=__codelineno-3-113 href=#__codelineno-3-113></a><span class=k>VOLUME</span><span class=w> </span><span class=s>/data</span>
<a id=__codelineno-3-114 name=__codelineno-3-114 href=#__codelineno-3-114></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/data</span>
<a id=__codelineno-3-115 name=__codelineno-3-115 href=#__codelineno-3-115></a>
<a id=__codelineno-3-116 name=__codelineno-3-116 href=#__codelineno-3-116></a><span class=k>COPY</span><span class=w> </span>docker-entrypoint.sh<span class=w> </span>/usr/local/bin/
<a id=__codelineno-3-117 name=__codelineno-3-117 href=#__codelineno-3-117></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;docker-entrypoint.sh&quot;</span><span class=p>]</span>
<a id=__codelineno-3-118 name=__codelineno-3-118 href=#__codelineno-3-118></a>
<a id=__codelineno-3-119 name=__codelineno-3-119 href=#__codelineno-3-119></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>6379</span>
<a id=__codelineno-3-120 name=__codelineno-3-120 href=#__codelineno-3-120></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;redis-server&quot;</span><span class=p>]</span>
</code></pre></div></p> <p>运行此镜像并创建一个容器时，我们实际上在底层之上添加了一个新的可写层（容器层）。对正在运行的容器所做的所有更改（例如写入新文件、修改现有文件和删除文件）都将写入此可写容器层。</p> <p>可以看到上面的 Dockerfile 文件很庞大，通过这个文件我们来总结一些 在编写时需要注意的地方</p> <h3 id=23-热门dockerfile示例>2.3 热门Dockerfile示例<a class=headerlink href=#23-热门dockerfile示例 title="Permanent link">&para;</a></h3> <h4 id=nginx>Nginx<a class=headerlink href=#nginx title="Permanent link">&para;</a></h4> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>debian-nginx</label><label for=__tabbed_1_2>centos7-nginx</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>基于debian:jessie基础镜像</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>FROM</span><span class=w> </span><span class=s>debian:jessie</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=k>LABEL</span><span class=w> </span><span class=k>maintainer</span><span class=w> </span><span class=s>docker_user&lt;docker_user@email.com&gt;</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=k>ENV</span><span class=w> </span>NGINX_VERSION<span class=w> </span><span class=m>1</span>.10.1-1~jessie
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=k>RUN</span><span class=w> </span>apt-key<span class=w> </span>adv<span class=w> </span>--keyserver<span class=w> </span>hkp://pgp.mit.edu:80<span class=w> </span>--recv-keys<span class=w> </span>573BFD6B3D8FBC64107
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>    </span>9A6ABABF5BD827BD9BF62<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;deb http://nginx.org/packages/debian/ jessie nginx&quot;</span><span class=w> </span>&gt;&gt;<span class=w> </span>/etc/apt/sources.list<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>--no-install-recommends<span class=w> </span>--no-install-suggests<span class=w> </span>-y<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=w>        </span>ca-certificates<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=w>        </span><span class=nv>nginx</span><span class=o>=</span><span class=si>${</span><span class=nv>NGINX_VERSION</span><span class=si>}</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=w>        </span>nginx-module-xslt<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=w>        </span>nginx-module-geoip<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=w>        </span>nginx-module-image-filter<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=w>        </span>nginx-module-perl<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=w>        </span>nginx-module-njs<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=w>        </span>gettext-base<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=c># forward request and error logs to docker log collector</span>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=k>RUN</span><span class=w> </span>ln<span class=w> </span>-sf<span class=w> </span>/dev/stdout<span class=w> </span>/var/log/nginx/access.log<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>ln<span class=w> </span>-sf<span class=w> </span>/dev/stderr<span class=w> </span>/var/log/nginx/error.log
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>80 443</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;nginx&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;-g&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;daemon off;&quot;</span><span class=p>]</span>
</code></pre></div> <p>Nginx的官方仓库还提供了Dockerfile构建Nginx镜像，目前的版本是1.7.9，其内容为：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>FROM</span><span class=w> </span><span class=s>debian:wheezy</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=k>MAINTAINER</span><span class=w> </span><span class=s>NGINX Docker Maintainers &quot;docker-maint@nginx.com&quot;</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=k>RUN</span><span class=w> </span>apt-key<span class=w> </span>adv<span class=w> </span>--keyserver<span class=w> </span>pgp.mit.edu<span class=w> </span>--recv-keys<span class=w> </span>573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=k>RUN</span><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;deb http://nginx.org/packages/mainline/debian/ wheezy nginx&quot;</span><span class=w> </span>&gt;&gt;<span class=w> </span>/etc/apt/sources.list
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=k>ENV</span><span class=w> </span>NGINX_VERSION<span class=w> </span><span class=m>1</span>.7.9-1~wheezy
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span><span class=nv>nginx</span><span class=o>=</span><span class=si>${</span><span class=nv>NGINX_VERSION</span><span class=si>}</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=c># forward request and error logs to docker log collector</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=k>RUN</span><span class=w> </span>ln<span class=w> </span>-sf<span class=w> </span>/dev/stdout<span class=w> </span>/var/log/nginx/access.log
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=k>RUN</span><span class=w> </span>ln<span class=w> </span>-sf<span class=w> </span>/dev/stderr<span class=w> </span>/var/log/nginx/error.log
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=k>VOLUME</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/var/cache/nginx&quot;</span><span class=p>]</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>80 443</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;nginx&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;-g&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;daemon off;&quot;</span><span class=p>]</span>
</code></pre></div> </div> <div class=tabbed-block> <p>基于centos7镜像</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>FROM</span><span class=w> </span><span class=s>centos:7</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=k>MAINTAINER</span><span class=w> </span><span class=s>shichao@scajy.cn</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=k>RUN</span><span class=w> </span>yum<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>gcc<span class=w> </span>gcc-c++<span class=w> </span>make<span class=w> </span>pcre<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>                </span>pcre-devel<span class=w> </span>openssl<span class=w> </span>openssl-devel<span class=w>  </span><span class=se>\</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>                </span>pcre-davel<span class=w> </span>gd-devel<span class=w> </span>iproute<span class=w> </span>net-tools<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>                </span>telnet<span class=w> </span>wget<span class=w> </span>curl<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>                </span><span class=o>&amp;&amp;</span><span class=w> </span>yum<span class=w> </span>clean<span class=w> </span>all<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>                </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/cache/yum/*
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=k>RUN</span><span class=w> </span>useradd<span class=w> </span>-M<span class=w> </span>-s<span class=w> </span>/sbin/nologin<span class=w> </span>nginx
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=k>RUN</span><span class=w>  </span>wget<span class=w> </span>http://nginx.org/download/nginx-1.17.6.tar.gz<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>zxf<span class=w>  </span>nginx-1.17.6.tar.gz<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>    </span><span class=nb>cd</span><span class=w> </span>nginx-1.17.6<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>  </span>./configure<span class=w> </span>--prefix<span class=o>=</span>/usr/local/nginx<span class=w>  </span><span class=se>\</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>  </span>--with-http_stub_status_module<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>  </span>--with-http_ssl_module<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>  </span>--with-http_gzip_static_module<span class=w>  </span><span class=se>\</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>  </span>--with-http_flv_module<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=w>  </span>--with-http_mp4_module<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>  </span>--with-http_gunzip_module<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>  </span>make<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w> </span>install
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=k>ENV</span><span class=w> </span>PATH<span class=w> </span>/usr/local/nginx/sbin:<span class=nv>$PATH</span>
<a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>
<a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>80</span>
<a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a>
<a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;nginx&quot;</span><span class=p>]</span>
<a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a>
<a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;-g&quot;</span><span class=p>,</span><span class=s2>&quot;daemon off;&quot;</span><span class=p>]</span>
</code></pre></div> </div> </div> </div> <p>官方提供的Dockerfile 请到<code>https://github.com/docker-library/docs/tree/master/nginx</code> </p> <h4 id=python>Python<a class=headerlink href=#python title="Permanent link">&para;</a></h4> <div class="tabbed-set tabbed-alternate" data-tabs=2:4><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><input id=__tabbed_2_3 name=__tabbed_2 type=radio><input id=__tabbed_2_4 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>alpine</label><label for=__tabbed_2_2>Centos</label><label for=__tabbed_2_3>Ubuntu</label><label for=__tabbed_2_4>Debian</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>FROM</span><span class=w> </span><span class=s>python:3.9-alpine</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=k>MAINTAINER</span><span class=w> </span><span class=s>Logan &lt;admin@attacker.club&gt;</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/opt/app</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=k>COPY</span><span class=w> </span>requirements.txt<span class=w> </span>/opt/app
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=c>## 国内加速源</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=k>RUN</span><span class=w> </span>sed<span class=w> </span>-i<span class=w> </span><span class=s1>&#39;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#39;</span><span class=w> </span>/etc/apk/repositories<span class=w> </span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=c>## 工具包</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>--no-cache<span class=w> </span>add<span class=w> </span>curl<span class=w> </span>vim<span class=w> </span>busybox-extras
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=c>## ldap依赖</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>--no-cache<span class=w> </span>add<span class=w> </span>gcc<span class=w> </span><span class=se>\ </span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>libldap<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>libc-dev<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>openldap-dev<span class=w> </span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=c># python3-dev </span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=c>## Pillow图片库依赖</span>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>--no-cache<span class=w> </span>add<span class=w> </span>libjpeg<span class=w>  </span>jpeg-dev<span class=w> </span>musl-dev<span class=w> </span>zlib-dev<span class=w> </span>libffi-dev<span class=w> </span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=c># python3-dev </span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=k>RUN</span><span class=w> </span>pip<span class=w> </span>--no-cache-dir<span class=w> </span>install<span class=w> </span>-i<span class=w> </span>https://mirrors.aliyun.com/pypi/simple<span class=w> </span>-r<span class=w> </span>requirements.txt
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>/opt/app
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=c>## 清理数据</span>
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>del<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=w>        </span>gcc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=w>        </span>libc-dev<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=w>        </span>openldap-dev
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=c># RUN apk del libjpeg  jpeg-dev musl-dev zlib-dev libffi-dev </span>
<a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a><span class=k>RUN</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w>  </span>/tmp/*<span class=w> </span>/opt/app/env<span class=w> </span>/opt/app/db.sqlite3<span class=w> </span>/opt/app/logs/*<span class=w> </span>/root/.cache/pip<span class=w>  </span>/var/cache/apk/*
<a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>
<a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>8000</span>
<a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/bin/sh&quot;</span><span class=p>,</span><span class=s2>&quot;run.sh&quot;</span><span class=p>]</span>
<a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a>
<a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a><span class=c>## 构建镜像</span>
<a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a><span class=c># docker build -t lghost/python:3.9 . -f Dockerfile-alpine</span>
<a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a>
<a id=__codelineno-7-37 name=__codelineno-7-37 href=#__codelineno-7-37></a><span class=c>## 简洁启动</span>
<a id=__codelineno-7-38 name=__codelineno-7-38 href=#__codelineno-7-38></a><span class=c># docker run  -d -p8000:8000  --name cmdb  lghost/python:3.9</span>
<a id=__codelineno-7-39 name=__codelineno-7-39 href=#__codelineno-7-39></a>
<a id=__codelineno-7-40 name=__codelineno-7-40 href=#__codelineno-7-40></a><span class=c>## 初始化数据</span>
<a id=__codelineno-7-41 name=__codelineno-7-41 href=#__codelineno-7-41></a><span class=c># docker exec -it cmdb python init.py</span>
</code></pre></div> </div> <div class=tabbed-block> <p><code>python.Dockerfile-centos</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>FROM</span><span class=w> </span><span class=s>centos:7</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=k>RUN</span><span class=w> </span>rm<span class=w> </span>/etc/yum.repos.d/*<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-s<span class=w> </span>-o<span class=w> </span>./Centos-7.repo<span class=w> </span>https://mirrors.aliyun.com/repo/Centos-7.repo<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-s<span class=w> </span>-o<span class=w> </span>./epel.repo<span class=w> </span>https://mirrors.aliyun.com/repo/epel-7.repo<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>sed<span class=w> </span>-i<span class=w> </span>-e<span class=w> </span><span class=s1>&#39;/mirrors.cloud.aliyuncs.com/d&#39;</span><span class=w> </span>-e<span class=w> </span><span class=s1>&#39;/mirrors.aliyuncs.com/d&#39;</span><span class=w> </span>Centos-7.repo<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>yum<span class=w> </span>install<span class=w>  </span>-y<span class=w> </span>wget<span class=w> </span>openssl-devel<span class=w> </span>bzip2-devel<span class=w> </span>expat-devel<span class=w> </span>gdbm-devel<span class=w> </span>readline-devel<span class=w> </span>sqlite-devel<span class=w> </span>python-devel<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>libffi-devel<span class=w>  </span>tk-devel
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=k>RUN</span><span class=w> </span>wget<span class=w> </span>-c<span class=w> </span>https://www.python.org/ftp/python/3.9.16/Python-3.9.16.tar.xz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>xf<span class=w> </span>Python*.xz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>Python-3.9.16<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>./configure<span class=w> </span><span class=nv>prefix</span><span class=o>=</span>/usr/local/python3<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w>  </span>-j<span class=w> </span><span class=m>2</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w>  </span>altinstall<span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>ln<span class=w> </span>-s<span class=w> </span>/usr/local/python3/bin/python3.9<span class=w> </span>/usr/bin/python3
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=c>#  docker build -t lghost/python:3.9 . -f Dockerfile-alpine</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>FROM</span><span class=w> </span><span class=s>centos:7</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=k>LABEL</span><span class=w> </span><span class=nv>auther</span><span class=o>=</span><span class=s2>&quot;hjl@oschina.com&quot;</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=k>ENV</span><span class=w> </span>container<span class=w> </span>docker
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=k>RUN</span><span class=w> </span>yum<span class=w> </span>-y<span class=w> </span>swap<span class=w> </span>--<span class=w> </span>remove<span class=w> </span>fakesystemd<span class=w> </span>--<span class=w> </span>install<span class=w> </span>systemd<span class=w> </span>systemd-libs
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=k>RUN</span><span class=w> </span>yum<span class=w> </span>-y<span class=w> </span>update<span class=p>;</span><span class=w> </span>yum<span class=w> </span>clean<span class=w> </span>all<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>  </span><span class=o>(</span><span class=nb>cd</span><span class=w> </span>/lib/systemd/system/sysinit.target.wants/<span class=p>;</span><span class=w> </span><span class=k>for</span><span class=w> </span>i<span class=w> </span><span class=k>in</span><span class=w> </span>*<span class=p>;</span><span class=w> </span><span class=k>do</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=nv>$i</span><span class=w> </span><span class=o>==</span>systemd-tmpfiles-setup.service<span class=w> </span><span class=o>]</span><span class=w> </span><span class=o>||</span><span class=w> </span>rm<span class=w> </span>-f<span class=w> </span><span class=nv>$i</span><span class=p>;</span><span class=w> </span><span class=k>done</span><span class=o>)</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>  </span>rm<span class=w> </span>-f<span class=w> </span>/lib/systemd/system/multi-user.target.wants/*<span class=p>;</span><span class=se>\</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>  </span>rm<span class=w> </span>-f<span class=w> </span>/etc/systemd/system/*.wants/*<span class=p>;</span><span class=se>\</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=w>  </span>rm<span class=w> </span>-f<span class=w> </span>/lib/systemd/system/local-fs.target.wants/*<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=w>  </span>rm<span class=w> </span>-f<span class=w> </span>/lib/systemd/system/sockets.target.wants/*udev*<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=w>  </span>rm<span class=w> </span>-f<span class=w> </span>/lib/systemd/system/sockets.target.wants/*initctl*<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=w>  </span>rm<span class=w> </span>-f<span class=w> </span>/lib/systemd/system/basic.target.wants/*<span class=p>;</span><span class=se>\</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=w>  </span>rm<span class=w> </span>-f<span class=w> </span>/lib/systemd/system/anaconda.target.wants/*<span class=p>;</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=k>VOLUME</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&quot;/sys/fs/cgroup&quot;</span><span class=w> </span><span class=p>]</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/usr/sbin/init&quot;</span><span class=p>]</span>
</code></pre></div> <p>官方提供的Dockerfile 请到<code>https://github.com/docker-library/docs/tree/master/centos</code></p> </div> <div class=tabbed-block> <p>官方提供的Dockerfile 请到<code>https://github.com/docker-library/docs/tree/master/ubuntu</code> 查看。</p> <p><code>python.Dockerfile-ubuntu</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:22.04</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=k>MAINTAINER</span><span class=w> </span><span class=s>Logan &lt;admin@attacker.club&gt;</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/opt</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=c>## 依赖包</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=k>RUN</span><span class=w>  </span>sed<span class=w> </span>-i<span class=w> </span>s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g<span class=w> </span>/etc/apt/sources.list<span class=w>  </span><span class=se>\</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt<span class=w> </span>install<span class=w> </span>nload<span class=w> </span>iftop<span class=w> </span>net-tools<span class=w> </span>curl<span class=w> </span>git<span class=w> </span>-y<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt<span class=w> </span>install<span class=w> </span>python3<span class=w> </span>python3-pip<span class=w> </span>-y
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=c>## 清理数据</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=k>RUN</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*<span class=w>  </span><span class=se>\</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=o>&amp;&amp;</span><span class=w> </span>apt<span class=w>  </span>clean<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=o>&amp;&amp;</span><span class=w> </span>apt<span class=w> </span>autoclean<span class=w> </span>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>8000</span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=c># docker build -t lghost/python3 . -f Dockerfile-ubuntu-python3</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=k>FROM</span><span class=w> </span><span class=s>python:3.9.13-slim</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=k>ENV</span><span class=w> </span>PYTHONUNBUFFERED<span class=w> </span><span class=m>1</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=c># RUN sed -i &#39;s/deb.debian.org/mirrors.aliyun.com/g&#39; /etc/apt/sources.list # 国内源</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/opt/app</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w>  </span>net-tools<span class=w> </span>apt-utils<span class=w> </span><span class=se>\</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>  </span>libtiff5-dev<span class=w> </span>libjpeg8-dev<span class=w> </span>zlib1g-dev
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=k>COPY</span><span class=w> </span>requirements.txt<span class=w> </span>/opt/app
</code></pre></div> </div> </div> </div> <h4 id=django>Django<a class=headerlink href=#django title="Permanent link">&para;</a></h4> <p><code>dockerfile-django</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>FROM</span><span class=w> </span><span class=s>python:3.4</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span><span class=se>\</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>        </span>postgresql-client<span class=w> </span><span class=se>\</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/usr/src/app</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=k>COPY</span><span class=w> </span>requirements.txt<span class=w> </span>./
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=k>RUN</span><span class=w> </span>pip<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>requirements.txt
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>.
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>8000</span>
<a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;python&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;manage.py&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;runserver&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;0.0.0.0:8000&quot;</span><span class=p>]</span>
<a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=c># docker build -t python-django:3.4.</span>
</code></pre></div> <p><code>django_python.dockerfile</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>FROM</span><span class=w> </span><span class=s>python:3.8-alpine</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/home</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>/home
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=k>RUN</span><span class=w> </span>pip<span class=w> </span>install<span class=w> </span>-i<span class=w> </span>http://mirrors.aliyun.com/pypi/simple<span class=w> </span>--trusted-host<span class=w> </span>mirrors.aliyun.com<span class=w> </span>-r<span class=w> </span>requirements.txt
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=k>RUN</span><span class=w>  </span>rm<span class=w> </span>-rf<span class=w> </span>/home/venv<span class=w> </span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=c># RUN  python manage.py makemigrations  &amp;&amp;  python manage.py migrate</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=c># CMD [ &quot;python&quot;, &quot;./manage.py&quot;, &quot;runserver&quot;, &quot;0.0.0.0:8000&quot;]</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=k>RUN</span><span class=w> </span>chmod<span class=w> </span>+x<span class=w> </span>run.sh
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>8000</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/bin/sh&quot;</span><span class=p>,</span><span class=s2>&quot;run.sh&quot;</span><span class=p>]</span><span class=w>  </span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=c># 容器启动时默认执行的命令</span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=c># docker build -t lghost/bind9:latest . # build images</span>
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=c># docker push lghost/bind9:latest # 推送到dockerhub</span>
</code></pre></div> <p><code>run.sh</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=ch>#!/bin/bash</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=c1>###</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>db_init<span class=o>()</span><span class=w> </span><span class=o>{</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>pip3<span class=w>  </span>install<span class=w> </span>-i<span class=w> </span>http://mirrors.aliyun.com/pypi/simple<span class=w>  </span>--trusted-host<span class=w> </span>mirrors.aliyun.com<span class=w>  </span>-r<span class=w> </span>requirements.txt
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>python<span class=w> </span>manage.py<span class=w> </span>makemigrations
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>python<span class=w> </span>manage.py<span class=w> </span>migrate
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=c1># 初始化数据</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>python<span class=w> </span>init.py
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=c1># 第一次初始化密码</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=o>}</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=c1># shellcheck disable=SC2120</span>
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a>replace_settings<span class=o>()</span><span class=w> </span><span class=o>{</span>
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=nv>$1</span>x<span class=w> </span><span class=o>==</span><span class=w> </span><span class=s2>&quot;debug&quot;</span>x<span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=w>  </span>sed<span class=w> </span>-i<span class=w>  </span><span class=s1>&#39;s/DEBUG = False/DEBUG = True/&#39;</span>g<span class=w>  </span>website/settings.py
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;Enable Debug ......&quot;</span>
<a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=k>else</span>
<a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=w>  </span>sed<span class=w> </span>-i<span class=w>  </span><span class=s1>&#39;s/DEBUG = True/DEBUG = False/&#39;</span>g<span class=w>  </span>website/settings.py
<a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;Disable Debug ......&quot;</span>
<a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=w>  </span><span class=c1># 关闭调试模式</span>
<a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=k>fi</span>
<a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a>
<a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a><span class=o>}</span>
<a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a>
<a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a>run_server<span class=o>()</span><span class=w> </span><span class=o>{</span>
<a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a>db_init
<a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a>replace_settings
<a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a>python<span class=w> </span>manage.py<span class=w> </span>runserver<span class=w> </span><span class=m>0</span>.0.0.0:8000
<a id=__codelineno-14-30 name=__codelineno-14-30 href=#__codelineno-14-30></a><span class=o>}</span>
<a id=__codelineno-14-31 name=__codelineno-14-31 href=#__codelineno-14-31></a>
<a id=__codelineno-14-32 name=__codelineno-14-32 href=#__codelineno-14-32></a>run_server<span class=w> </span><span class=c1># 启动服务</span>
</code></pre></div> <h4 id=flask>Flask<a class=headerlink href=#flask title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=c># 使用官方 Python 3 镜像作为基础镜像</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=k>FROM</span><span class=w> </span><span class=s>python:3</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=c># 设置工作目录</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/app</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=c># 复制项目的依赖文件到容器中</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=k>COPY</span><span class=w> </span>requirements.txt<span class=w> </span>/app/requirements.txt
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=c># 安装项目的依赖项</span>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=k>RUN</span><span class=w> </span>pip<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>requirements.txt
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=c># 将项目文件复制到容器中</span>
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>/app
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a><span class=c># 暴露容器的端口</span>
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>5000</span>
<a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>
<a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a><span class=c># 在容器中运行 Flask 应用程序</span>
<a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;python&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;app.py&quot;</span><span class=p>]</span>
</code></pre></div> <h4 id=golang>Golang<a class=headerlink href=#golang title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=k>FROM</span><span class=w> </span><span class=s>golang:alpine</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s>builder</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=c># Set necessary environmet variables needed for our image</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=k>ENV</span><span class=w> </span><span class=nv>GO111MODULE</span><span class=o>=</span>on<span class=w> </span><span class=se>\</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>    </span><span class=nv>GOPROXY</span><span class=o>=</span>https://goproxy.cn,direct<span class=w> </span><span class=se>\</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=w>    </span><span class=nv>CGO_ENABLED</span><span class=o>=</span><span class=m>0</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>    </span><span class=nv>GOOS</span><span class=o>=</span>linux<span class=w> </span><span class=se>\</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=w>    </span><span class=nv>GOARCH</span><span class=o>=</span>amd64
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=c># Move to working directory /build</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/build</span>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=c># Copy and download dependency using go mod</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=k>COPY</span><span class=w> </span>go.mod<span class=w> </span>.
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=k>COPY</span><span class=w> </span>go.sum<span class=w> </span>.
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>mod<span class=w> </span>download
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=c># Copy the code into the container</span>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>.
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=c># Run test</span>
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=c>#RUN go test ./...</span>
<a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>
<a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=c># Build the application</span>
<a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>build<span class=w> </span>-o<span class=w> </span>main<span class=w> </span>.
<a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>
<a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=c># Move to /dist directory as the place for resulting binary folder</span>
<a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/dist</span>
<a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>
<a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=c># Copy binary from build to main folder</span>
<a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=k>RUN</span><span class=w> </span>cp<span class=w> </span>/build/main<span class=w> </span>.
<a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a>
<a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a><span class=c>############################</span>
<a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a><span class=c># STEP 2 build a small image</span>
<a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a><span class=c>############################</span>
<a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a><span class=k>FROM</span><span class=w> </span><span class=s>scratch</span>
<a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>builder<span class=w> </span>/dist/main<span class=w> </span>/
<a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a><span class=k>COPY</span><span class=w> </span>./env/demo.env<span class=w> </span>/env/demo.env
<a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a><span class=k>COPY</span><span class=w> </span>./logs<span class=w> </span>/logs
<a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a>
<a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a><span class=c># Command to run the executable</span>
<a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/main&quot;</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=c># start from golang base image</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=k>FROM</span><span class=w> </span><span class=s>golang:1.16-alpine</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s>builder</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/usr/src/app</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=k>COPY</span><span class=w> </span>go.mod<span class=w> </span>go.sum<span class=w> </span>./
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=c># RUN echo &quot;nameserver 114.114.114.114&quot; &gt;&gt; /etc/resolv.conf</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=k>RUN</span><span class=w> </span>sed<span class=w> </span>-i<span class=w> </span><span class=s1>&#39;s/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g&#39;</span><span class=w> </span>/etc/apk/repositories
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>add<span class=w> </span>--no-cache<span class=w> </span>git
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=k>ENV</span><span class=w> </span><span class=nv>GO111MODULE</span><span class=o>=</span>on<span class=w> </span><span class=se>\</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=w>    </span><span class=nv>GOPROXY</span><span class=o>=</span>https://goproxy.cn<span class=w> </span><span class=se>\</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=w>    </span><span class=nv>GOSUMDB</span><span class=o>=</span>off<span class=w> </span><span class=se>\</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=w>    </span><span class=nv>GIN_MODE</span><span class=o>=</span>release
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>mod<span class=w> </span>download<span class=w> </span>-x
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>mod<span class=w> </span>tidy
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>.
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>build<span class=w> </span>-v<span class=w> </span>-o<span class=w> </span>/usr/local/bin<span class=w> </span>./...
<a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/usr/src/tool</span>
<a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=k>RUN</span><span class=w> </span>git<span class=w> </span>clone<span class=w> </span>https://gitee.com/edmondfrank/tern.git
<a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/usr/src/tool/tern</span>
<a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>mod<span class=w> </span>download<span class=w> </span>-x
<a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>mod<span class=w> </span>tidy
<a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>build<span class=w> </span>-v<span class=w> </span>-o<span class=w> </span>/usr/local/bin<span class=w> </span>./...
<a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a>
<a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a>
<a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a><span class=k>FROM</span><span class=w> </span><span class=s>alpine</span>
<a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a><span class=k>RUN</span><span class=w> </span>sed<span class=w> </span>-i<span class=w> </span><span class=s1>&#39;s/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g&#39;</span><span class=w> </span>/etc/apk/repositories
<a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>add<span class=w> </span>--no-cache<span class=w> </span>ca-certificates<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>update-ca-certificates
<a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>builder<span class=w> </span>/usr/local/bin/forudad<span class=w> </span>/usr/bin/forudad
<a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a><span class=k>COPY</span><span class=w> </span>./cmd/migrations<span class=w> </span>/usr/migrations
<a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>builder<span class=w> </span>/usr/local/bin/tern<span class=w> </span>/usr/bin/tern
<a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a><span class=k>COPY</span><span class=w> </span>./examples/config/postgre-example.toml<span class=w> </span>/usr/bin/config.toml
<a id=__codelineno-17-32 name=__codelineno-17-32 href=#__codelineno-17-32></a><span class=k>COPY</span><span class=w> </span>./migration.sh<span class=w> </span>.
<a id=__codelineno-17-33 name=__codelineno-17-33 href=#__codelineno-17-33></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>4200 4200</span>
<a id=__codelineno-17-34 name=__codelineno-17-34 href=#__codelineno-17-34></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;./migration.sh&quot;</span><span class=p>]</span>
<a id=__codelineno-17-35 name=__codelineno-17-35 href=#__codelineno-17-35></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/usr/bin/forudad&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;-config&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;/usr/bin/config.toml&quot;</span><span class=p>]</span>
</code></pre></div> <ul> <li>demo</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c># 构建：使用golang:1.13版本</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=k>FROM</span><span class=w> </span><span class=s>golang:1.18</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s>build</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=c># 容器环境变量添加，会覆盖默认的变量值</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=k>ENV</span><span class=w> </span><span class=nv>GO111MODULE</span><span class=o>=</span>on
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=k>ENV</span><span class=w> </span><span class=nv>GOPROXY</span><span class=o>=</span>https://goproxy.cn,direct
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=c># 设置工作区</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/go/release</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=c># 把全部文件添加到/go/release目录</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>.
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=c># # 执行go mod download</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>mod<span class=w> </span>download
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a>
<a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=c># 编译：把cmd/main.go编译成可执行的二进制文件，命名为app</span>
<a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=k>RUN</span><span class=w> </span><span class=nv>GOOS</span><span class=o>=</span>linux<span class=w> </span><span class=nv>CGO_ENABLED</span><span class=o>=</span><span class=m>0</span><span class=w> </span><span class=nv>GOARCH</span><span class=o>=</span>amd64<span class=w> </span>go<span class=w> </span>build<span class=w> </span>-ldflags<span class=o>=</span><span class=s2>&quot;-s -w&quot;</span><span class=w> </span>-installsuffix<span class=w> </span>cgo<span class=w> </span>-o<span class=w> </span>app<span class=w> </span>main.go
<a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>
<a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=c># 运行：使用alpine作为基础镜像</span>
<a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a><span class=k>FROM</span><span class=w> </span><span class=s>alpine</span>
<a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a><span class=k>RUN</span><span class=w> </span>sed<span class=w> </span>-i<span class=w> </span><span class=s1>&#39;s/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g&#39;</span><span class=w> </span>/etc/apk/repositories
<a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>add<span class=w> </span>--no-cache<span class=w> </span>ca-certificates<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>update-ca-certificates
<a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a>
<a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a><span class=c># 在build阶段复制时区到</span>
<a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/usr/share/zoneinfo/Asia/Shanghai<span class=w> </span>/etc/localtime
<a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a><span class=c># 在build阶段复制可执行的go二进制文件app</span>
<a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/go/release/app<span class=w> </span>/
<a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a><span class=c># 在build阶段复制配置文件</span>
<a id=__codelineno-18-30 name=__codelineno-18-30 href=#__codelineno-18-30></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/go/release/config<span class=w> </span>./config
<a id=__codelineno-18-31 name=__codelineno-18-31 href=#__codelineno-18-31></a>
<a id=__codelineno-18-32 name=__codelineno-18-32 href=#__codelineno-18-32></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>9090 9091</span>
<a id=__codelineno-18-33 name=__codelineno-18-33 href=#__codelineno-18-33></a>
<a id=__codelineno-18-34 name=__codelineno-18-34 href=#__codelineno-18-34></a><span class=c># 启动服务</span>
<a id=__codelineno-18-35 name=__codelineno-18-35 href=#__codelineno-18-35></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/app&quot;</span><span class=p>]</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>参考文献</p> <p><a href=https://www.cnblogs.com/yance-dev/p/16499553.html>Golang/Python应用部署到Docker</a></p> </div> <h4 id=nodejs>Node.js<a class=headerlink href=#nodejs title="Permanent link">&para;</a></h4> <p>官方提供的Dockerfile 请到<code>https://github.com/docker-library/docs/tree/master/node</code> 查看。</p> <p>下面是一个生产级别的 Vue.js 项目的 Dockerfile 示例：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c># 使用 Node.js 官方提供的 LTS 版本作为基础镜像</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=k>FROM</span><span class=w> </span><span class=s>node:lts-alpine</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s>build-stage</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=c># 设置工作目录</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/app</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=c># 复制 package.json 和 package-lock.json 到工作目录</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=k>COPY</span><span class=w> </span>package*.json<span class=w> </span>./
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=c># 安装项目依赖</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=k>RUN</span><span class=w> </span>npm<span class=w> </span>install
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=c># 复制项目源代码到工作目录</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>.
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=c># 构建项目</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=k>RUN</span><span class=w> </span>npm<span class=w> </span>run<span class=w> </span>build
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a>
<a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=c># 使用 Nginx 镜像作为生产环境镜像</span>
<a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=k>FROM</span><span class=w> </span><span class=s>nginx:stable-alpine</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s>production-stage</span>
<a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a><span class=c># 从构建阶段复制构建结果到 Nginx 服务器目录</span>
<a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build-stage<span class=w> </span>/app/dist<span class=w> </span>/usr/share/nginx/html
<a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a><span class=c># 暴露 80 端口</span>
<a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>80</span>
<a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a><span class=c># 启动 Nginx</span>
<a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;nginx&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;-g&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;daemon off;&quot;</span><span class=p>]</span>
</code></pre></div> <ul> <li>demo</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c># server image</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=k>FROM</span><span class=w> </span><span class=s>nginx:latest</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s>base</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>8080</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=c># builder image</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=k>FROM</span><span class=w> </span><span class=s>node:16-alpine3.15</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s>builder</span>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/usr/src/app</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a>
<a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=k>RUN</span><span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>/usr/src/transport/http/admin
<a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a>
<a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=k>RUN</span><span class=w> </span>npm<span class=w> </span>i<span class=w> </span>-g<span class=w> </span>pnpm@6.32.3
<a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a>
<a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a><span class=k>COPY</span><span class=w> </span><span class=o>[</span><span class=s2>&quot;package*.json&quot;</span>,<span class=w> </span><span class=s2>&quot;./&quot;</span><span class=o>]</span>
<a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a>
<a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a><span class=c># install project dependencies</span>
<a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a><span class=k>RUN</span><span class=w> </span>pnpm<span class=w> </span>i
<a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a>
<a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>.
<a id=__codelineno-20-23 name=__codelineno-20-23 href=#__codelineno-20-23></a>
<a id=__codelineno-20-24 name=__codelineno-20-24 href=#__codelineno-20-24></a><span class=k>RUN</span><span class=w> </span>sed<span class=w> </span>-i<span class=w> </span><span class=s1>&#39;s/http:\/\/localhost:4200/https:\/\/foruda.runjs.cn/g&#39;</span><span class=w> </span>./.env.build
<a id=__codelineno-20-25 name=__codelineno-20-25 href=#__codelineno-20-25></a>
<a id=__codelineno-20-26 name=__codelineno-20-26 href=#__codelineno-20-26></a><span class=c># build app for production with minification</span>
<a id=__codelineno-20-27 name=__codelineno-20-27 href=#__codelineno-20-27></a><span class=k>RUN</span><span class=w> </span>pnpm<span class=w> </span>run<span class=w> </span>build
<a id=__codelineno-20-28 name=__codelineno-20-28 href=#__codelineno-20-28></a>
<a id=__codelineno-20-29 name=__codelineno-20-29 href=#__codelineno-20-29></a><span class=k>FROM</span><span class=w> </span><span class=s>base</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s>final</span>
<a id=__codelineno-20-30 name=__codelineno-20-30 href=#__codelineno-20-30></a>
<a id=__codelineno-20-31 name=__codelineno-20-31 href=#__codelineno-20-31></a><span class=k>COPY</span><span class=w> </span>./nginx/nginx.conf<span class=w> </span>/etc/nginx/conf.d/default.conf
<a id=__codelineno-20-32 name=__codelineno-20-32 href=#__codelineno-20-32></a>
<a id=__codelineno-20-33 name=__codelineno-20-33 href=#__codelineno-20-33></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>builder<span class=w> </span>/usr/src/transport/http/admin<span class=w> </span>/var/www/html/
</code></pre></div> <h4 id=redis>Redis<a class=headerlink href=#redis title="Permanent link">&para;</a></h4> <p>通过Dockerfile也可以构建和官方一样的Redis镜像。这里以2.8版本为例，其Dockerfile为：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=k>FROM</span><span class=w> </span><span class=s>debian:wheezy</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=c># add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=k>RUN</span><span class=w> </span>groupadd<span class=w> </span>-r<span class=w> </span>redis<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>useradd<span class=w> </span>-r<span class=w> </span>-g<span class=w> </span>redis<span class=w> </span>redis
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>curl<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=c># grab gosu for easy step-down from root</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=k>RUN</span><span class=w> </span>gpg<span class=w> </span>--keyserver<span class=w> </span>pool.sks-keyservers.net<span class=w> </span>--recv-keys<span class=w> </span>B42F6819007F00F88E364FD4036A9C25BF357DD4
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=k>RUN</span><span class=w> </span>curl<span class=w> </span>-o<span class=w> </span>/usr/local/bin/gosu<span class=w> </span>-SL<span class=w> </span><span class=s2>&quot;https://github.com/tianon/gosu/releases/download/1.2/gosu-</span><span class=k>$(</span>dpkg<span class=w> </span>--print-architecture<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-o<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span>-SL<span class=s2>&quot;https://github.com/tianon/gosu/releases/download/1.2/gosu-</span><span class=k>$(</span>dpkg<span class=w> </span>--print-architecture<span class=k>)</span><span class=s2>.asc&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>gpg<span class=w> </span>--verify<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>chmod<span class=w> </span>+x<span class=w> </span>/usr/local/bin/gosu
<a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a><span class=k>ENV</span><span class=w> </span>REDIS_VERSION<span class=w> </span><span class=m>2</span>.8.19
<a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a><span class=k>ENV</span><span class=w> </span>REDIS_DOWNLOAD_URL<span class=w> </span>http://download.redis.io/releases/redis-2.8.19.tar.gz
<a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a><span class=k>ENV</span><span class=w> </span>REDIS_DOWNLOAD_SHA1<span class=w> </span>3e362f4770ac2fdbdce58a5aa951c1967e0facc8
<a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a><span class=c># for redis-sentinel see: http://redis.io/topics/sentinel</span>
<a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a><span class=k>RUN</span><span class=w> </span><span class=nv>buildDeps</span><span class=o>=</span><span class=s1>&#39;gcc libc6-dev make&#39;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a><span class=w>  </span><span class=nb>set</span><span class=w> </span>-x<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span><span class=nv>$buildDeps</span><span class=w> </span>--no-install-recommends<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>/usr/src/redis<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-sSL<span class=w> </span><span class=s2>&quot;</span><span class=nv>$REDIS_DOWNLOAD_URL</span><span class=s2>&quot;</span><span class=w> </span>-o<span class=w> </span>redis.tar.gz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;</span><span class=nv>$REDIS_DOWNLOAD_SHA1</span><span class=s2> *redis.tar.gz&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>sha1sum<span class=w> </span>-c<span class=w> </span>-<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-26 name=__codelineno-21-26 href=#__codelineno-21-26></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>-xzf<span class=w> </span>redis.tar.gz<span class=w> </span>-C<span class=w> </span>/usr/src/redis<span class=w> </span>--strip-components<span class=o>=</span><span class=m>1</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-27 name=__codelineno-21-27 href=#__codelineno-21-27></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>redis.tar.gz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-28 name=__codelineno-21-28 href=#__codelineno-21-28></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w> </span>-C<span class=w> </span>/usr/src/redis<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-29 name=__codelineno-21-29 href=#__codelineno-21-29></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w> </span>-C<span class=w> </span>/usr/src/redis<span class=w> </span>install<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-30 name=__codelineno-21-30 href=#__codelineno-21-30></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-r<span class=w> </span>/usr/src/redis<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-31 name=__codelineno-21-31 href=#__codelineno-21-31></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>purge<span class=w> </span>-y<span class=w> </span>--auto-remove<span class=w> </span><span class=nv>$buildDeps</span>
<a id=__codelineno-21-32 name=__codelineno-21-32 href=#__codelineno-21-32></a><span class=k>RUN</span><span class=w> </span>mkdir<span class=w> </span>/data<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>chown<span class=w> </span>redis:redis<span class=w> </span>/data
<a id=__codelineno-21-33 name=__codelineno-21-33 href=#__codelineno-21-33></a><span class=k>VOLUME</span><span class=w> </span><span class=s>/data</span>
<a id=__codelineno-21-34 name=__codelineno-21-34 href=#__codelineno-21-34></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/data</span>
<a id=__codelineno-21-35 name=__codelineno-21-35 href=#__codelineno-21-35></a><span class=k>COPY</span><span class=w> </span>docker-entrypoint.sh<span class=w> </span>/entrypoint.sh
<a id=__codelineno-21-36 name=__codelineno-21-36 href=#__codelineno-21-36></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/entrypoint.sh&quot;</span><span class=p>]</span>
<a id=__codelineno-21-37 name=__codelineno-21-37 href=#__codelineno-21-37></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>6379</span>
<a id=__codelineno-21-38 name=__codelineno-21-38 href=#__codelineno-21-38></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&quot;redis-server&quot;</span><span class=w> </span><span class=p>]</span>
</code></pre></div> <p>官方提供的Dockerfile 请到<code>https://github.com/docker-library/docs/tree/master/redis</code> 查看。</p> <h4 id=mysql>MySQL<a class=headerlink href=#mysql title="Permanent link">&para;</a></h4> <p>通过Dockerfile来创建mysql <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=k>FROM</span><span class=w> </span><span class=s>debian:wheezy</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=c># add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added</span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=k>RUN</span><span class=w> </span>groupadd<span class=w> </span>-r<span class=w> </span>mysql<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>useradd<span class=w> </span>-r<span class=w> </span>-g<span class=w> </span>mysql<span class=w> </span>mysql
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=c># FATAL ERROR: please install the following Perl modules before executing /usr/local/mysql/scripts/mysql_install_db:</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=c># File::Basename</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=c># File::Copy</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=c># Sys::Hostname</span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=c># Data::Dumper</span>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>perl<span class=w> </span>--no-install-recommends<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=c># gpg: key 5072E1F5: public key &quot;MySQL Release Engineering &lt;mysql-build@oss.oracle.com&gt;&quot; imported</span>
<a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=k>RUN</span><span class=w> </span>apt-key<span class=w> </span>adv<span class=w> </span>--keyserver<span class=w> </span>pool.sks-keyservers.net<span class=w> </span>--recv-keys<span class=w> </span>A4A9406876FCBD3C456770C88C718D3B5072E1F5
<a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a><span class=k>ENV</span><span class=w> </span>MYSQL_MAJOR<span class=w> </span><span class=m>5</span>.7
<a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a><span class=k>ENV</span><span class=w> </span>MYSQL_VERSION<span class=w> </span><span class=m>5</span>.7.5-m15
<a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a><span class=k>RUN</span><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;deb http://repo.mysql.com/apt/debian/ wheezy mysql-</span><span class=si>${</span><span class=nv>MYSQL_MAJOR</span><span class=si>}</span><span class=s2>-dmr&quot;</span><span class=w> </span>&gt;<span class=w> </span>/etc/apt/sources.list.d/mysql.list
<a id=__codelineno-22-15 name=__codelineno-22-15 href=#__codelineno-22-15></a><span class=c># the &quot;/var/lib/mysql&quot; stuff here is because the mysql-server postinst doesn&#39;t have an explicit way</span>
<a id=__codelineno-22-16 name=__codelineno-22-16 href=#__codelineno-22-16></a><span class=c># to disable the mysql_install_db codepath besides having a database already &quot;configured&quot; (ie, stuff in /var/lib/mysql/mysql)</span>
<a id=__codelineno-22-17 name=__codelineno-22-17 href=#__codelineno-22-17></a><span class=c># also, we set debconf keys to make APT a little quieter</span>
<a id=__codelineno-22-18 name=__codelineno-22-18 href=#__codelineno-22-18></a><span class=k>RUN</span><span class=w> </span><span class=o>{</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-19 name=__codelineno-22-19 href=#__codelineno-22-19></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span>mysql-community-server<span class=w> </span>mysql-community-server/data-dir<span class=w> </span><span class=k>select</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-20 name=__codelineno-22-20 href=#__codelineno-22-20></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span>mysql-community-server<span class=w> </span>mysql-community-server/root-pass<span class=w> </span>password<span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-21 name=__codelineno-22-21 href=#__codelineno-22-21></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span>mysql-community-server<span class=w> </span>mysql-community-server/re-root-pass<span class=w> </span>password<span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-22 name=__codelineno-22-22 href=#__codelineno-22-22></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span>mysql-community-server<span class=w> </span>mysql-community-server/remove-test-db<span class=w> </span><span class=k>select</span><span class=w> </span>false<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-23 name=__codelineno-22-23 href=#__codelineno-22-23></a><span class=w>  </span><span class=o>}</span><span class=w> </span><span class=p>|</span><span class=w> </span>debconf-set-selections<span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-24 name=__codelineno-22-24 href=#__codelineno-22-24></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>mysql-server<span class=o>=</span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>MYSQL_VERSION</span><span class=si>}</span><span class=s2>&quot;</span>*<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*<span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-25 name=__codelineno-22-25 href=#__codelineno-22-25></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/mysql<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>/var/lib/mysql
<a id=__codelineno-22-26 name=__codelineno-22-26 href=#__codelineno-22-26></a><span class=c># comment out a few problematic configuration values</span>
<a id=__codelineno-22-27 name=__codelineno-22-27 href=#__codelineno-22-27></a><span class=k>RUN</span><span class=w> </span>sed<span class=w> </span>-Ei<span class=w> </span><span class=s1>&#39;s/^(bind-address|log)/#&amp;/&#39;</span><span class=w> </span>/etc/mysql/my.cnf
<a id=__codelineno-22-28 name=__codelineno-22-28 href=#__codelineno-22-28></a><span class=k>VOLUME</span><span class=w> </span><span class=s>/var/lib/mysql</span>
<a id=__codelineno-22-29 name=__codelineno-22-29 href=#__codelineno-22-29></a><span class=k>COPY</span><span class=w> </span>docker-entrypoint.sh<span class=w> </span>/entrypoint.sh
<a id=__codelineno-22-30 name=__codelineno-22-30 href=#__codelineno-22-30></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/entrypoint.sh&quot;</span><span class=p>]</span>
<a id=__codelineno-22-31 name=__codelineno-22-31 href=#__codelineno-22-31></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>3306</span>
<a id=__codelineno-22-32 name=__codelineno-22-32 href=#__codelineno-22-32></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;mysqld&quot;</span><span class=p>]</span>
</code></pre></div></p> <p>官方提供的Dockerfile 请到<code>https://github.com/docker-library/docs/tree/master/mysql</code> 查看</p> <h4 id=mongodb>Mongodb<a class=headerlink href=#mongodb title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=k>FROM</span><span class=w> </span><span class=s>debian:wheezy</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=k>RUN</span><span class=w> </span>groupadd<span class=w> </span>-r<span class=w> </span>mongodb<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>useradd<span class=w> </span>-r<span class=w> </span>-g<span class=w> </span>mongodb<span class=w> </span>mongodb
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>curl<span class=w> </span>numactl<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=c># grab gosu for easy step-down from root</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=k>RUN</span><span class=w> </span>gpg<span class=w> </span>--keyserver<span class=w> </span>pool.sks-keyservers.net<span class=w> </span>--recv-keys<span class=w> </span>B42F6819007F00F88E364FD4036A9C25BF357DD4
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=k>RUN</span><span class=w> </span>curl<span class=w> </span>-o<span class=w> </span>/usr/local/bin/gosu<span class=w> </span>-SL<span class=w> </span><span class=s2>&quot;https://github.com/tianon/gosu/releases/download/1.2/gosu-</span><span class=k>$(</span>dpkg--print-architecture<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-o<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span>-SL<span class=w> </span><span class=s2>&quot;https://github.com/tianon/gosu/releases/download/1.2/gosu-</span><span class=k>$(</span>dpkg<span class=w> </span>--print-architecture<span class=k>)</span><span class=s2>.asc&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>gpg<span class=w> </span>--verify<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>chmod<span class=w> </span>+x<span class=w> </span>/usr/local/bin/gosu
<a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a><span class=k>ENV</span><span class=w> </span>MONGO_RELEASE_FINGERPRINT<span class=w> </span>BDC0DB28022D7DEA1490DC3E7085801C857FD301
<a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a><span class=k>RUN</span><span class=w> </span>gpg<span class=w> </span>--keyserver<span class=w> </span>pool.sks-keyservers.net<span class=w> </span>--recv-keys<span class=w> </span><span class=nv>$MONGO_RELEASE_FINGERPRINT</span>
<a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a><span class=k>ENV</span><span class=w> </span>MONGO_VERSION<span class=w> </span><span class=m>3</span>.0.0-rc6
<a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a><span class=k>RUN</span><span class=w> </span>curl<span class=w> </span>-SL<span class=w> </span><span class=s2>&quot;https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-</span><span class=nv>$MONGO_VERSION</span><span class=s2>.tgz&quot;</span><span class=w> </span>-o<span class=w> </span>mongo.tgz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-SL<span class=w> </span><span class=s2>&quot;https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-</span><span class=nv>$MONGO_VERSION</span><span class=s2>.tgz.sig&quot;</span><span class=w> </span>–o<span class=w> </span>mongo.tgz.sig<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>gpg<span class=w> </span>--verify<span class=w> </span>mongo.tgz.sig<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-20 name=__codelineno-23-20 href=#__codelineno-23-20></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>-xvf<span class=w> </span>mongo.tgz<span class=w> </span>-C<span class=w> </span>/usr/local<span class=w> </span>--strip-components<span class=o>=</span><span class=m>1</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-21 name=__codelineno-23-21 href=#__codelineno-23-21></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>mongo.tgz*
<a id=__codelineno-23-22 name=__codelineno-23-22 href=#__codelineno-23-22></a><span class=k>VOLUME</span><span class=w> </span><span class=s>/data/db</span>
<a id=__codelineno-23-23 name=__codelineno-23-23 href=#__codelineno-23-23></a><span class=k>COPY</span><span class=w> </span>docker-entrypoint.sh<span class=w> </span>/entrypoint.sh
<a id=__codelineno-23-24 name=__codelineno-23-24 href=#__codelineno-23-24></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/entrypoint.sh&quot;</span><span class=p>]</span>
<a id=__codelineno-23-25 name=__codelineno-23-25 href=#__codelineno-23-25></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>27017</span>
<a id=__codelineno-23-26 name=__codelineno-23-26 href=#__codelineno-23-26></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;mongod&quot;</span><span class=p>]</span>
</code></pre></div> <p>官方提供的Dockerfile 请到 <code>https://github.com/docker-library/docs/tree/master/mongo</code> 查看。</p> <h4 id=postgres>Postgres<a class=headerlink href=#postgres title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=k>FROM</span><span class=w> </span><span class=s>debian:wheezy</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=c># add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=k>RUN</span><span class=w> </span>groupadd<span class=w> </span>-r<span class=w> </span>postgres<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>useradd<span class=w> </span>-r<span class=w> </span>-g<span class=w> </span>postgres<span class=w> </span>postgres
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=c># grab gosu for easy step-down from root</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=k>RUN</span><span class=w> </span>gpg<span class=w> </span>--keyserver<span class=w> </span>pool.sks-keyservers.net<span class=w> </span>--recv-keys<span class=w> </span>B42F6819007F00F88E364FD4036A9C25BF357DD4
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>curl<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*<span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-o<span class=w> </span>/usr/local/bin/gosu<span class=w> </span>–SL<span class=w> </span><span class=s2>&quot;https://github.com/tianon/gosu/releases/download/1.2/gosu-</span><span class=k>$(</span>dpkg<span class=w> </span>--print-architecture<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-o<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span>-SL<span class=w> </span><span class=s2>&quot;https://github.com/tianon/gosu/releases/download/1.2/gosu-</span><span class=k>$(</span>dpkg<span class=w> </span>--print-architecture<span class=k>)</span><span class=s2>.asc&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>gpg<span class=w> </span>--verify<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>/usr/local/bin/gosu.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>chmod<span class=w> </span>+x<span class=w> </span>/usr/local/bin/gosu<span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>purge<span class=w> </span>-y<span class=w> </span>--auto-remove<span class=w> </span>curl
<a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=c># make the &quot;en_US.UTF-8&quot; locale so postgres will be utf-8 enabled by default</span>
<a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>locales<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*<span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>localedef<span class=w> </span>-i<span class=w> </span>en_US<span class=w> </span>-c<span class=w> </span>-f<span class=w> </span>UTF-8<span class=w> </span>-A<span class=w> </span>/usr/share/locale/locale.alias<span class=w> </span>en_US.UTF-8
<a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=k>ENV</span><span class=w> </span>LANG<span class=w> </span>en_US.utf8
<a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a><span class=k>RUN</span><span class=w> </span>mkdir<span class=w> </span>/docker-entrypoint-initdb.d
<a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a><span class=k>RUN</span><span class=w> </span>apt-key<span class=w> </span>adv<span class=w> </span>--keyserver<span class=w> </span>pool.sks-keyservers.net<span class=w> </span>--recv-keys<span class=w> </span>B97B0AFCAA1A47F044F244A07FCC7D46ACCC4CF8
<a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a><span class=k>ENV</span><span class=w> </span>PG_MAJOR<span class=w> </span><span class=m>9</span>.4
<a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a><span class=k>ENV</span><span class=w> </span>PG_VERSION<span class=w> </span><span class=m>9</span>.4.0-1.pgdg70+1
<a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a><span class=k>RUN</span><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s1>&#39;deb http://apt.postgresql.org/pub/repos/apt/ wheezy-pgdg main&#39;</span><span class=w> </span><span class=nv>$PG_MAJOR</span><span class=w> </span>&gt;<span class=w> </span>/etc/apt/sources.list.d/pgdg.list
<a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-23 name=__codelineno-24-23 href=#__codelineno-24-23></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>postgresql-common<span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-24 name=__codelineno-24-24 href=#__codelineno-24-24></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>sed<span class=w> </span>-ri<span class=w> </span><span class=s1>&#39;s/#(create_main_cluster) .*$/\1 = false/&#39;</span><span class=w> </span>/etc/postgresql-common/createcluster.conf<span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-25 name=__codelineno-24-25 href=#__codelineno-24-25></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-26 name=__codelineno-24-26 href=#__codelineno-24-26></a><span class=w>  </span>postgresql-<span class=nv>$PG_MAJOR</span><span class=o>=</span><span class=nv>$PG_VERSION</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-27 name=__codelineno-24-27 href=#__codelineno-24-27></a><span class=w>  </span>postgresql-contrib-<span class=nv>$PG_MAJOR</span><span class=o>=</span><span class=nv>$PG_VERSION</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-24-28 name=__codelineno-24-28 href=#__codelineno-24-28></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-24-29 name=__codelineno-24-29 href=#__codelineno-24-29></a><span class=k>RUN</span><span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>/var/run/postgresql<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>chown<span class=w> </span>-R<span class=w> </span>postgres<span class=w> </span>/var/run/postgresql
<a id=__codelineno-24-30 name=__codelineno-24-30 href=#__codelineno-24-30></a><span class=k>ENV</span><span class=w> </span>PATH<span class=w> </span>/usr/lib/postgresql/<span class=nv>$PG_MAJOR</span>/bin:<span class=nv>$PATH</span>
<a id=__codelineno-24-31 name=__codelineno-24-31 href=#__codelineno-24-31></a><span class=k>ENV</span><span class=w> </span>PGDATA<span class=w> </span>/var/lib/postgresql/data
<a id=__codelineno-24-32 name=__codelineno-24-32 href=#__codelineno-24-32></a><span class=k>VOLUME</span><span class=w> </span><span class=s>/var/lib/postgresql/data</span>
<a id=__codelineno-24-33 name=__codelineno-24-33 href=#__codelineno-24-33></a><span class=k>COPY</span><span class=w> </span>docker-entrypoint.sh<span class=w> </span>/
<a id=__codelineno-24-34 name=__codelineno-24-34 href=#__codelineno-24-34></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/docker-entrypoint.sh&quot;</span><span class=p>]</span>
<a id=__codelineno-24-35 name=__codelineno-24-35 href=#__codelineno-24-35></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>5432</span>
<a id=__codelineno-24-36 name=__codelineno-24-36 href=#__codelineno-24-36></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;postgres&quot;</span><span class=p>]</span>
</code></pre></div> <h4 id=httpd>httpd<a class=headerlink href=#httpd title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=k>FROM</span><span class=w> </span><span class=s>debian:jessie</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=c># add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=c>#RUN groupadd -r www-data &amp;&amp; useradd -r --create-home -g www-data www-data</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=k>ENV</span><span class=w> </span>HTTPD_PREFIX<span class=w> </span>/usr/local/apache2
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=k>ENV</span><span class=w> </span>PATH<span class=w> </span><span class=nv>$PATH</span>:<span class=nv>$HTTPD_PREFIX</span>/bin
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=k>RUN</span><span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span><span class=s2>&quot;</span><span class=nv>$HTTPD_PREFIX</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>chown<span class=w> </span>www-data:www-data<span class=w> </span><span class=s2>&quot;</span><span class=nv>$HTTPD_PREFIX</span><span class=s2>&quot;</span>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>$HTTPD_PREFIX</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=c># install httpd runtime dependencies</span>
<a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a><span class=c># https://httpd.apache.org/docs/2.4/install.html#requirements</span>
<a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=w>  </span>libapr1<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=w>  </span>libaprutil1<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a><span class=w>  </span>libpcre++0<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=w>  </span>libssl1.0.0<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-r<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a><span class=c># see https://httpd.apache.org/download.cgi#verify</span>
<a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a><span class=k>RUN</span><span class=w> </span>gpg<span class=w> </span>--keyserver<span class=w> </span>pool.sks-keyservers.net<span class=w> </span>--recv-keys<span class=w> </span>A93D62ECC3C8EA12DB220EC934EA76E6791485A8
<a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a><span class=k>ENV</span><span class=w> </span>HTTPD_VERSION<span class=w> </span><span class=m>2</span>.4.12
<a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a><span class=k>ENV</span><span class=w> </span>HTTPD_BZ2_URL<span class=w> </span>https://www.apache.org/dist/httpd/httpd-<span class=nv>$HTTPD_VERSION</span>.tar.bz2
<a id=__codelineno-25-22 name=__codelineno-25-22 href=#__codelineno-25-22></a><span class=k>RUN</span><span class=w> </span><span class=nv>buildDeps</span><span class=o>=</span><span class=s1>&#39; \</span>
<a id=__codelineno-25-23 name=__codelineno-25-23 href=#__codelineno-25-23></a><span class=s1>  ca-certificates \</span>
<a id=__codelineno-25-24 name=__codelineno-25-24 href=#__codelineno-25-24></a><span class=s1>  curl \</span>
<a id=__codelineno-25-25 name=__codelineno-25-25 href=#__codelineno-25-25></a><span class=s1>  bzip2 \</span>
<a id=__codelineno-25-26 name=__codelineno-25-26 href=#__codelineno-25-26></a><span class=s1>  gcc \</span>
<a id=__codelineno-25-27 name=__codelineno-25-27 href=#__codelineno-25-27></a><span class=s1>  libapr1-dev \</span>
<a id=__codelineno-25-28 name=__codelineno-25-28 href=#__codelineno-25-28></a><span class=s1>  libaprutil1-dev \</span>
<a id=__codelineno-25-29 name=__codelineno-25-29 href=#__codelineno-25-29></a><span class=s1>  libc6-dev \</span>
<a id=__codelineno-25-30 name=__codelineno-25-30 href=#__codelineno-25-30></a><span class=s1>  libpcre++-dev \</span>
<a id=__codelineno-25-31 name=__codelineno-25-31 href=#__codelineno-25-31></a><span class=s1>  libssl-dev \</span>
<a id=__codelineno-25-32 name=__codelineno-25-32 href=#__codelineno-25-32></a><span class=s1>  make \</span>
<a id=__codelineno-25-33 name=__codelineno-25-33 href=#__codelineno-25-33></a><span class=s1>  &#39;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-34 name=__codelineno-25-34 href=#__codelineno-25-34></a><span class=w>  </span><span class=nb>set</span><span class=w> </span>-x<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-35 name=__codelineno-25-35 href=#__codelineno-25-35></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-36 name=__codelineno-25-36 href=#__codelineno-25-36></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span><span class=nv>$buildDeps</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-37 name=__codelineno-25-37 href=#__codelineno-25-37></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-r<span class=w> </span>/var/lib/apt/lists/*<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-38 name=__codelineno-25-38 href=#__codelineno-25-38></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-SL<span class=w> </span><span class=s2>&quot;</span><span class=nv>$HTTPD_BZ2_URL</span><span class=s2>&quot;</span><span class=w> </span>-o<span class=w> </span>httpd.tar.bz2<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-39 name=__codelineno-25-39 href=#__codelineno-25-39></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-SL<span class=w> </span><span class=s2>&quot;</span><span class=nv>$HTTPD_BZ2_URL</span><span class=s2>.asc&quot;</span><span class=w> </span>-o<span class=w> </span>httpd.tar.bz2.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-40 name=__codelineno-25-40 href=#__codelineno-25-40></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>gpg<span class=w> </span>--verify<span class=w> </span>httpd.tar.bz2.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-41 name=__codelineno-25-41 href=#__codelineno-25-41></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>src/httpd<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-42 name=__codelineno-25-42 href=#__codelineno-25-42></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>-xvf<span class=w> </span>httpd.tar.bz2<span class=w> </span>-C<span class=w> </span>src/httpd<span class=w> </span>--strip-components<span class=o>=</span><span class=m>1</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-43 name=__codelineno-25-43 href=#__codelineno-25-43></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>httpd.tar.bz2*<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-44 name=__codelineno-25-44 href=#__codelineno-25-44></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>src/httpd<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-45 name=__codelineno-25-45 href=#__codelineno-25-45></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>./configure<span class=w> </span>--enable-so<span class=w> </span>--enable-ssl<span class=w> </span>--prefix<span class=o>=</span><span class=nv>$HTTPD_PREFIX</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-46 name=__codelineno-25-46 href=#__codelineno-25-46></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w> </span>-j<span class=s2>&quot;</span><span class=k>$(</span>nproc<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-47 name=__codelineno-25-47 href=#__codelineno-25-47></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w> </span>install<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-48 name=__codelineno-25-48 href=#__codelineno-25-48></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>../../<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-49 name=__codelineno-25-49 href=#__codelineno-25-49></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-r<span class=w> </span>src/httpd<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-50 name=__codelineno-25-50 href=#__codelineno-25-50></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>sed<span class=w> </span>-ri<span class=w> </span><span class=s1>&#39; \</span>
<a id=__codelineno-25-51 name=__codelineno-25-51 href=#__codelineno-25-51></a><span class=s1>  s!^(\s*CustomLog)\s+\S+!\1 /proc/self/fd/1!g; \</span>
<a id=__codelineno-25-52 name=__codelineno-25-52 href=#__codelineno-25-52></a><span class=s1>  s!^(\s*ErrorLog)\s+\S+!\1 /proc/self/fd/2!g; \</span>
<a id=__codelineno-25-53 name=__codelineno-25-53 href=#__codelineno-25-53></a><span class=s1>  &#39;</span><span class=w> </span>/usr/local/apache2/conf/httpd.conf<span class=w> </span><span class=se>\</span>
<a id=__codelineno-25-54 name=__codelineno-25-54 href=#__codelineno-25-54></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>purge<span class=w> </span>-y<span class=w> </span>--auto-remove<span class=w> </span><span class=nv>$buildDeps</span>
<a id=__codelineno-25-55 name=__codelineno-25-55 href=#__codelineno-25-55></a><span class=k>COPY</span><span class=w> </span>httpd-foreground<span class=w> </span>/usr/local/bin/
<a id=__codelineno-25-56 name=__codelineno-25-56 href=#__codelineno-25-56></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>80</span>
<a id=__codelineno-25-57 name=__codelineno-25-57 href=#__codelineno-25-57></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;httpd-foreground&quot;</span><span class=p>]</span>
</code></pre></div> <h4 id=java>Java<a class=headerlink href=#java title="Permanent link">&para;</a></h4> <p>使用多阶段构建的Dockerfile示例，用于构建Java应用程序</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=c># 第一阶段：构建应用程序</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=k>FROM</span><span class=w> </span><span class=s>maven:3.8.4-openjdk-11</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s>builder</span>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=c># 将项目代码复制到容器中</span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>/app
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=c># 设置工作目录</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/app</span>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=c># 构建应用程序</span>
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=k>RUN</span><span class=w> </span>mvn<span class=w> </span>clean<span class=w> </span>package
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>
<a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=c># 第二阶段：运行应用程序</span>
<a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=k>FROM</span><span class=w> </span><span class=s>openjdk:11</span>
<a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=c># 将构建好的应用程序复制到容器中</span>
<a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>builder<span class=w> </span>/app/target/my-java-app.jar<span class=w> </span>/app/my-java-app.jar
<a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=c># 在容器中运行 Java 应用程序</span>
<a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;java&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;-jar&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;/app/my-java-app.jar&quot;</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=c1># 要构建此多阶段构建的镜像，请在包含 Dockerfile 的目录下运行以下命令：</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>docker<span class=w> </span>build<span class=w> </span>-t<span class=w> </span>my-java-app<span class=w> </span>.
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=c1># 使用以下命令来运行该镜像：</span>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>docker<span class=w> </span>run<span class=w> </span>-d<span class=w> </span>my-java-app
</code></pre></div> <h2 id=3dockerfile编写优化>3.Dockerfile编写优化<a class=headerlink href=#3dockerfile编写优化 title="Permanent link">&para;</a></h2> <h3 id=31-使用小的基础镜像>3.1 使用小的基础镜像<a class=headerlink href=#31-使用小的基础镜像 title="Permanent link">&para;</a></h3> <p>Docker的基础镜像选择</p> <p>我们在使用Docker hub挑选Docker的基础镜像的时候，发现了很多版本，包括Alpine、Slim、Stretch、Buster、Jessie、Bullseye。</p> <h4 id=应用已安装环境的镜像>应用已安装环境的镜像<a class=headerlink href=#应用已安装环境的镜像 title="Permanent link">&para;</a></h4> <p>我将使用python和node作为例子，因为这些是我最常用的docker镜像，这也同样适用于任何镜像。</p> <p>根据DockerHub，这是事实上的标准镜像，如果你不确定，你应该使用它。</p> <ul> <li> <p>python:3.8.3</p> </li> <li> <p>node:14.1.1</p> </li> </ul> <p>这些镜像基于最新的稳定Debian操作系统发行版。 </p> <p><strong>当我试图让一个项目快速启动和运行时，我通常会从其中的一个开始，我并不关心最终镜像的大小。完整镜像是最安全的选择</strong></p> <h4 id=busterstretchjessie>buster/stretch/jessie<a class=headerlink href=#busterstretchjessie title="Permanent link">&para;</a></h4> <ul> <li> <p>buster:Debian 10</p> </li> <li> <p>stretch:Debian 9</p> </li> <li> <p>jessie:Debian 8</p> </li> </ul> <p>带有stretch、buster或jessie标签的镜像是不同Debian发行版的代号。</p> <p>正在开发的未来版本是“bullseye ”和“bookworm”，但还不稳定。</p> <p>你可能会在DockerHub上的镜像版本列表中看到这些标签。</p> <p>如果您的代码与Debian操作系统的特定版本兼容，请选择其中一个镜像。</p> <p>在开始一个新项目时，你很少需要使用旧版本的Debian。</p> <h4 id=slim>slim<a class=headerlink href=#slim title="Permanent link">&para;</a></h4> <p>slim的镜像是完整镜像的配对版本。</p> <p>这个镜像通常只安装运行特定工具所需的最小包。</p> <p>以python为例，就是运行python的最小包，node.js同理。</p> <p>通过省去较少使用的工具，镜像会更小。如果有空间限制且不需要完整版本，请使用此镜像。</p> <p>**但是，在使用这个镜像时，一定要进行彻底的测试！**如果您遇到无法解释的错误，请尝试切换到完整的镜像，看看是否能够解决问题。</p> <h4 id=alpine>alpine<a class=headerlink href=#alpine title="Permanent link">&para;</a></h4> <p>这些是最受欢迎的镜像变体，因为它们的尺寸很小。</p> <p>然而，一些团队正在弃用alpine镜像，因为这些镜像可能会导致难以调试的兼容性问题。具体来说，如果使用python镜像，一些 wheels将被构建成与Debian兼容，并且需要重新编译，才能与基于apline的镜像一起工作。</p> <p>使用alpine镜像的主要原因是使你得到的镜像尽可能小。基础镜像将小于5MB。</p> <p>python基础镜像(将python添加到基础alpine镜像)目前是78.9MB。这仍然很小。</p> <p><strong>如果考虑到空间问题，强烈推荐使用此镜像。</strong></p> <p>它的缺点是不包含一些你可能会需要的包。</p> <p>主要是，它使用了一个更小的musl lib代替glibc。如果您的应用程序有特定的libc需求，您可能会遇到问题。</p> <p>如果你发现Alpine镜像缺少你需要的东西，你可以直接在Dockerfile中安装它，这样能确保镜像只包含你需要的内容。需要注意，如果您正在安装外部包，您的Dockerfile将会更改。</p> <p>主要的区别是，您将使用apk而不是apt-get来安装包。</p> <p>对alpine镜像的使用有很多担心之处，所以你需要充分了解它。</p> <p>需要充分阅读文档并研究。 同样，如果您在构建Dockerfile时遇到了无法解释的问题，请尝试切换到完整的镜像，看看是否能解决问题。</p> <h4 id=选择镜像>选择镜像<a class=headerlink href=#选择镜像 title="Permanent link">&para;</a></h4> <p>以下是我使用的通用准则：</p> <ul> <li> <p>如果我需要快速启动并运行项目，没有空间限制，并且没有时间进行太多测试，那么我就使用实际的标准镜像。 我最关心的是镜像有我需要的所有东西，镜像大小并不关心。</p> </li> <li> <p>如果空间是一个问题，并且我知道我只需要最小的包来运行特定的语言，如python，我会选择slim</p> </li> <li> <p>对于一些我有时间彻底测试的项目，并且有极端的空间限制，我将使用alpine镜像。但是要注意，这可能会导致更长的构建时间和不确定的bug。 如果您在将docker容器移植到新环境时遇到了困难，或者在添加新包时出现了故障，这可能是因为Alpine镜像。</p> </li> <li> <p>最后，滚动到特定镜像的DockerHub页面底部，阅读有关选择镜像的建议。</p> </li> </ul> <h4 id=关于版本的说明>关于版本的说明<a class=headerlink href=#关于版本的说明 title="Permanent link">&para;</a></h4> <p>不要在生产系统 Dockerfile 中使用 <code>&lt;image&gt;:latest</code>。</p> <p>这样做将总是获取最新的镜像，并且应用程序的依赖项可能与未来的版本不兼容。</p> <p>当开始一个新项目时，我通常会从最近标记的版本开始，进行彻底的测试，然后根据需要升级，在投入生产之前进行彻底的测试。</p> <p>在上面的 Dockerfile中基础镜像使用有FROM debian:bullseye-slim, FROM scratch</p> <ul> <li> <p>scratch 是一个空镜像，一般用不到，在构建最基础的镜像的时候会用到。</p> </li> <li> <p>debian:bullseye-slim 是一个 debian 系统的 bullseye 版本的精简版镜像。看的出来，使用的镜像很小。</p> </li> </ul> <p>使用较小的镜像可以更快地构建、推送和拉取 镜像。往往更安全，因为只包含运行应用程序所需的必要库和系统依赖项。</p> <p>尤其是在 CI/CD 等流水线中，庞大的 基础镜像 在每个环节都要消耗一些时间，从而使流水线的时间变得很长。</p> <p>镜像之间的区别主要在于底层的操作系统</p> <p>镜像选择类型</p> <ul> <li> <p><code>Official Image</code>：官方镜像，或者叫标准镜像，一般由官方维护的镜像，它是正确的选择，但是可能不是最优的。镜像基于最新的稳定 Debian 操作系统发行版，上面的 有 Dockerfile 构建完成的镜像即为 redis:7 的一个官网镜像。</p> </li> <li> <p><code>Debian(bullseye/buster/stretch/jessie)</code>：不同的 Debian Linux 发行版镜像，jessie(8.0)，stretch(9.0) 是比较老旧的版本,buster(10.0) ,bullseye(11.0)为较新的版本</p> </li> <li> <p><code>slim</code>：精简版，它通常会安装运行特定工具所需的最小包</p> </li> <li> <p><code>alpine</code>：基于 Alpine Linux项目，专门为在容器内部使用而构建的操作系统。相比较 Debian 来说 Alpine 很小很小，但是需要考虑一些时区，兼容性问题。</p> </li> </ul> <div class="admonition info"> <p class=admonition-title>参考文献</p> <p><a href=https://blog.frognew.com/2021/07/relearning-container-25.html>编写Dockerfile的一些实践经验</a></p> </div> <ul> <li><code>scratch</code>: 一个明确的空镜像，特别是用于建立 "从头开始" 的镜像。</li> </ul> <p>在选择最小基础镜像的同时，要尽量避免安装不必要的软件包</p> <h3 id=32-指令链式运行>3.2 指令链式运行<a class=headerlink href=#32-指令链式运行 title="Permanent link">&para;</a></h3> <p>可以很明显的发现，上面 Dockerfile 中的 RUN 指令很长</p> <p>这是由于每个指令都会创建一个可缓存单元并构建一个新的中间镜像层。</p> <p>所以可以通过链接所有命令来避免过多层级。</p> <p>此外，尽量避免链接过多的可缓存 RUN 命令，因为这会导致创建大型缓存并最终导致缓存突发。</p> <p>将所有的RUN指令合并为一个</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>/app
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\ </span><span class=w> </span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>nodejs<span class=w> </span><span class=se>\</span>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>/app<span class=w> </span><span class=se>\</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>npm<span class=w> </span>install
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=k>CMD</span><span class=w> </span>npm<span class=w> </span>start
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-eux<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=w> </span><span class=nv>savedAptMark</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>apt-mark<span class=w> </span>showmanual<span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=w> </span>apt-get<span class=w> </span>update<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=w>  </span>ca-certificates<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=w>  </span>wget<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=w>  </span><span class=se>\</span>
<a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=w>  </span>dpkg-dev<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a><span class=w>  </span>gcc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=w>  </span>libc6-dev<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a><span class=w>  </span>libssl-dev<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a><span class=w>  </span>make<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a><span class=w> </span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a><span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a><span class=w> </span>wget<span class=w> </span>-O<span class=w> </span>redis.tar.gz<span class=w> </span><span class=s2>&quot;</span><span class=nv>$REDIS_DOWNLOAD_URL</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a><span class=w>  </span>..................
</code></pre></div> <h3 id=33-变动的指令放到最后>3.3 变动的指令放到最后<a class=headerlink href=#33-变动的指令放到最后 title="Permanent link">&para;</a></h3> <p>在 RUN 之后放置 COPY 在某些情况下，您对代码进行了细微的更改，并且需要反复从 dockerfile 构建镜像。</p> <p>在这种情况下，将 COPY 命令放在 RUN 命令之后将有助于减小镜像大小，因为在这种情况下 docker 将能够更好地使用缓存功能。</p> <p>它将为安装了依赖项的镜像创建缓存，每次更改代码时，docker 都会使用该缓存并创建镜像。它还将减少 docker 构建时间。</p> <p>所以 <code>始终将最常更改的指令放在末尾</code>。会提高构建速度.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=k>FROM</span><span class=w> </span><span class=s>python:3.9-slim</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/app</span>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=k>COPY</span><span class=w> </span>requirements.txt<span class=w> </span>.
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=k>RUN</span><span class=w> </span>pip<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>/requirements.txt
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=k>COPY</span><span class=w> </span>app.py<span class=w> </span>.
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:latest</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=k>RUN</span><span class=w> </span>apt<span class=w> </span>update<span class=w> </span>-y<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>apt<span class=w> </span>install<span class=w> </span>unzip<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a>apt<span class=w> </span>install<span class=w> </span>curl<span class=w> </span>--no-install-recommends<span class=w> </span>-y<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>apt<span class=w> </span>install<span class=w> </span>python3<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=k>COPY</span><span class=w> </span>file<span class=w> </span>/home/ubuntu
</code></pre></div> <h3 id=34-首选数组而不是字符串语法>3.4 首选数组而不是字符串语法<a class=headerlink href=#34-首选数组而不是字符串语法 title="Permanent link">&para;</a></h3> <h4 id=cmd>CMD<a class=headerlink href=#cmd title="Permanent link">&para;</a></h4> <p>类似于 RUN 指令，用于运行程序，但二者运行的时间点不同:</p> <ul> <li>CMD 在docker run 时运行。</li> <li>RUN 是在 docker build。</li> </ul> <p>作用：为启动的容器指定默认要运行的程序，程序运行结束，容器也就结束。<strong>CMD 指令指定的程序可被 docker run 命令行参数中指定要运行的程序所覆盖</strong>。</p> <p>注意：如果 Dockerfile 中如果存在多个 CMD 指令，仅最后一个</p> <p>格式</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>CMD<span class=w> </span>&lt;shell<span class=w> </span>命令&gt;<span class=w> </span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>CMD<span class=w> </span><span class=o>[</span><span class=s2>&quot;&lt;可执行文件或命令&gt;&quot;</span>,<span class=s2>&quot;&lt;param1&gt;&quot;</span>,<span class=s2>&quot;&lt;param2&gt;&quot;</span>,...<span class=o>]</span><span class=w> </span>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>CMD<span class=w> </span><span class=o>[</span><span class=s2>&quot;&lt;param1&gt;&quot;</span>,<span class=s2>&quot;&lt;param2&gt;&quot;</span>,...<span class=o>]</span><span class=w>  </span><span class=c1># 该写法是为 ENTRYPOINT 指令指定的程序提供默认参数</span>
</code></pre></div> 推荐使用第二种格式，执行过程比较明确。第一种格式实际上在运行的过程中也会自动转换成第二种格式运行，并且默认可执行文件是 sh。</p> <h4 id=entrypoint>ENTRYPOINT<a class=headerlink href=#entrypoint title="Permanent link">&para;</a></h4> <p>类似于 CMD 指令，但其不会被 docker run 的命令行参数指定的指令所覆盖，而且这些命令行参数会被当作参数送给 ENTRYPOINT 指令指定的程序。</p> <p>但是, 如果运行 docker run 时使用了 --entrypoint 选项，将覆盖 ENTRYPOINT 指令指定的程序。</p> <ul> <li> <p>优点：在执行 docker run 的时候可以指定 ENTRYPOINT 运行所需的参数。</p> </li> <li> <p>注意：如果 Dockerfile 中如果存在多个 ENTRYPOINT 指令，仅最后一个生效。</p> </li> </ul> <p>格式</p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>ENTRYPOINT<span class=w> </span><span class=o>[</span><span class=s2>&quot;&lt;executeable&gt;&quot;</span>,<span class=s2>&quot;&lt;param1&gt;&quot;</span>,<span class=s2>&quot;&lt;param2&gt;&quot;</span>,...<span class=o>]</span>
</code></pre></div> <p>可以搭配 CMD 命令使用：一般是变参才会使用 CMD ，这里的 CMD 等于是在给 ENTRYPOINT 传参，以下示例会提到。</p> <p>示例：</p> <p>假设已通过 Dockerfile 构建了 nginx:test 镜像：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=k>FROM</span><span class=w> </span><span class=s>nginx</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;nginx&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;-c&quot;</span><span class=p>]</span><span class=w> </span>#<span class=w> </span>定参
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/etc/nginx/nginx.conf&quot;</span><span class=p>]</span><span class=w> </span>#<span class=w> </span>变参<span class=w> </span>
</code></pre></div> <p>1、不传参运行</p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>$<span class=w> </span>docker<span class=w> </span>run<span class=w>  </span>nginx:test
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=c1># 容器内会默认运行以下命令，启动主进程。</span>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>nginx<span class=w> </span>-c<span class=w> </span>/etc/nginx/nginx.conf
</code></pre></div> <p>2、传参运行</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>$<span class=w> </span>docker<span class=w> </span>run<span class=w>  </span>nginx:test<span class=w> </span>-c<span class=w> </span>/etc/nginx/new.conf
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=c1># 容器内会默认运行以下命令，启动主进程(/etc/nginx/new.conf:假设容器内已有此文件)</span>
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>nginx<span class=w> </span>-c<span class=w> </span>/etc/nginx/new.conf
</code></pre></div> <p>我们可以通过两种不同的方式编写 最后的进程启动 命令 ENTRYPOINT</p> <ul> <li> <p>数组：<code>ENTRYPOINT ["python","-m","http.server","33333"]</code></p> </li> <li> <p>字符串：<code>ENTRYPOINT "python -m http.server 33333"</code></p> </li> </ul> <p><strong>数组形式是首选</strong>。</p> <p>这是因为使用字符串形式会导致 Docker 使用 bash 运行您的进程，这无法正确处理信号。</p> <p>由于大多数 shell 不处理子进程的信号，因此如果使用 shell 格式，CTRL-C（生成 SIGTERM）可能不会停止子进程。</p> <h3 id=35-每个run指令后删除多余文件>3.5 每个RUN指令后删除多余文件<a class=headerlink href=#35-每个run指令后删除多余文件 title="Permanent link">&para;</a></h3> <p>示例Dockerfile中，我们可以删除/var/lib/apt/lists/目录中的文件（它们是由apt-get update生成的）。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:20.04</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\ </span><span class=w> </span>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>nodejs<span class=w> </span><span class=se>\</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=w>    </span>#<span class=w> </span>added<span class=w> </span>lines
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>/app<span class=w>  </span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=k>RUN</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>/app<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>npm<span class=w> </span>install
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=k>CMD</span><span class=w> </span>npm<span class=w> </span>start
</code></pre></div> <h3 id=36-copy而不是add>3.6 COPY而不是ADD<a class=headerlink href=#36-copy而不是add title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=c1># 格式</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>COPY<span class=w> </span>&lt;src&gt;<span class=w> </span>&lt;dest&gt;
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a>COPY<span class=w> </span><span class=o>[</span>--chown<span class=o>=</span>&lt;user&gt;:&lt;group&gt;<span class=o>]</span><span class=w> </span>&lt;源路径1&gt;...<span class=w>  </span>&lt;目标路径&gt;
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>COPY<span class=w> </span><span class=o>[</span>--chown<span class=o>=</span>&lt;user&gt;:&lt;group&gt;<span class=o>]</span><span class=w> </span><span class=o>[</span><span class=s2>&quot;&lt;源路径1&gt;&quot;</span>,...<span class=w>  </span><span class=s2>&quot;&lt;目标路径&gt;&quot;</span><span class=o>]</span>
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a>
<a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=c1># [--chown=&lt;user&gt;:&lt;group&gt;]：可选参数，用户改变复制到容器内文件的拥有者和属组。</span>
<a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=c1># 复制本地主机的 `&lt;src&gt;`（为 Dockerfile 所在目录的相对路径）到容器中的 `&lt;dest&gt;`</span>
</code></pre></div> <p><code>&lt;源路径&gt;</code>：源文件或者源目录，这里可以是通配符表达式，其通配符规则要满足 Go 的 <code>filepath.Match</code> 规则。例如：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a>COPY<span class=w> </span>hom*<span class=w> </span>/mydir/
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>COPY<span class=w> </span>hom?.txt<span class=w> </span>/mydir/
</code></pre></div> <p><code>&lt;目标路径&gt;</code>：容器内的指定路径，该路径不用事先建好，路径不存在的话，会自动创建。</p> <p>如果有多个步骤使用上下文中的不同文件，请单独复制它们，而不是一次全部复制。</p> <p>这可确保每个步骤的生成缓存仅失效，并在特别需要的文件发生更改时强制重新运行该步骤。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=k>COPY</span><span class=w> </span>requirements.txt<span class=w> </span>/tmp/
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=k>RUN</span><span class=w> </span>pip<span class=w> </span>install<span class=w> </span>--requirement<span class=w> </span>/tmp/requirements.txt
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>/tmp/
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>拷贝目录的一个坑</p> <p>拷贝文件不需要写目标</p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=c># 拷贝文件</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=k>FROM</span><span class=w> </span><span class=s>centos</span>
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=k>COPY</span><span class=w> </span><span class=m>2</span>.txt<span class=w> </span>/usr/local/
</code></pre></div> <p>拷贝目录则需要这样写,目标,不然拷贝不进去</p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=c># 拷贝目录</span>
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=k>FROM</span><span class=w> </span><span class=s>centos</span>
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=k>COPY</span><span class=w> </span>mysql<span class=w> </span>/usr/local/mysql
</code></pre></div> </div> <h3 id=37-使用dockerignore>3.7 使用.dockerignore<a class=headerlink href=#37-使用dockerignore title="Permanent link">&para;</a></h3> <p><code>.dockerignore</code>文件的作用类似于git工程中的 .gitignore 。不同的是 .dockerignore 应用于 docker 镜像的构建，它存在于 docker 构建上下文的根目录，用来忽略不需要打入镜像的文件</p> <p><code>.dockerignore</code>文件的写法和 .gitignore 类似，支持正则和通配符，具体规则如下：</p> <ul> <li> <p>每行为一个条目；</p> </li> <li> <p>以 # 开头的行为注释；</p> </li> <li> <p>空行被忽略；</p> </li> <li> <p>构建上下文路径为所有文件的根路径；</p> </li> </ul> <table> <thead> <tr> <th>规则</th> <th>行为</th> </tr> </thead> <tbody> <tr> <td>/temp</td> <td>匹配根路径下一级目录下所有以 temp 开头的文件或目录</td> </tr> <tr> <td>//temp*</td> <td>匹配根路径下两级目录下所有以 temp 开头的文件或目录</td> </tr> <tr> <td>temp?</td> <td>匹配根路径下以 temp 开头，任意一个字符结尾的文件或目录</td> </tr> <tr> <td>**/*.go</td> <td>匹配所有路径下以 .go 结尾的文件或目录，即递归搜索所有路径</td> </tr> <tr> <td>*.md !README.md</td> <td>匹配根路径下所有以 .md 结尾的文件或目录，但 README.md 除外</td> </tr> </tbody> </table> <h3 id=38-利用多阶段构建>3.8 利用多阶段构建<a class=headerlink href=#38-利用多阶段构建 title="Permanent link">&para;</a></h3> <p>多阶段构建可以让我们大幅度减小最终的镜像大小，而不需要去想办法减少中间层和文件的数量。因为镜像是在生成过程的最后阶段生成的，所以可以利用生成缓存来最小化镜像层。</p> <p>例如，如果你的构建包含多个层，则可以将它们从变化频率较低（以确保生成缓存可重用）到变化频率较高的顺序排序：</p> <ul> <li>安装构建应用程序所需的依赖工具</li> <li>安装或更新依赖项</li> <li>构建你的应用</li> </ul> <p>比如我们构建一个 Go 应用程序的 Dockerfile 可能类似于这样：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=k>FROM</span><span class=w> </span><span class=s>golang:1.11-alpine</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s>build</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=c># 安装项目需要的工具</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=c># 运行 `docker build --no-cache .` 来更新依赖</span>
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>add<span class=w> </span>--no-cache<span class=w> </span>git
<a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>get<span class=w> </span>github.com/golang/dep/cmd/dep
<a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a>
<a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a><span class=c># 通过 Gopkg.toml 和 Gopkg.lock 获取项目的依赖</span>
<a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a><span class=c># 仅在更新 Gopkg 文件时才重新构建这些层</span>
<a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=k>COPY</span><span class=w> </span>Gopkg.lock<span class=w> </span>Gopkg.toml<span class=w> </span>/go/src/project/
<a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/go/src/project/</span>
<a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a><span class=c># 安装依赖库</span>
<a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a><span class=k>RUN</span><span class=w> </span>dep<span class=w> </span>ensure<span class=w> </span>-vendor-only
<a id=__codelineno-43-14 name=__codelineno-43-14 href=#__codelineno-43-14></a>
<a id=__codelineno-43-15 name=__codelineno-43-15 href=#__codelineno-43-15></a><span class=c># 拷贝整个项目进行构建</span>
<a id=__codelineno-43-16 name=__codelineno-43-16 href=#__codelineno-43-16></a><span class=c># 当项目下面有文件变化的时候该层才会重新构建</span>
<a id=__codelineno-43-17 name=__codelineno-43-17 href=#__codelineno-43-17></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>/go/src/project/
<a id=__codelineno-43-18 name=__codelineno-43-18 href=#__codelineno-43-18></a><span class=k>RUN</span><span class=w> </span>go<span class=w> </span>build<span class=w> </span>-o<span class=w> </span>/bin/project
<a id=__codelineno-43-19 name=__codelineno-43-19 href=#__codelineno-43-19></a>
<a id=__codelineno-43-20 name=__codelineno-43-20 href=#__codelineno-43-20></a><span class=c># 将打包后的二进制文件拷贝到 scratch 镜像下面，将镜像大小降到最低</span>
<a id=__codelineno-43-21 name=__codelineno-43-21 href=#__codelineno-43-21></a><span class=k>FROM</span><span class=w> </span><span class=s>scratch</span>
<a id=__codelineno-43-22 name=__codelineno-43-22 href=#__codelineno-43-22></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/bin/project<span class=w> </span>/bin/project
<a id=__codelineno-43-23 name=__codelineno-43-23 href=#__codelineno-43-23></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/bin/project&quot;</span><span class=p>]</span>
<a id=__codelineno-43-24 name=__codelineno-43-24 href=#__codelineno-43-24></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;--help&quot;</span><span class=p>]</span>
</code></pre></div> <p>其他示例Dockerfile</p> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=c># 构建：使用golang:1.13版本</span>
<a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=k>FROM</span><span class=w> </span><span class=s>golang:1.13</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s>build</span>
<a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a>
<a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a><span class=c># 容器环境变量添加，会覆盖默认的变量值</span>
<a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a><span class=k>ENV</span><span class=w> </span><span class=nv>GO111MODULE</span><span class=o>=</span>on
<a id=__codelineno-44-6 name=__codelineno-44-6 href=#__codelineno-44-6></a><span class=k>ENV</span><span class=w> </span><span class=nv>GOPROXY</span><span class=o>=</span>https://goproxy.cn,direct
<a id=__codelineno-44-7 name=__codelineno-44-7 href=#__codelineno-44-7></a>
<a id=__codelineno-44-8 name=__codelineno-44-8 href=#__codelineno-44-8></a><span class=c># 设置工作区</span>
<a id=__codelineno-44-9 name=__codelineno-44-9 href=#__codelineno-44-9></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/go/release</span>
<a id=__codelineno-44-10 name=__codelineno-44-10 href=#__codelineno-44-10></a>
<a id=__codelineno-44-11 name=__codelineno-44-11 href=#__codelineno-44-11></a><span class=c># 把全部文件添加到/go/release目录</span>
<a id=__codelineno-44-12 name=__codelineno-44-12 href=#__codelineno-44-12></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>.
<a id=__codelineno-44-13 name=__codelineno-44-13 href=#__codelineno-44-13></a>
<a id=__codelineno-44-14 name=__codelineno-44-14 href=#__codelineno-44-14></a><span class=c># 编译：把cmd/main.go编译成可执行的二进制文件，命名为app</span>
<a id=__codelineno-44-15 name=__codelineno-44-15 href=#__codelineno-44-15></a><span class=k>RUN</span><span class=w> </span><span class=nv>GOOS</span><span class=o>=</span>linux<span class=w> </span><span class=nv>CGO_ENABLED</span><span class=o>=</span><span class=m>0</span><span class=w> </span><span class=nv>GOARCH</span><span class=o>=</span>amd64<span class=w> </span>go<span class=w> </span>build<span class=w> </span>-ldflags<span class=o>=</span><span class=s2>&quot;-s -w&quot;</span><span class=w> </span>-installsuffix<span class=w> </span>cgo<span class=w> </span>-o<span class=w> </span>app<span class=w> </span>cmd/main.go
<a id=__codelineno-44-16 name=__codelineno-44-16 href=#__codelineno-44-16></a>
<a id=__codelineno-44-17 name=__codelineno-44-17 href=#__codelineno-44-17></a><span class=c># 运行：使用scratch作为基础镜像</span>
<a id=__codelineno-44-18 name=__codelineno-44-18 href=#__codelineno-44-18></a><span class=k>FROM</span><span class=w> </span><span class=s>scratch</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s>prod</span>
<a id=__codelineno-44-19 name=__codelineno-44-19 href=#__codelineno-44-19></a>
<a id=__codelineno-44-20 name=__codelineno-44-20 href=#__codelineno-44-20></a><span class=c># 在build阶段复制时区到</span>
<a id=__codelineno-44-21 name=__codelineno-44-21 href=#__codelineno-44-21></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/usr/share/zoneinfo/Asia/Shanghai<span class=w> </span>/etc/localtime
<a id=__codelineno-44-22 name=__codelineno-44-22 href=#__codelineno-44-22></a><span class=c># 在build阶段复制可执行的go二进制文件app</span>
<a id=__codelineno-44-23 name=__codelineno-44-23 href=#__codelineno-44-23></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/go/release/app<span class=w> </span>/
<a id=__codelineno-44-24 name=__codelineno-44-24 href=#__codelineno-44-24></a><span class=c># 在build阶段复制配置文件</span>
<a id=__codelineno-44-25 name=__codelineno-44-25 href=#__codelineno-44-25></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/go/release/config<span class=w> </span>./config
<a id=__codelineno-44-26 name=__codelineno-44-26 href=#__codelineno-44-26></a>
<a id=__codelineno-44-27 name=__codelineno-44-27 href=#__codelineno-44-27></a><span class=c># 启动服务</span>
<a id=__codelineno-44-28 name=__codelineno-44-28 href=#__codelineno-44-28></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/app&quot;</span><span class=p>]</span>
</code></pre></div> <p>可以使用多个语句。每个指令都可以使用不同的基础，并且每个指令都开始构建的新阶段。</p> <p>我们可以有选择地将伪影从一个阶段复制到另一个阶段，在最终镜像中留下我们不想要的所有内容。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=c>#syntax=docker/dockerfile:1.4</span>
<a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a><span class=k>FROM</span><span class=w> </span><span class=s>…</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s>build1</span>
<a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a><span class=k>COPY</span><span class=w> </span>–from<span class=o>=</span>app1<span class=w> </span>.<span class=w> </span>/src
<a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a>
<a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a><span class=k>FROM</span><span class=w> </span><span class=s>…</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s>build2</span>
<a id=__codelineno-45-6 name=__codelineno-45-6 href=#__codelineno-45-6></a><span class=k>COPY</span><span class=w> </span>–from<span class=o>=</span>app2<span class=w> </span>.<span class=w> </span>/src
<a id=__codelineno-45-7 name=__codelineno-45-7 href=#__codelineno-45-7></a>
<a id=__codelineno-45-8 name=__codelineno-45-8 href=#__codelineno-45-8></a><span class=k>FROM</span><span class=w> </span><span class=s>…</span>
<a id=__codelineno-45-9 name=__codelineno-45-9 href=#__codelineno-45-9></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build1<span class=w> </span>/out/app1<span class=w> </span>/bin/
<a id=__codelineno-45-10 name=__codelineno-45-10 href=#__codelineno-45-10></a><span class=k>COPY</span><span class=w> </span>–-from<span class=o>=</span>build2<span class=w> </span>/out/app2<span class=w> </span>/bin/
</code></pre></div> <div class="admonition info"> <p class=admonition-title>参考文献</p> <p><a href=https://www.cnblogs.com/FireworksEasyCool/p/12838875.html>多阶段构建Golang程序Docker镜像</a></p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=c># Official docker build image, Using  node:14.17-alpine3.14 image for stage-1.</span>
<a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a><span class=c># Stage-1</span>
<a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=k>FROM</span><span class=w> </span><span class=s>node:14.17-alpine3.14</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s>build</span>
<a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a><span class=c># Copy Required files</span>
<a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a><span class=k>COPY</span><span class=w> </span>public<span class=w> </span>/home/app/public/
<a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a><span class=k>COPY</span><span class=w> </span>src<span class=w> </span>/home/app/src/
<a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a><span class=c># dockerfile install multiple packages</span>
<a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>add<span class=w> </span>g++<span class=w> </span>make<span class=w> </span>python2
<a id=__codelineno-46-9 name=__codelineno-46-9 href=#__codelineno-46-9></a><span class=k>RUN</span><span class=w> </span>npm<span class=w> </span>install<span class=w> </span>--silent
<a id=__codelineno-46-10 name=__codelineno-46-10 href=#__codelineno-46-10></a><span class=c># Create Build</span>
<a id=__codelineno-46-11 name=__codelineno-46-11 href=#__codelineno-46-11></a><span class=k>RUN</span><span class=w> </span>npm<span class=w> </span>run<span class=w> </span>build
<a id=__codelineno-46-12 name=__codelineno-46-12 href=#__codelineno-46-12></a><span class=k>RUN</span><span class=w> </span>apk<span class=w> </span>--purge<span class=w> </span>del<span class=w> </span>python2
<a id=__codelineno-46-13 name=__codelineno-46-13 href=#__codelineno-46-13></a><span class=c>#Run the build by copying the files form previous stage.</span>
<a id=__codelineno-46-14 name=__codelineno-46-14 href=#__codelineno-46-14></a><span class=c># Stage-2</span>
<a id=__codelineno-46-15 name=__codelineno-46-15 href=#__codelineno-46-15></a><span class=k>FROM</span><span class=w> </span><span class=s>nginx:stable-alpine</span>
<a id=__codelineno-46-16 name=__codelineno-46-16 href=#__codelineno-46-16></a><span class=k>COPY</span><span class=w> </span>nginx.conf<span class=w> </span>/etc/nginx/conf.d/default.conf
<a id=__codelineno-46-17 name=__codelineno-46-17 href=#__codelineno-46-17></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/home/app/build<span class=w> </span>/usr/share/nginx/html
<a id=__codelineno-46-18 name=__codelineno-46-18 href=#__codelineno-46-18></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>80</span>
<a id=__codelineno-46-19 name=__codelineno-46-19 href=#__codelineno-46-19></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;nginx&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;-g&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;daemon off;&quot;</span><span class=p>]</span>
</code></pre></div> <h3 id=39-写dockerfile的一些技巧>3.9 写Dockerfile的一些技巧<a class=headerlink href=#39-写dockerfile的一些技巧 title="Permanent link">&para;</a></h3> <h4 id=1用-python--m-pip-而不是-pip>1.用 python -m pip 而不是 pip<a class=headerlink href=#1用-python--m-pip-而不是-pip title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=c1># 升级 pip,让 pip install 更安静,--quiet 参数</span>
<a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a>$<span class=w> </span>python<span class=w> </span>-m<span class=w> </span>pip<span class=w> </span>install<span class=w> </span>--quiet<span class=w> </span>--upgrade<span class=w> </span>pip
<a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a>
<a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=c1># pip使用国内源</span>
<a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a>$<span class=w> </span>python<span class=w> </span>-m<span class=w> </span>pip<span class=w> </span>install<span class=w> </span>--quiet<span class=w> </span>--upgrade<span class=w> </span>pip<span class=w> </span><span class=se>\</span>
<a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a><span class=o>&amp;&amp;</span><span class=w> </span>pip<span class=w> </span>install<span class=w> </span>-i<span class=w> </span>https://pypi.tuna.tsinghua.edu.cn/simple<span class=w> </span>--no-cache-dir<span class=w> </span>-r<span class=w> </span>requirements.txt
</code></pre></div> <h4 id=2让-apt-get-install-更安静>2.让 apt-get install 更安静<a class=headerlink href=#2让-apt-get-install-更安静 title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=c1>#我们用 -qq 命令，甚至重定向输出到 /dev/null 让它更安静。</span>
<a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a>$<span class=w> </span>apt-get<span class=w> </span>-qq<span class=w> </span>update
<a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a>$<span class=w> </span>apt-get<span class=w> </span>-qq<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>curl<span class=w> </span>&gt;<span class=w> </span>/dev/null
</code></pre></div> <h4 id=3让-curl-和-wget-更安静>3.让 curl 和 wget 更安静<a class=headerlink href=#3让-curl-和-wget-更安静 title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=c1># 首先，如果要下载文件，curl 和 wget 二选一即可。如果用 curl，可以用 --silent 参数。</span>
<a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a>$<span class=w> </span>curl<span class=w> </span>-sLO<span class=w> </span>https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
<a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a>
<a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a><span class=c1>#wget 有 --quiet 参数。</span>
<a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a>$<span class=w> </span>wget<span class=w> </span>-q<span class=w> </span>https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
</code></pre></div> <h4 id=4用axel而不是curl或者wget>4.用axel而不是curl或者wget<a class=headerlink href=#4用axel而不是curl或者wget title="Permanent link">&para;</a></h4> <p>对于身处国内的开发者，axel 完全可以取代 curl 以及 wget <div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Install Go compiler ...&quot;</span>
<a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a>
<a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a><span class=nv>GO_MIRROR_0</span><span class=o>=</span><span class=s2>&quot;http://mirrors.ustc.edu.cn/golang/go1.13.4.linux-amd64.tar.gz&quot;</span>
<a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a>
<a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a><span class=nv>GO_MIRROR_1</span><span class=o>=</span><span class=s2>&quot;https://dl.google.com/go/go1.13.4.linux-amd64.tar.gz&quot;</span>
<a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a>
<a id=__codelineno-50-7 name=__codelineno-50-7 href=#__codelineno-50-7></a>axel<span class=w> </span>--quiet<span class=w> </span>--output<span class=w> </span>go.tar.gz<span class=w> </span><span class=nv>$GO_MIRROR_0</span><span class=w> </span><span class=nv>$GO_MIRROR_1</span>
</code></pre></div></p> <h4 id=5设置容器时间同步>5.设置容器时间同步<a class=headerlink href=#5设置容器时间同步 title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=c1>#设置容器时间与宿主机时间同步</span>
<a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>RUN<span class=w> </span>/bin/cp<span class=w> </span>/usr/share/zoneinfo/Asia/Shanghai<span class=w> </span>/etc/localtime<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s1>&#39;Asia/Shanghai&#39;</span><span class=w> </span>&gt;/etc/timezone
</code></pre></div> <p>Dockerfile中配置时区 <div class=highlight><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class="l l-Scalar l-Scalar-Plain">FROM docker.io/centos</span>
<a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a><span class="l l-Scalar l-Scalar-Plain">MAINTAINER DAVID</span>
<a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a>
<a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a><span class="l l-Scalar l-Scalar-Plain"># 使用RUN命令设置时区</span>
<a id=__codelineno-52-5 name=__codelineno-52-5 href=#__codelineno-52-5></a><span class="l l-Scalar l-Scalar-Plain">RUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; echo &#39;Asia/Shanghai&#39;&gt;/etc/timezone</span>
</code></pre></div></p> <p>docker-compose.yaml设置时区</p> <div class=highlight><pre><span></span><code><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class="l l-Scalar l-Scalar-Plain">方式一：</span>
<a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a><span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span>
<a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">SET_CONTAINER_TIMEZONE=true</span>
<a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CONTAINER_TIMEZONE=Asia/Shanghai</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class="l l-Scalar l-Scalar-Plain">方式二：</span>
<a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a><span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span>
<a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">TZ=Asia/Shanghai</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>写 Dockerfile 的一些技巧</p> <p><a href=https://zhuanlan.zhihu.com/p/147995194>https://zhuanlan.zhihu.com/p/147995194</a></p> </div> <h3 id=310-docker-build镜像创建>3.10 docker build镜像创建<a class=headerlink href=#310-docker-build镜像创建 title="Permanent link">&para;</a></h3> <blockquote> <p>通过Dockerfile创建docker镜像</p> </blockquote> <div class=highlight><pre><span></span><code><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a>docker<span class=w> </span>build<span class=w> </span><span class=o>[</span>OPTIONS<span class=o>]</span><span class=w> </span>PATH<span class=w> </span><span class=p>|</span><span class=w> </span>URL<span class=w> </span><span class=p>|</span><span class=w> </span>-
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a>--build-arg=[] :设置镜像创建时的变量；
<a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a>--cpu-shares :设置 cpu 使用权重；
<a id=__codelineno-56-3 name=__codelineno-56-3 href=#__codelineno-56-3></a>--cpu-period :限制 CPU CFS周期；
<a id=__codelineno-56-4 name=__codelineno-56-4 href=#__codelineno-56-4></a>--cpu-quota :限制 CPU CFS配额；
<a id=__codelineno-56-5 name=__codelineno-56-5 href=#__codelineno-56-5></a>--cpuset-cpus :指定使用的CPU id；
<a id=__codelineno-56-6 name=__codelineno-56-6 href=#__codelineno-56-6></a>--cpuset-mems :指定使用的内存 id；
<a id=__codelineno-56-7 name=__codelineno-56-7 href=#__codelineno-56-7></a>--disable-content-trust :忽略校验，默认开启；
<a id=__codelineno-56-8 name=__codelineno-56-8 href=#__codelineno-56-8></a>-f :指定要使用的Dockerfile路径；
<a id=__codelineno-56-9 name=__codelineno-56-9 href=#__codelineno-56-9></a>--force-rm :设置镜像过程中删除中间容器；
<a id=__codelineno-56-10 name=__codelineno-56-10 href=#__codelineno-56-10></a>--isolation :使用容器隔离技术；
<a id=__codelineno-56-11 name=__codelineno-56-11 href=#__codelineno-56-11></a>--label=[] :设置镜像使用的元数据；
<a id=__codelineno-56-12 name=__codelineno-56-12 href=#__codelineno-56-12></a>-m :设置内存最大值；
<a id=__codelineno-56-13 name=__codelineno-56-13 href=#__codelineno-56-13></a>--memory-swap :设置Swap的最大值为内存+swap，&quot;-1&quot;表示不限swap；
<a id=__codelineno-56-14 name=__codelineno-56-14 href=#__codelineno-56-14></a>--no-cache :创建镜像的过程不使用缓存；
<a id=__codelineno-56-15 name=__codelineno-56-15 href=#__codelineno-56-15></a>--pull :尝试去更新镜像的新版本；
<a id=__codelineno-56-16 name=__codelineno-56-16 href=#__codelineno-56-16></a>--quiet, -q :安静模式，成功后只输出镜像 ID；
<a id=__codelineno-56-17 name=__codelineno-56-17 href=#__codelineno-56-17></a>--rm :设置镜像成功后删除中间容器；
<a id=__codelineno-56-18 name=__codelineno-56-18 href=#__codelineno-56-18></a>--shm-size :设置/dev/shm的大小，默认值是64M；
<a id=__codelineno-56-19 name=__codelineno-56-19 href=#__codelineno-56-19></a>--ulimit :Ulimit配置。
<a id=__codelineno-56-20 name=__codelineno-56-20 href=#__codelineno-56-20></a>--tag, -t: 镜像的名字及标签，通常 name:tag 或者 name 格式；可以在一次构建中为一个镜像设置多个标签。
<a id=__codelineno-56-21 name=__codelineno-56-21 href=#__codelineno-56-21></a>--network: 默认 default。在构建期间设置RUN指令的网络模式
</code></pre></div> <h3 id=311-dockerfile参考>3.11 dockerfile参考<a class=headerlink href=#311-dockerfile参考 title="Permanent link">&para;</a></h3> <div class="tabbed-set tabbed-alternate" data-tabs=3:3><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><input id=__tabbed_3_3 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Debian-8</label><label for=__tabbed_3_2>ubuntu20.04-Dockerfile示例1</label><label for=__tabbed_3_3>ubuntu20.04-Dockerfile示例2</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=k>FROM</span><span class=w> </span><span class=s>buildpack-deps:jessie</span>
<a id=__codelineno-57-2 name=__codelineno-57-2 href=#__codelineno-57-2></a>
<a id=__codelineno-57-3 name=__codelineno-57-3 href=#__codelineno-57-3></a><span class=c># remove several traces of debian python</span>
<a id=__codelineno-57-4 name=__codelineno-57-4 href=#__codelineno-57-4></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>purge<span class=w> </span>-y<span class=w> </span>python.*
<a id=__codelineno-57-5 name=__codelineno-57-5 href=#__codelineno-57-5></a>
<a id=__codelineno-57-6 name=__codelineno-57-6 href=#__codelineno-57-6></a><span class=c># http://bugs.python.org/issue19846</span>
<a id=__codelineno-57-7 name=__codelineno-57-7 href=#__codelineno-57-7></a><span class=c># &gt; At the moment, setting &quot;LANG=C&quot; on a Linux system *fundamentally breaks Python 3*, and that&#39;s not OK.</span>
<a id=__codelineno-57-8 name=__codelineno-57-8 href=#__codelineno-57-8></a><span class=k>ENV</span><span class=w> </span>LANG<span class=w> </span>C.UTF-8
<a id=__codelineno-57-9 name=__codelineno-57-9 href=#__codelineno-57-9></a>
<a id=__codelineno-57-10 name=__codelineno-57-10 href=#__codelineno-57-10></a><span class=c># gpg: key F73C700D: public key &quot;Larry Hastings &lt;larry@hastings.org&gt;&quot; imported</span>
<a id=__codelineno-57-11 name=__codelineno-57-11 href=#__codelineno-57-11></a><span class=k>ENV</span><span class=w> </span>GPG_KEY<span class=w> </span>97FC712E4C024BBEA48A61ED3A5CA953F73C700D
<a id=__codelineno-57-12 name=__codelineno-57-12 href=#__codelineno-57-12></a>
<a id=__codelineno-57-13 name=__codelineno-57-13 href=#__codelineno-57-13></a><span class=k>ENV</span><span class=w> </span>PYTHON_VERSION<span class=w> </span><span class=m>3</span>.5.1
<a id=__codelineno-57-14 name=__codelineno-57-14 href=#__codelineno-57-14></a>
<a id=__codelineno-57-15 name=__codelineno-57-15 href=#__codelineno-57-15></a><span class=c># if this is called &quot;PIP_VERSION&quot;, pip explodes with &quot;ValueError: invalid truth value &#39;&lt;VERSION&gt;&#39;&quot;</span>
<a id=__codelineno-57-16 name=__codelineno-57-16 href=#__codelineno-57-16></a><span class=k>ENV</span><span class=w> </span>PYTHON_PIP_VERSION<span class=w> </span><span class=m>8</span>.1.2
<a id=__codelineno-57-17 name=__codelineno-57-17 href=#__codelineno-57-17></a>
<a id=__codelineno-57-18 name=__codelineno-57-18 href=#__codelineno-57-18></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-ex<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-19 name=__codelineno-57-19 href=#__codelineno-57-19></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-fSL<span class=w> </span><span class=s2>&quot;https://www.python.org/ftp/python/</span><span class=si>${</span><span class=nv>PYTHON_VERSION</span><span class=p>%%[a-z]*</span><span class=si>}</span><span class=s2>/Python-</span><span class=nv>$PYTHON_VERSION</span><span class=s2>.tar.xz&quot;</span><span class=w> </span>-o<span class=w> </span>python.tar.xz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-20 name=__codelineno-57-20 href=#__codelineno-57-20></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>curl<span class=w> </span>-fSL<span class=w> </span><span class=s2>&quot;https://www.python.org/ftp/python/</span><span class=si>${</span><span class=nv>PYTHON_VERSION</span><span class=p>%%[a-z]*</span><span class=si>}</span><span class=s2>/Python-</span><span class=nv>$PYTHON_VERSION</span><span class=s2>.tar.xz.asc&quot;</span><span class=w> </span>-o<span class=w> </span>python.tar.xz.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-21 name=__codelineno-57-21 href=#__codelineno-57-21></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>export</span><span class=w> </span><span class=nv>GNUPGHOME</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>mktemp<span class=w> </span>-d<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-22 name=__codelineno-57-22 href=#__codelineno-57-22></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>gpg<span class=w> </span>--keyserver<span class=w> </span>ha.pool.sks-keyservers.net<span class=w> </span>--recv-keys<span class=w> </span><span class=s2>&quot;</span><span class=nv>$GPG_KEY</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-23 name=__codelineno-57-23 href=#__codelineno-57-23></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>gpg<span class=w> </span>--batch<span class=w> </span>--verify<span class=w> </span>python.tar.xz.asc<span class=w> </span>python.tar.xz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-24 name=__codelineno-57-24 href=#__codelineno-57-24></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-r<span class=w> </span><span class=s2>&quot;</span><span class=nv>$GNUPGHOME</span><span class=s2>&quot;</span><span class=w> </span>python.tar.xz.asc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-25 name=__codelineno-57-25 href=#__codelineno-57-25></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>/usr/src/python<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-26 name=__codelineno-57-26 href=#__codelineno-57-26></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>-xJC<span class=w> </span>/usr/src/python<span class=w> </span>--strip-components<span class=o>=</span><span class=m>1</span><span class=w> </span>-f<span class=w> </span>python.tar.xz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-27 name=__codelineno-57-27 href=#__codelineno-57-27></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>python.tar.xz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-28 name=__codelineno-57-28 href=#__codelineno-57-28></a><span class=w>        </span><span class=se>\</span>
<a id=__codelineno-57-29 name=__codelineno-57-29 href=#__codelineno-57-29></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>/usr/src/python<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-30 name=__codelineno-57-30 href=#__codelineno-57-30></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>./configure<span class=w> </span>--enable-shared<span class=w> </span>--enable-unicode<span class=o>=</span>ucs4<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-31 name=__codelineno-57-31 href=#__codelineno-57-31></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w> </span>-j<span class=k>$(</span>nproc<span class=k>)</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-32 name=__codelineno-57-32 href=#__codelineno-57-32></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>make<span class=w> </span>install<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-33 name=__codelineno-57-33 href=#__codelineno-57-33></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>ldconfig<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-34 name=__codelineno-57-34 href=#__codelineno-57-34></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>pip3<span class=w> </span>install<span class=w> </span>--no-cache-dir<span class=w> </span>--upgrade<span class=w> </span>--ignore-installed<span class=w> </span><span class=nv>pip</span><span class=o>==</span><span class=nv>$PYTHON_PIP_VERSION</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-35 name=__codelineno-57-35 href=#__codelineno-57-35></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>find<span class=w> </span>/usr/local<span class=w> </span>-depth<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-36 name=__codelineno-57-36 href=#__codelineno-57-36></a><span class=w>                </span><span class=se>\(</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-37 name=__codelineno-57-37 href=#__codelineno-57-37></a><span class=w>                    </span><span class=se>\(</span><span class=w> </span>-type<span class=w> </span>d<span class=w> </span>-a<span class=w> </span>-name<span class=w> </span><span class=nb>test</span><span class=w> </span>-o<span class=w> </span>-name<span class=w> </span>tests<span class=w> </span><span class=se>\)</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-38 name=__codelineno-57-38 href=#__codelineno-57-38></a><span class=w>                    </span>-o<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-39 name=__codelineno-57-39 href=#__codelineno-57-39></a><span class=w>                    </span><span class=se>\(</span><span class=w> </span>-type<span class=w> </span>f<span class=w> </span>-a<span class=w> </span>-name<span class=w> </span><span class=s1>&#39;*.pyc&#39;</span><span class=w> </span>-o<span class=w> </span>-name<span class=w> </span><span class=s1>&#39;*.pyo&#39;</span><span class=w> </span><span class=se>\)</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-40 name=__codelineno-57-40 href=#__codelineno-57-40></a><span class=w>                </span><span class=se>\)</span><span class=w> </span>-exec<span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span><span class=s1>&#39;{}&#39;</span><span class=w> </span>+<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-41 name=__codelineno-57-41 href=#__codelineno-57-41></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/usr/src/python<span class=w> </span>~/.cache
<a id=__codelineno-57-42 name=__codelineno-57-42 href=#__codelineno-57-42></a>
<a id=__codelineno-57-43 name=__codelineno-57-43 href=#__codelineno-57-43></a><span class=c># make some useful symlinks that are expected to exist</span>
<a id=__codelineno-57-44 name=__codelineno-57-44 href=#__codelineno-57-44></a><span class=k>RUN</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>/usr/local/bin<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-45 name=__codelineno-57-45 href=#__codelineno-57-45></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>ln<span class=w> </span>-s<span class=w> </span>easy_install-3.5<span class=w> </span>easy_install<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-46 name=__codelineno-57-46 href=#__codelineno-57-46></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>ln<span class=w> </span>-s<span class=w> </span>idle3<span class=w> </span>idle<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-47 name=__codelineno-57-47 href=#__codelineno-57-47></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>ln<span class=w> </span>-s<span class=w> </span>pydoc3<span class=w> </span>pydoc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-48 name=__codelineno-57-48 href=#__codelineno-57-48></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>ln<span class=w> </span>-s<span class=w> </span>python3<span class=w> </span>python<span class=w> </span><span class=se>\</span>
<a id=__codelineno-57-49 name=__codelineno-57-49 href=#__codelineno-57-49></a><span class=w>        </span><span class=o>&amp;&amp;</span><span class=w> </span>ln<span class=w> </span>-s<span class=w> </span>python3-config<span class=w> </span>python-config
<a id=__codelineno-57-50 name=__codelineno-57-50 href=#__codelineno-57-50></a>
<a id=__codelineno-57-51 name=__codelineno-57-51 href=#__codelineno-57-51></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;python3&quot;</span><span class=p>]</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:focal</span>
<a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/opt</span>
<a id=__codelineno-58-3 name=__codelineno-58-3 href=#__codelineno-58-3></a><span class=k>ARG</span><span class=w> </span>TARGETARCH<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-4 name=__codelineno-58-4 href=#__codelineno-58-4></a><span class=w>    </span><span class=nv>Version</span><span class=o>=</span>v2.28.7
<a id=__codelineno-58-5 name=__codelineno-58-5 href=#__codelineno-58-5></a><span class=k>ENV</span><span class=w> </span><span class=nv>Version</span><span class=o>=</span><span class=si>${</span><span class=nv>Version</span><span class=si>}</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-6 name=__codelineno-58-6 href=#__codelineno-58-6></a><span class=w>    </span><span class=nv>LANG</span><span class=o>=</span>zh_CN.UTF-8
<a id=__codelineno-58-7 name=__codelineno-58-7 href=#__codelineno-58-7></a>
<a id=__codelineno-58-8 name=__codelineno-58-8 href=#__codelineno-58-8></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-ex<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-9 name=__codelineno-58-9 href=#__codelineno-58-9></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-10 name=__codelineno-58-10 href=#__codelineno-58-10></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span>wget<span class=w> </span>curl<span class=w> </span>gnupg2<span class=w> </span>ca-certificates<span class=w> </span>lsb-release<span class=w> </span>language-pack-zh-hans<span class=w> </span>netcat<span class=w> </span>software-properties-common<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-11 name=__codelineno-58-11 href=#__codelineno-58-11></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>ln<span class=w> </span>-sf<span class=w> </span>/usr/share/zoneinfo/Asia/Shanghai<span class=w> </span>/etc/localtime<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-12 name=__codelineno-58-12 href=#__codelineno-58-12></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;LANG=</span><span class=nv>$LANG</span><span class=s2>&quot;</span><span class=w> </span>&gt;<span class=w> </span>/etc/default/locale<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-13 name=__codelineno-58-13 href=#__codelineno-58-13></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;deb https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 multiverse&quot;</span><span class=w> </span>&gt;<span class=w> </span>/etc/apt/sources.list.d/mongodb-org-6.0.list<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-14 name=__codelineno-58-14 href=#__codelineno-58-14></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>wget<span class=w> </span>-qO<span class=w> </span>-<span class=w> </span>https://www.mongodb.org/static/pgp/server-6.0.asc<span class=w> </span><span class=p>|</span><span class=w> </span>apt-key<span class=w> </span>add<span class=w> </span>-<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-15 name=__codelineno-58-15 href=#__codelineno-58-15></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>add-apt-repository<span class=w> </span>-y<span class=w> </span>ppa:redislabs/redis<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-16 name=__codelineno-58-16 href=#__codelineno-58-16></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-17 name=__codelineno-58-17 href=#__codelineno-58-17></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>--no-install-recommends<span class=w> </span>openssh-client<span class=w> </span>mariadb-client<span class=w> </span>bash-completion<span class=w> </span>redis-tools<span class=w> </span>mongodb-mongosh<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-18 name=__codelineno-58-18 href=#__codelineno-58-18></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>clean<span class=w> </span>all<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-19 name=__codelineno-58-19 href=#__codelineno-58-19></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-58-20 name=__codelineno-58-20 href=#__codelineno-58-20></a>
<a id=__codelineno-58-21 name=__codelineno-58-21 href=#__codelineno-58-21></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-ex<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-22 name=__codelineno-58-22 href=#__codelineno-58-22></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>wget<span class=w> </span>https://github.com/jumpserver/koko/releases/download/<span class=si>${</span><span class=nv>Version</span><span class=si>}</span>/koko-<span class=si>${</span><span class=nv>Version</span><span class=si>}</span>-linux-<span class=si>${</span><span class=nv>TARGETARCH</span><span class=si>}</span>.tar.gz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-23 name=__codelineno-58-23 href=#__codelineno-58-23></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>-xf<span class=w> </span>koko-<span class=si>${</span><span class=nv>Version</span><span class=si>}</span>-linux-<span class=si>${</span><span class=nv>TARGETARCH</span><span class=si>}</span>.tar.gz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-24 name=__codelineno-58-24 href=#__codelineno-58-24></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>mv<span class=w> </span>koko-<span class=si>${</span><span class=nv>Version</span><span class=si>}</span>-linux-<span class=si>${</span><span class=nv>TARGETARCH</span><span class=si>}</span><span class=w> </span>koko<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-25 name=__codelineno-58-25 href=#__codelineno-58-25></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>mv<span class=w> </span>/opt/koko/kubectl<span class=w> </span>/usr/local/bin/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-26 name=__codelineno-58-26 href=#__codelineno-58-26></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>mv<span class=w> </span>/opt/koko/helm<span class=w> </span>/usr/local/bin/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-27 name=__codelineno-58-27 href=#__codelineno-58-27></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>chown<span class=w> </span>root:root<span class=w> </span>/usr/local/bin/kubectl<span class=w> </span>/usr/local/bin/helm<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-28 name=__codelineno-58-28 href=#__codelineno-58-28></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>wget<span class=w> </span>https://download.jumpserver.org/public/kubectl-linux-<span class=si>${</span><span class=nv>TARGETARCH</span><span class=si>}</span>.tar.gz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-29 name=__codelineno-58-29 href=#__codelineno-58-29></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>-xf<span class=w> </span>kubectl-linux-<span class=si>${</span><span class=nv>TARGETARCH</span><span class=si>}</span>.tar.gz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-30 name=__codelineno-58-30 href=#__codelineno-58-30></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>chmod<span class=w> </span><span class=m>755</span><span class=w> </span>kubectl<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-31 name=__codelineno-58-31 href=#__codelineno-58-31></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>mv<span class=w> </span>kubectl<span class=w> </span>/usr/local/bin/rawkubectl<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-32 name=__codelineno-58-32 href=#__codelineno-58-32></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>wget<span class=w> </span>https://download.jumpserver.org/public/helm-v3.9.0-linux-<span class=si>${</span><span class=nv>TARGETARCH</span><span class=si>}</span>.tar.gz<span class=w> </span>-O<span class=w> </span>helm.tar.gz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-33 name=__codelineno-58-33 href=#__codelineno-58-33></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>-xf<span class=w> </span>helm.tar.gz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-34 name=__codelineno-58-34 href=#__codelineno-58-34></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>mv<span class=w> </span>linux-<span class=si>${</span><span class=nv>TARGETARCH</span><span class=si>}</span>/helm<span class=w> </span>/usr/local/bin/rawhelm<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-35 name=__codelineno-58-35 href=#__codelineno-58-35></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>chmod<span class=w> </span><span class=m>755</span><span class=w> </span>/usr/local/bin/rawhelm<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-36 name=__codelineno-58-36 href=#__codelineno-58-36></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>chown<span class=w> </span>root:root<span class=w> </span>/usr/local/bin/rawhelm<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-37 name=__codelineno-58-37 href=#__codelineno-58-37></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>linux-<span class=si>${</span><span class=nv>TARGETARCH</span><span class=si>}</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-38 name=__codelineno-58-38 href=#__codelineno-58-38></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>wget<span class=w> </span>http://download.jumpserver.org/public/kubectl_aliases.tar.gz<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-39 name=__codelineno-58-39 href=#__codelineno-58-39></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>mkdir<span class=w> </span>/opt/kubectl-aliases/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-40 name=__codelineno-58-40 href=#__codelineno-58-40></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>tar<span class=w> </span>-xf<span class=w> </span>kubectl_aliases.tar.gz<span class=w> </span>-C<span class=w> </span>/opt/kubectl-aliases/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-41 name=__codelineno-58-41 href=#__codelineno-58-41></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>chown<span class=w> </span>-R<span class=w> </span>root:root<span class=w> </span>/opt/kubectl-aliases/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-42 name=__codelineno-58-42 href=#__codelineno-58-42></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>chmod<span class=w> </span><span class=m>755</span><span class=w> </span>/opt/koko/init-kubectl.sh<span class=w> </span><span class=se>\</span>
<a id=__codelineno-58-43 name=__codelineno-58-43 href=#__codelineno-58-43></a><span class=w>    </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/opt/*.tar.gz
<a id=__codelineno-58-44 name=__codelineno-58-44 href=#__codelineno-58-44></a>
<a id=__codelineno-58-45 name=__codelineno-58-45 href=#__codelineno-58-45></a><span class=k>COPY</span><span class=w> </span>koko/entrypoint.sh<span class=w> </span>.
<a id=__codelineno-58-46 name=__codelineno-58-46 href=#__codelineno-58-46></a><span class=k>RUN</span><span class=w> </span>chmod<span class=w> </span><span class=m>755</span><span class=w> </span>./entrypoint.sh
<a id=__codelineno-58-47 name=__codelineno-58-47 href=#__codelineno-58-47></a>
<a id=__codelineno-58-48 name=__codelineno-58-48 href=#__codelineno-58-48></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&quot;./entrypoint.sh&quot;</span><span class=w> </span><span class=p>]</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=k>FROM</span><span class=w> </span><span class=s>ubuntu:20.04</span>
<a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a><span class=k>ARG</span><span class=w> </span><span class=nv>DEBIAN_FRONTEND</span><span class=o>=</span>noninteractive
<a id=__codelineno-59-3 name=__codelineno-59-3 href=#__codelineno-59-3></a><span class=k>ENV</span><span class=w> </span><span class=nv>TZ</span><span class=o>=</span>Asia/Shanghai
<a id=__codelineno-59-4 name=__codelineno-59-4 href=#__codelineno-59-4></a><span class=k>ENV</span><span class=w> </span><span class=nv>LC_ALL</span><span class=o>=</span>en_US.UTF-8
<a id=__codelineno-59-5 name=__codelineno-59-5 href=#__codelineno-59-5></a>
<a id=__codelineno-59-6 name=__codelineno-59-6 href=#__codelineno-59-6></a>
<a id=__codelineno-59-7 name=__codelineno-59-7 href=#__codelineno-59-7></a><span class=k>ARG</span><span class=w> </span><span class=nv>BUILD_DEPENDENCIES</span><span class=o>=</span><span class=s2>&quot;              \</span>
<a id=__codelineno-59-8 name=__codelineno-59-8 href=#__codelineno-59-8></a><span class=s2>        python3                       \</span>
<a id=__codelineno-59-9 name=__codelineno-59-9 href=#__codelineno-59-9></a><span class=s2>        python3-pip                   \</span>
<a id=__codelineno-59-10 name=__codelineno-59-10 href=#__codelineno-59-10></a><span class=s2>        python3-setuptools            \</span>
<a id=__codelineno-59-11 name=__codelineno-59-11 href=#__codelineno-59-11></a><span class=s2>        build-essential               \</span>
<a id=__codelineno-59-12 name=__codelineno-59-12 href=#__codelineno-59-12></a><span class=s2>        python3-dev                   \</span>
<a id=__codelineno-59-13 name=__codelineno-59-13 href=#__codelineno-59-13></a><span class=s2>        g++                           \</span>
<a id=__codelineno-59-14 name=__codelineno-59-14 href=#__codelineno-59-14></a><span class=s2>        make                          \</span>
<a id=__codelineno-59-15 name=__codelineno-59-15 href=#__codelineno-59-15></a><span class=s2>        pkg-config&quot;</span>
<a id=__codelineno-59-16 name=__codelineno-59-16 href=#__codelineno-59-16></a>
<a id=__codelineno-59-17 name=__codelineno-59-17 href=#__codelineno-59-17></a><span class=k>ARG</span><span class=w> </span><span class=nv>DEPENDENCIES</span><span class=o>=</span><span class=s2>&quot;                    \</span>
<a id=__codelineno-59-18 name=__codelineno-59-18 href=#__codelineno-59-18></a><span class=s2>        libxml2                       \</span>
<a id=__codelineno-59-19 name=__codelineno-59-19 href=#__codelineno-59-19></a><span class=s2>        libxml2-dev                   \</span>
<a id=__codelineno-59-20 name=__codelineno-59-20 href=#__codelineno-59-20></a><span class=s2>        libxslt1-dev                  \</span>
<a id=__codelineno-59-21 name=__codelineno-59-21 href=#__codelineno-59-21></a><span class=s2>        libffi-dev                    \</span>
<a id=__codelineno-59-22 name=__codelineno-59-22 href=#__codelineno-59-22></a><span class=s2>        libssl-dev                    \</span>
<a id=__codelineno-59-23 name=__codelineno-59-23 href=#__codelineno-59-23></a><span class=s2>        zlib1g-dev&quot;</span>
<a id=__codelineno-59-24 name=__codelineno-59-24 href=#__codelineno-59-24></a>
<a id=__codelineno-59-25 name=__codelineno-59-25 href=#__codelineno-59-25></a><span class=k>ARG</span><span class=w> </span><span class=nv>TOOLS</span><span class=o>=</span><span class=s2>&quot;                           \</span>
<a id=__codelineno-59-26 name=__codelineno-59-26 href=#__codelineno-59-26></a><span class=s2>        sudo                          \</span>
<a id=__codelineno-59-27 name=__codelineno-59-27 href=#__codelineno-59-27></a><span class=s2>        ca-certificates               \</span>
<a id=__codelineno-59-28 name=__codelineno-59-28 href=#__codelineno-59-28></a><span class=s2>        bash-completion               \</span>
<a id=__codelineno-59-29 name=__codelineno-59-29 href=#__codelineno-59-29></a><span class=s2>        cron                          \</span>
<a id=__codelineno-59-30 name=__codelineno-59-30 href=#__codelineno-59-30></a><span class=s2>        curl                          \</span>
<a id=__codelineno-59-31 name=__codelineno-59-31 href=#__codelineno-59-31></a><span class=s2>        default-libmysqlclient-dev    \</span>
<a id=__codelineno-59-32 name=__codelineno-59-32 href=#__codelineno-59-32></a><span class=s2>        default-mysql-client          \</span>
<a id=__codelineno-59-33 name=__codelineno-59-33 href=#__codelineno-59-33></a><span class=s2>        git                           \</span>
<a id=__codelineno-59-34 name=__codelineno-59-34 href=#__codelineno-59-34></a><span class=s2>        zsh                           \</span>
<a id=__codelineno-59-35 name=__codelineno-59-35 href=#__codelineno-59-35></a><span class=s2>        git-lfs                       \</span>
<a id=__codelineno-59-36 name=__codelineno-59-36 href=#__codelineno-59-36></a><span class=s2>        iputils-ping                  \</span>
<a id=__codelineno-59-37 name=__codelineno-59-37 href=#__codelineno-59-37></a><span class=s2>        locales                       \</span>
<a id=__codelineno-59-38 name=__codelineno-59-38 href=#__codelineno-59-38></a><span class=s2>        logrotate                     \</span>
<a id=__codelineno-59-39 name=__codelineno-59-39 href=#__codelineno-59-39></a><span class=s2>        dumb-init                     \</span>
<a id=__codelineno-59-40 name=__codelineno-59-40 href=#__codelineno-59-40></a><span class=s2>        net-tools                     \</span>
<a id=__codelineno-59-41 name=__codelineno-59-41 href=#__codelineno-59-41></a><span class=s2>        openssl                       \</span>
<a id=__codelineno-59-42 name=__codelineno-59-42 href=#__codelineno-59-42></a><span class=s2>        openssh-client                \</span>
<a id=__codelineno-59-43 name=__codelineno-59-43 href=#__codelineno-59-43></a><span class=s2>        procps                        \</span>
<a id=__codelineno-59-44 name=__codelineno-59-44 href=#__codelineno-59-44></a><span class=s2>        telnet                        \</span>
<a id=__codelineno-59-45 name=__codelineno-59-45 href=#__codelineno-59-45></a><span class=s2>        unzip                         \</span>
<a id=__codelineno-59-46 name=__codelineno-59-46 href=#__codelineno-59-46></a><span class=s2>        vim                           \</span>
<a id=__codelineno-59-47 name=__codelineno-59-47 href=#__codelineno-59-47></a><span class=s2>        wget&quot;</span>
<a id=__codelineno-59-48 name=__codelineno-59-48 href=#__codelineno-59-48></a>
<a id=__codelineno-59-49 name=__codelineno-59-49 href=#__codelineno-59-49></a>
<a id=__codelineno-59-50 name=__codelineno-59-50 href=#__codelineno-59-50></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-ux<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-51 name=__codelineno-59-51 href=#__codelineno-59-51></a><span class=w>  </span>sed<span class=w> </span>-i<span class=w> </span><span class=s1>&#39;s/http:\/\/archive.ubuntu.com\/ubuntu\//http:\/\/mirrors.aliyun.com\/ubuntu\//g&#39;</span><span class=w> </span>/etc/apt/sources.list<span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-52 name=__codelineno-59-52 href=#__codelineno-59-52></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>ln<span class=w> </span>-sf<span class=w> </span>/usr/share/zoneinfo/Asia/Shanghai<span class=w> </span>/etc/localtime<span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-53 name=__codelineno-59-53 href=#__codelineno-59-53></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-54 name=__codelineno-59-54 href=#__codelineno-59-54></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>-y<span class=w> </span>install<span class=w> </span>--no-install-recommends<span class=w> </span><span class=si>${</span><span class=nv>BUILD_DEPENDENCIES</span><span class=si>}</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-55 name=__codelineno-59-55 href=#__codelineno-59-55></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>-y<span class=w> </span>install<span class=w> </span>--no-install-recommends<span class=w> </span><span class=si>${</span><span class=nv>DEPENDENCIES</span><span class=si>}</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-56 name=__codelineno-59-56 href=#__codelineno-59-56></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>-y<span class=w> </span>install<span class=w> </span>--no-install-recommends<span class=w> </span><span class=si>${</span><span class=nv>TOOLS</span><span class=si>}</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-57 name=__codelineno-59-57 href=#__codelineno-59-57></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>clean<span class=w> </span>all<span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-58 name=__codelineno-59-58 href=#__codelineno-59-58></a><span class=w>  </span><span class=o>&amp;&amp;</span><span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>/var/lib/apt/lists/*
<a id=__codelineno-59-59 name=__codelineno-59-59 href=#__codelineno-59-59></a>
<a id=__codelineno-59-60 name=__codelineno-59-60 href=#__codelineno-59-60></a><span class=k>RUN</span><span class=w> </span>chsh<span class=w> </span>-s<span class=w> </span>/bin/bash
<a id=__codelineno-59-61 name=__codelineno-59-61 href=#__codelineno-59-61></a><span class=k>ENV</span><span class=w> </span><span class=nv>SHELL</span><span class=o>=</span>/bin/bash
<a id=__codelineno-59-62 name=__codelineno-59-62 href=#__codelineno-59-62></a>
<a id=__codelineno-59-63 name=__codelineno-59-63 href=#__codelineno-59-63></a>
<a id=__codelineno-59-64 name=__codelineno-59-64 href=#__codelineno-59-64></a><span class=c># fixuid</span>
<a id=__codelineno-59-65 name=__codelineno-59-65 href=#__codelineno-59-65></a><span class=k>ADD</span><span class=w> </span>fixuid-0.5.1-linux-amd64.tar.gz<span class=w> </span>/usr/local/bin/
<a id=__codelineno-59-66 name=__codelineno-59-66 href=#__codelineno-59-66></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-ux<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-67 name=__codelineno-59-67 href=#__codelineno-59-67></a><span class=w>  </span>chown<span class=w> </span>root:root<span class=w> </span>/usr/local/bin/fixuid<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-68 name=__codelineno-59-68 href=#__codelineno-59-68></a><span class=w>  </span>chmod<span class=w> </span><span class=m>4755</span><span class=w> </span>/usr/local/bin/fixuid<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-69 name=__codelineno-59-69 href=#__codelineno-59-69></a><span class=w>  </span>mkdir<span class=w> </span>-p<span class=w> </span>/etc/fixuid<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-70 name=__codelineno-59-70 href=#__codelineno-59-70></a><span class=w>  </span><span class=nb>printf</span><span class=w> </span><span class=s2>&quot;user: coder\ngroup: coder\n&quot;</span><span class=w> </span>&gt;<span class=w> </span>/etc/fixuid/config.yml
<a id=__codelineno-59-71 name=__codelineno-59-71 href=#__codelineno-59-71></a>
<a id=__codelineno-59-72 name=__codelineno-59-72 href=#__codelineno-59-72></a>
<a id=__codelineno-59-73 name=__codelineno-59-73 href=#__codelineno-59-73></a><span class=c># code_server</span>
<a id=__codelineno-59-74 name=__codelineno-59-74 href=#__codelineno-59-74></a><span class=k>COPY</span><span class=w> </span>code-server_4.13.0_amd64.deb<span class=w> </span>/tmp/
<a id=__codelineno-59-75 name=__codelineno-59-75 href=#__codelineno-59-75></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-ux<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-76 name=__codelineno-59-76 href=#__codelineno-59-76></a><span class=w>  </span><span class=nb>cd</span><span class=w> </span>/tmp/<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-77 name=__codelineno-59-77 href=#__codelineno-59-77></a><span class=w>  </span>sudo<span class=w> </span>dpkg<span class=w> </span>-i<span class=w> </span>code-server_4.13.0_amd64.deb<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-78 name=__codelineno-59-78 href=#__codelineno-59-78></a><span class=w>  </span>rm<span class=w> </span>-rf<span class=w> </span>code-server_4.13.0_amd64.deb
<a id=__codelineno-59-79 name=__codelineno-59-79 href=#__codelineno-59-79></a>
<a id=__codelineno-59-80 name=__codelineno-59-80 href=#__codelineno-59-80></a>
<a id=__codelineno-59-81 name=__codelineno-59-81 href=#__codelineno-59-81></a>
<a id=__codelineno-59-82 name=__codelineno-59-82 href=#__codelineno-59-82></a><span class=c># add user</span>
<a id=__codelineno-59-83 name=__codelineno-59-83 href=#__codelineno-59-83></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-ux<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-84 name=__codelineno-59-84 href=#__codelineno-59-84></a><span class=w>  </span>adduser<span class=w> </span>--disabled-password<span class=w> </span>--gecos<span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span>coder<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-85 name=__codelineno-59-85 href=#__codelineno-59-85></a><span class=w>  </span>adduser<span class=w> </span>coder<span class=w> </span>sudo<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-86 name=__codelineno-59-86 href=#__codelineno-59-86></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span><span class=s1>&#39;%sudo ALL=(ALL) NOPASSWD:ALL&#39;</span><span class=w> </span>&gt;&gt;<span class=w> </span>/etc/sudoers<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-87 name=__codelineno-59-87 href=#__codelineno-59-87></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;root:P@ssw0rd&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>chpasswd<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-88 name=__codelineno-59-88 href=#__codelineno-59-88></a><span class=w>  </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;coder:oschina&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>chpasswd<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-89 name=__codelineno-59-89 href=#__codelineno-59-89></a><span class=w>  </span>locale-gen<span class=w> </span>en_US.UTF-8
<a id=__codelineno-59-90 name=__codelineno-59-90 href=#__codelineno-59-90></a>
<a id=__codelineno-59-91 name=__codelineno-59-91 href=#__codelineno-59-91></a>
<a id=__codelineno-59-92 name=__codelineno-59-92 href=#__codelineno-59-92></a><span class=c># add workspace</span>
<a id=__codelineno-59-93 name=__codelineno-59-93 href=#__codelineno-59-93></a><span class=k>RUN</span><span class=w> </span>chmod<span class=w> </span>g+rw<span class=w> </span>/home<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-94 name=__codelineno-59-94 href=#__codelineno-59-94></a><span class=w>  </span>mkdir<span class=w> </span>-p<span class=w> </span>/home/coder/workspace<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-95 name=__codelineno-59-95 href=#__codelineno-59-95></a><span class=w>  </span>mkdir<span class=w> </span>-p<span class=w> </span>/home/coder/.local<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-96 name=__codelineno-59-96 href=#__codelineno-59-96></a><span class=w>  </span>chown<span class=w> </span>-R<span class=w> </span>coder:coder<span class=w> </span>/home/coder<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-97 name=__codelineno-59-97 href=#__codelineno-59-97></a><span class=w>  </span>chown<span class=w> </span>-R<span class=w> </span>coder:coder<span class=w> </span>/home/coder/.local<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-98 name=__codelineno-59-98 href=#__codelineno-59-98></a><span class=w>  </span>chown<span class=w> </span>-R<span class=w> </span>coder:coder<span class=w> </span>/home/coder/workspace<span class=p>;</span>
<a id=__codelineno-59-99 name=__codelineno-59-99 href=#__codelineno-59-99></a>
<a id=__codelineno-59-100 name=__codelineno-59-100 href=#__codelineno-59-100></a>
<a id=__codelineno-59-101 name=__codelineno-59-101 href=#__codelineno-59-101></a><span class=k>ENV</span><span class=w> </span><span class=nv>PASSWORD</span><span class=o>=</span><span class=si>${</span><span class=nv>PASSWORD</span><span class=k>:-</span><span class=nv>P</span><span class=p>@ssw0rd</span><span class=si>}</span>
<a id=__codelineno-59-102 name=__codelineno-59-102 href=#__codelineno-59-102></a>
<a id=__codelineno-59-103 name=__codelineno-59-103 href=#__codelineno-59-103></a>
<a id=__codelineno-59-104 name=__codelineno-59-104 href=#__codelineno-59-104></a><span class=c># kubectl and helm</span>
<a id=__codelineno-59-105 name=__codelineno-59-105 href=#__codelineno-59-105></a><span class=k>RUN</span><span class=w> </span>curl<span class=w> </span>-LO<span class=w> </span><span class=s2>&quot;https://storage.googleapis.com/kubernetes-release/release/v1.21.1/bin/linux/amd64/kubectl&quot;</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-106 name=__codelineno-59-106 href=#__codelineno-59-106></a><span class=w>  </span>chmod<span class=w> </span><span class=m>755</span><span class=w> </span>./kubectl<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-107 name=__codelineno-59-107 href=#__codelineno-59-107></a><span class=w>  </span>mv<span class=w> </span>./kubectl<span class=w> </span>/usr/bin/<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-108 name=__codelineno-59-108 href=#__codelineno-59-108></a><span class=w>  </span><span class=nv>HELM_VERSION</span><span class=o>=</span>v3.8.0<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-109 name=__codelineno-59-109 href=#__codelineno-59-109></a><span class=w>  </span>curl<span class=w> </span>-sSL<span class=w> </span><span class=s2>&quot;https://mirrors.huaweicloud.com/helm/</span><span class=si>${</span><span class=nv>HELM_VERSION</span><span class=si>}</span><span class=s2>/helm-</span><span class=si>${</span><span class=nv>HELM_VERSION</span><span class=si>}</span><span class=s2>-linux-amd64.tar.gz&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>tar<span class=w> </span>-xzf<span class=w> </span>-<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-110 name=__codelineno-59-110 href=#__codelineno-59-110></a><span class=w>  </span>mv<span class=w> </span>./linux-amd64/helm<span class=w>  </span>/usr/bin/
<a id=__codelineno-59-111 name=__codelineno-59-111 href=#__codelineno-59-111></a>
<a id=__codelineno-59-112 name=__codelineno-59-112 href=#__codelineno-59-112></a>
<a id=__codelineno-59-113 name=__codelineno-59-113 href=#__codelineno-59-113></a><span class=k>USER</span><span class=w> </span><span class=s>coder</span>
<a id=__codelineno-59-114 name=__codelineno-59-114 href=#__codelineno-59-114></a>
<a id=__codelineno-59-115 name=__codelineno-59-115 href=#__codelineno-59-115></a>
<a id=__codelineno-59-116 name=__codelineno-59-116 href=#__codelineno-59-116></a><span class=c># fzf</span>
<a id=__codelineno-59-117 name=__codelineno-59-117 href=#__codelineno-59-117></a><span class=k>COPY</span><span class=w> </span>--chown<span class=o>=</span><span class=m>1000</span>:1000<span class=w> </span>fzf<span class=w> </span>/home/coder/.fzf
<a id=__codelineno-59-118 name=__codelineno-59-118 href=#__codelineno-59-118></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-ux<span class=p>;</span><span class=se>\</span>
<a id=__codelineno-59-119 name=__codelineno-59-119 href=#__codelineno-59-119></a><span class=w>  </span>/home/coder/.fzf/install
<a id=__codelineno-59-120 name=__codelineno-59-120 href=#__codelineno-59-120></a>
<a id=__codelineno-59-121 name=__codelineno-59-121 href=#__codelineno-59-121></a>
<a id=__codelineno-59-122 name=__codelineno-59-122 href=#__codelineno-59-122></a><span class=k>COPY</span><span class=w> </span>./extensions<span class=w> </span>/home/coder/.local/extensions
<a id=__codelineno-59-123 name=__codelineno-59-123 href=#__codelineno-59-123></a>
<a id=__codelineno-59-124 name=__codelineno-59-124 href=#__codelineno-59-124></a>
<a id=__codelineno-59-125 name=__codelineno-59-125 href=#__codelineno-59-125></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-eux<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-126 name=__codelineno-59-126 href=#__codelineno-59-126></a><span class=w>  </span>python3<span class=w> </span>-m<span class=w> </span>pip<span class=w> </span>install<span class=w> </span>-U<span class=w> </span>pip<span class=w> </span>setuptools<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-127 name=__codelineno-59-127 href=#__codelineno-59-127></a><span class=w>  </span>python3<span class=w> </span>-m<span class=w> </span>pip<span class=w> </span>install<span class=w> </span>requests<span class=w> </span>autopep8<span class=w> </span>-i<span class=w>  </span>https://mirrors.aliyun.com/pypi/simple
<a id=__codelineno-59-128 name=__codelineno-59-128 href=#__codelineno-59-128></a>
<a id=__codelineno-59-129 name=__codelineno-59-129 href=#__codelineno-59-129></a>
<a id=__codelineno-59-130 name=__codelineno-59-130 href=#__codelineno-59-130></a>
<a id=__codelineno-59-131 name=__codelineno-59-131 href=#__codelineno-59-131></a><span class=k>COPY</span><span class=w> </span>entrypoint.sh<span class=w> </span>/home/coder/.local/entrypoint.sh
<a id=__codelineno-59-132 name=__codelineno-59-132 href=#__codelineno-59-132></a><span class=k>COPY</span><span class=w> </span>settings.json<span class=w> </span>/home/coder/.local/share/code-server/User/settings.json
<a id=__codelineno-59-133 name=__codelineno-59-133 href=#__codelineno-59-133></a>
<a id=__codelineno-59-134 name=__codelineno-59-134 href=#__codelineno-59-134></a>
<a id=__codelineno-59-135 name=__codelineno-59-135 href=#__codelineno-59-135></a><span class=k>RUN</span><span class=w> </span><span class=nb>set</span><span class=w> </span>-eux<span class=p>;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-136 name=__codelineno-59-136 href=#__codelineno-59-136></a><span class=w>  </span>sudo<span class=w> </span>chmod<span class=w> </span>+x<span class=w> </span>/home/coder/.local/entrypoint.sh<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-137 name=__codelineno-59-137 href=#__codelineno-59-137></a><span class=w>  </span>sudo<span class=w> </span>chown<span class=w> </span>coder<span class=w> </span>/home/coder/.local/share/code-server/User/settings.json<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-59-138 name=__codelineno-59-138 href=#__codelineno-59-138></a><span class=w>  </span>sudo<span class=w> </span>sed<span class=w> </span>-i<span class=w> </span><span class=s1>&#39;s/.*NOPASSWD:*/#&amp;/g&#39;</span><span class=w> </span>/etc/sudoers
<a id=__codelineno-59-139 name=__codelineno-59-139 href=#__codelineno-59-139></a>
<a id=__codelineno-59-140 name=__codelineno-59-140 href=#__codelineno-59-140></a>
<a id=__codelineno-59-141 name=__codelineno-59-141 href=#__codelineno-59-141></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/home/coder/workspace</span>
<a id=__codelineno-59-142 name=__codelineno-59-142 href=#__codelineno-59-142></a>
<a id=__codelineno-59-143 name=__codelineno-59-143 href=#__codelineno-59-143></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>8080</span>
<a id=__codelineno-59-144 name=__codelineno-59-144 href=#__codelineno-59-144></a>
<a id=__codelineno-59-145 name=__codelineno-59-145 href=#__codelineno-59-145></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;/bin/sh&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;/home/coder/.local/entrypoint.sh&quot;</span><span class=p>]</span>
</code></pre></div> </div> </div> </div> <h3 id=312-添加healthcheck>3.12 添加HEALTHCHECK<a class=headerlink href=#312-添加healthcheck title="Permanent link">&para;</a></h3> <p>运行容器时，可以指定—restart always选项。</p> <p>这样的话，容器崩溃时，Docker守护进程(docker daemon)会重启容器。对于需要长时间运行的容器，这个选项非常有用。</p> <p>但是，如果容器的确在运行，但是不可(陷入死循环，配置错误)用怎么办？</p> <p>使用HEALTHCHECK指令可以让Docker周期性的检查容器的健康状况。我们只需要指定一个命令，如果一切正常的话返回0，否则返回1。</p> <p>对HEALTHCHECK感兴趣的话，可以参考这篇博客。示例如下：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=k>FROM</span><span class=w> </span><span class=s>node:7-alpine</span><span class=w>  </span>
<a id=__codelineno-60-2 name=__codelineno-60-2 href=#__codelineno-60-2></a><span class=k>LABEL</span><span class=w> </span><span class=k>maintainer</span><span class=w> </span><span class=s>&quot;jakub.skalecki@example.com&quot;</span>
<a id=__codelineno-60-3 name=__codelineno-60-3 href=#__codelineno-60-3></a><span class=k>ENV</span><span class=w> </span><span class=nv>PROJECT_DIR</span><span class=o>=</span>/app<span class=w>  </span>
<a id=__codelineno-60-4 name=__codelineno-60-4 href=#__codelineno-60-4></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>$PROJECT_DIR</span>
<a id=__codelineno-60-5 name=__codelineno-60-5 href=#__codelineno-60-5></a><span class=k>COPY</span><span class=w> </span>package.json<span class=w> </span><span class=nv>$PROJECT_DIR</span><span class=w>  </span>
<a id=__codelineno-60-6 name=__codelineno-60-6 href=#__codelineno-60-6></a><span class=k>RUN</span><span class=w> </span>npm<span class=w> </span>install<span class=w>  </span>
<a id=__codelineno-60-7 name=__codelineno-60-7 href=#__codelineno-60-7></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span><span class=nv>$PROJECT_DIR</span>
<a id=__codelineno-60-8 name=__codelineno-60-8 href=#__codelineno-60-8></a><span class=k>ENV</span><span class=w> </span><span class=nv>MEDIA_DIR</span><span class=o>=</span>/media<span class=w> </span><span class=se>\ </span><span class=w> </span>
<a id=__codelineno-60-9 name=__codelineno-60-9 href=#__codelineno-60-9></a><span class=w>    </span><span class=nv>NODE_ENV</span><span class=o>=</span>production<span class=w> </span><span class=se>\</span>
<a id=__codelineno-60-10 name=__codelineno-60-10 href=#__codelineno-60-10></a><span class=w>    </span><span class=nv>APP_PORT</span><span class=o>=</span><span class=m>3000</span>
<a id=__codelineno-60-11 name=__codelineno-60-11 href=#__codelineno-60-11></a><span class=k>VOLUME</span><span class=w> </span><span class=s>$MEDIA_DIR  </span>
<a id=__codelineno-60-12 name=__codelineno-60-12 href=#__codelineno-60-12></a><span class=k>EXPOSE</span><span class=w> </span><span class=s>$APP_PORT  </span>
<a id=__codelineno-60-13 name=__codelineno-60-13 href=#__codelineno-60-13></a><span class=k>HEALTHCHECK</span><span class=w> </span><span class=k>CMD</span><span class=w> </span>curl<span class=w> </span>--fail<span class=w> </span>http://localhost:<span class=nv>$APP_PORT</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=nb>exit</span><span class=w> </span><span class=m>1</span>
<a id=__codelineno-60-14 name=__codelineno-60-14 href=#__codelineno-60-14></a><span class=k>ENTRYPOINT</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;./entrypoint.sh&quot;</span><span class=p>]</span><span class=w>  </span>
<a id=__codelineno-60-15 name=__codelineno-60-15 href=#__codelineno-60-15></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;start&quot;</span><span class=p>]</span>
</code></pre></div> <h3 id=313-dockerfile优化实例>3.13 Dockerfile优化实例<a class=headerlink href=#313-dockerfile优化实例 title="Permanent link">&para;</a></h3> <p>下面以Dockerfile内容为基础，按照检查项进行逐步优化。该Dockerfile的内容如下：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=k>FROM</span><span class=w> </span><span class=s>RHEL</span>
<a id=__codelineno-61-2 name=__codelineno-61-2 href=#__codelineno-61-2></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>/mywebapp
<a id=__codelineno-61-3 name=__codelineno-61-3 href=#__codelineno-61-3></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update
<a id=__codelineno-61-4 name=__codelineno-61-4 href=#__codelineno-61-4></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>upgrade<span class=w> </span>-y
<a id=__codelineno-61-5 name=__codelineno-61-5 href=#__codelineno-61-5></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>tomcat<span class=w> </span>ssh<span class=w> </span>MySQL
<a id=__codelineno-61-6 name=__codelineno-61-6 href=#__codelineno-61-6></a><span class=k>RUN</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>/app<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>npm<span class=w> </span>install
<a id=__codelineno-61-7 name=__codelineno-61-7 href=#__codelineno-61-7></a><span class=k>CMD</span><span class=w> </span>MySQL<span class=w> </span><span class=p>&amp;</span><span class=w> </span>sshd<span class=w> </span><span class=p>&amp;</span><span class=w> </span>npm<span class=w> </span>start
</code></pre></div> <p>1）编写.dockerignore文件。.dockerignore 的作用和语法类似于 .gitignore ，用来忽略一些不需要的文件，这样可以有效加快镜像构建时间，同时减少 Docker 镜像的大小。</p> <p>示例如下： <div class=highlight><pre><span></span><code><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a>.git/
</code></pre></div></p> <p>2）容器只运行单个应用。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=k>FROM</span><span class=w> </span><span class=s>RHEL</span>
<a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>/mywebapp
<a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update
<a id=__codelineno-63-4 name=__codelineno-63-4 href=#__codelineno-63-4></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>upgrade<span class=w> </span>-y
<a id=__codelineno-63-5 name=__codelineno-63-5 href=#__codelineno-63-5></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>tomcat<span class=w>    </span>#ssh<span class=w> </span>MySQL
<a id=__codelineno-63-6 name=__codelineno-63-6 href=#__codelineno-63-6></a><span class=k>RUN</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>/app<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>npm<span class=w> </span>install
<a id=__codelineno-63-7 name=__codelineno-63-7 href=#__codelineno-63-7></a><span class=k>CMD</span><span class=w> </span>MySQL<span class=w> </span><span class=p>&amp;</span><span class=w> </span>sshd<span class=w> </span><span class=p>&amp;</span><span class=w> </span>npm<span class=w> </span>start
</code></pre></div> <p>3）run指令合并。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=k>FROM</span><span class=w> </span><span class=s>RHEL</span>
<a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>/mywebapp
<a id=__codelineno-64-3 name=__codelineno-64-3 href=#__codelineno-64-3></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-64-4 name=__codelineno-64-4 href=#__codelineno-64-4></a><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>upgrade<span class=w> </span>-y<span class=w> </span><span class=se>\</span>
<a id=__codelineno-64-5 name=__codelineno-64-5 href=#__codelineno-64-5></a><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>tomcat<span class=w> </span><span class=se>\ </span><span class=w>  </span>#ssh<span class=w> </span>MySQL
<a id=__codelineno-64-6 name=__codelineno-64-6 href=#__codelineno-64-6></a><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>/app<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>npm<span class=w> </span>install
</code></pre></div> <p>4）基础镜像的标签不要用latest。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a><span class=k>FROM</span><span class=w> </span><span class=s>RHEL:7.4</span>
<a id=__codelineno-65-2 name=__codelineno-65-2 href=#__codelineno-65-2></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>/mywebapp
<a id=__codelineno-65-3 name=__codelineno-65-3 href=#__codelineno-65-3></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-65-4 name=__codelineno-65-4 href=#__codelineno-65-4></a><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>upgrade<span class=w> </span>-y<span class=w> </span><span class=se>\</span>
<a id=__codelineno-65-5 name=__codelineno-65-5 href=#__codelineno-65-5></a><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>tomcat<span class=w> </span><span class=se>\ </span><span class=w>  </span>#ssh<span class=w> </span>MySQL
<a id=__codelineno-65-6 name=__codelineno-65-6 href=#__codelineno-65-6></a><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>/app<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>npm<span class=w> </span>install
</code></pre></div> <p>5）设置默认工作目录。</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a><span class=k>FROM</span><span class=w> </span><span class=s>RHEL:7.4</span>
<a id=__codelineno-66-2 name=__codelineno-66-2 href=#__codelineno-66-2></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/mywebapp</span>
<a id=__codelineno-66-3 name=__codelineno-66-3 href=#__codelineno-66-3></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>/mywebapp
<a id=__codelineno-66-4 name=__codelineno-66-4 href=#__codelineno-66-4></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-66-5 name=__codelineno-66-5 href=#__codelineno-66-5></a><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>upgrade<span class=w> </span>-y<span class=w> </span><span class=se>\</span>
<a id=__codelineno-66-6 name=__codelineno-66-6 href=#__codelineno-66-6></a><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>tomcat<span class=w> </span><span class=se>\ </span><span class=w>  </span>#ssh<span class=w> </span>MySQL
<a id=__codelineno-66-7 name=__codelineno-66-7 href=#__codelineno-66-7></a><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>/app<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>npm<span class=w> </span>install
</code></pre></div> 6）设置环境变量。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a><span class=k>FROM</span><span class=w> </span><span class=s>RHEL:7.4</span>
<a id=__codelineno-67-2 name=__codelineno-67-2 href=#__codelineno-67-2></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/mywebapp</span>
<a id=__codelineno-67-3 name=__codelineno-67-3 href=#__codelineno-67-3></a><span class=k>ADD</span><span class=w> </span>.<span class=w> </span>/mywebapp
<a id=__codelineno-67-4 name=__codelineno-67-4 href=#__codelineno-67-4></a><span class=k>RUN</span><span class=w> </span>apt-get<span class=w> </span>update<span class=w> </span><span class=se>\</span>
<a id=__codelineno-67-5 name=__codelineno-67-5 href=#__codelineno-67-5></a><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>upgrade<span class=w> </span>-y<span class=w> </span><span class=se>\</span>
<a id=__codelineno-67-6 name=__codelineno-67-6 href=#__codelineno-67-6></a><span class=o>&amp;&amp;</span><span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>tomcat<span class=w> </span><span class=se>\ </span><span class=w>  </span>#ssh<span class=w> </span>MySQL
<a id=__codelineno-67-7 name=__codelineno-67-7 href=#__codelineno-67-7></a><span class=k>ENV</span><span class=w>  </span><span class=nv>HOST</span><span class=o>=</span><span class=m>10</span>.47.43.1<span class=w> </span><span class=se>\</span>
<a id=__codelineno-67-8 name=__codelineno-67-8 href=#__codelineno-67-8></a><span class=w>    </span><span class=nv>PORT</span><span class=o>=</span><span class=m>8080</span>
</code></pre></div> <h2 id=4buildkit>4.BuildKit<a class=headerlink href=#4buildkit title="Permanent link">&para;</a></h2> <p>简单的说就是：</p> <p>BuildKit或DOCKER_BUILDKIT=1 特性可以将docker build完成的数据输出到本地</p> <p>基于BuildKit优化Dockerfile的构建</p> <blockquote> <p><a href=https://mp.weixin.qq.com/s/OjeQsalkthe-YksIe0HtVg>https://mp.weixin.qq.com/s/OjeQsalkthe-YksIe0HtVg</a> </p> </blockquote> <h3 id=41-安装buildx>4.1 安装buildx<a class=headerlink href=#41-安装buildx title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a><span class=c1># Buildx 0.6+</span>
<a id=__codelineno-68-2 name=__codelineno-68-2 href=#__codelineno-68-2></a>$<span class=w> </span>docker<span class=w> </span>buildx<span class=w> </span>bake<span class=w> </span><span class=s2>&quot;https://github.com/docker/buildx.git&quot;</span>
<a id=__codelineno-68-3 name=__codelineno-68-3 href=#__codelineno-68-3></a>$<span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>~/.docker/cli-plugins
<a id=__codelineno-68-4 name=__codelineno-68-4 href=#__codelineno-68-4></a>$<span class=w> </span>mv<span class=w> </span>./bin/buildx<span class=w> </span>~/.docker/cli-plugins/docker-buildx
<a id=__codelineno-68-5 name=__codelineno-68-5 href=#__codelineno-68-5></a>
<a id=__codelineno-68-6 name=__codelineno-68-6 href=#__codelineno-68-6></a><span class=c1># Docker 19.03+</span>
<a id=__codelineno-68-7 name=__codelineno-68-7 href=#__codelineno-68-7></a>$<span class=w> </span><span class=nv>DOCKER_BUILDKIT</span><span class=o>=</span><span class=m>1</span><span class=w> </span>docker<span class=w> </span>build<span class=w> </span>--platform<span class=o>=</span><span class=nb>local</span><span class=w> </span>-o<span class=w> </span>.<span class=w> </span><span class=s2>&quot;https://github.com/docker/buildx.git&quot;</span>
<a id=__codelineno-68-8 name=__codelineno-68-8 href=#__codelineno-68-8></a>$<span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>~/.docker/cli-plugins
<a id=__codelineno-68-9 name=__codelineno-68-9 href=#__codelineno-68-9></a>$<span class=w> </span>mv<span class=w> </span>buildx<span class=w> </span>~/.docker/cli-plugins/docker-buildx
<a id=__codelineno-68-10 name=__codelineno-68-10 href=#__codelineno-68-10></a>
<a id=__codelineno-68-11 name=__codelineno-68-11 href=#__codelineno-68-11></a><span class=c1># Local</span>
<a id=__codelineno-68-12 name=__codelineno-68-12 href=#__codelineno-68-12></a>$<span class=w> </span>git<span class=w> </span>clone<span class=w> </span>https://github.com/docker/buildx.git<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>buildx
<a id=__codelineno-68-13 name=__codelineno-68-13 href=#__codelineno-68-13></a>$<span class=w> </span>make<span class=w> </span>install
</code></pre></div> <p>① 第一种方式使用BuildKit特性，设置环境变量</p> <div class=highlight><pre><span></span><code><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a><span class=nv>DOCKER_BUILDKIT</span><span class=o>=</span><span class=m>1</span><span class=w> </span>docker<span class=w> </span>build<span class=w> </span>.
</code></pre></div> <p>下面的示例Dockerfile使用一个单独的阶段来收集要导出的生成文件：</p> <p>示例1 <div class=highlight><pre><span></span><code><a id=__codelineno-70-1 name=__codelineno-70-1 href=#__codelineno-70-1></a>FROM
<a id=__codelineno-70-2 name=__codelineno-70-2 href=#__codelineno-70-2></a>Learn<span class=w> </span>more<span class=w> </span>about<span class=w> </span>the<span class=w> </span><span class=s2>&quot;FROM&quot;</span><span class=w> </span>Dockerfile<span class=w> </span>command.
<a id=__codelineno-70-3 name=__codelineno-70-3 href=#__codelineno-70-3></a><span class=w> </span>golang<span class=w> </span>AS<span class=w> </span>build-stage
<a id=__codelineno-70-4 name=__codelineno-70-4 href=#__codelineno-70-4></a>RUN<span class=w> </span>go<span class=w> </span>get<span class=w> </span>-u<span class=w> </span>github.com/LK4D4/vndr
<a id=__codelineno-70-5 name=__codelineno-70-5 href=#__codelineno-70-5></a>
<a id=__codelineno-70-6 name=__codelineno-70-6 href=#__codelineno-70-6></a>FROM<span class=w> </span>scratch<span class=w> </span>AS<span class=w> </span>export-stage
<a id=__codelineno-70-7 name=__codelineno-70-7 href=#__codelineno-70-7></a>COPY<span class=w> </span>--from<span class=o>=</span>build-stage<span class=w> </span>/go/bin/vndr<span class=w> </span>/
</code></pre></div></p> <p>示例2 <div class=highlight><pre><span></span><code><a id=__codelineno-71-1 name=__codelineno-71-1 href=#__codelineno-71-1></a>FROM<span class=w> </span>nodejs:buster-slimv1.0<span class=w> </span>AS<span class=w> </span>builder
<a id=__codelineno-71-2 name=__codelineno-71-2 href=#__codelineno-71-2></a>MAINTAINER<span class=w> </span><span class=m>1879324764</span>@qq.com
<a id=__codelineno-71-3 name=__codelineno-71-3 href=#__codelineno-71-3></a>
<a id=__codelineno-71-4 name=__codelineno-71-4 href=#__codelineno-71-4></a>COPY<span class=w> </span>sources.list<span class=w> </span>/etc/apt/sources.list
<a id=__codelineno-71-5 name=__codelineno-71-5 href=#__codelineno-71-5></a>COPY<span class=w> </span>gitee-ent-web<span class=w> </span>/home/gitee-ent-web
<a id=__codelineno-71-6 name=__codelineno-71-6 href=#__codelineno-71-6></a>
<a id=__codelineno-71-7 name=__codelineno-71-7 href=#__codelineno-71-7></a>RUN<span class=w> </span><span class=nb>set</span><span class=w> </span>-eux<span class=p>;</span><span class=se>\</span>
<a id=__codelineno-71-8 name=__codelineno-71-8 href=#__codelineno-71-8></a><span class=w>    </span>apt-get<span class=w> </span>update<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-71-9 name=__codelineno-71-9 href=#__codelineno-71-9></a><span class=w>    </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>wget<span class=w> </span>git<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-71-10 name=__codelineno-71-10 href=#__codelineno-71-10></a><span class=w>    </span><span class=nb>cd</span><span class=w> </span>/home/gitee-ent-web<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-71-11 name=__codelineno-71-11 href=#__codelineno-71-11></a><span class=w>    </span>yarn<span class=w> </span>install<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-71-12 name=__codelineno-71-12 href=#__codelineno-71-12></a><span class=w>    </span>yarn<span class=w> </span>run<span class=w> </span>build-i18n<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-71-13 name=__codelineno-71-13 href=#__codelineno-71-13></a><span class=w>    </span>yarn<span class=w> </span>run<span class=w> </span>build-vendor<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-71-14 name=__codelineno-71-14 href=#__codelineno-71-14></a><span class=w>    </span>yarn<span class=w> </span>web:prod-ci-runjs
<a id=__codelineno-71-15 name=__codelineno-71-15 href=#__codelineno-71-15></a>
<a id=__codelineno-71-16 name=__codelineno-71-16 href=#__codelineno-71-16></a>FROM<span class=w> </span>scratch<span class=w> </span>AS<span class=w> </span>export-stage
<a id=__codelineno-71-17 name=__codelineno-71-17 href=#__codelineno-71-17></a>COPY<span class=w> </span>--from<span class=o>=</span>builder<span class=w> </span>/home/gitee-ent-web/dist<span class=w> </span>./dist
</code></pre></div></p> <p>② 第二种方式使用BuildKit特性</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-72-1 name=__codelineno-72-1 href=#__codelineno-72-1></a>docker<span class=w> </span>buildx<span class=w> </span>build<span class=w> </span>-o<span class=w> </span>out<span class=w> </span>.
</code></pre></div> 下面命令会在当前out目录下生成输出的文件，out如果不存在会自动创建</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-73-1 name=__codelineno-73-1 href=#__codelineno-73-1></a><span class=nv>DOCKER_BUILDKIT</span><span class=o>=</span><span class=m>1</span><span class=w> </span>docker<span class=w> </span>build<span class=w> </span>-o<span class=w> </span>out<span class=w> </span>.
</code></pre></div> 或者 <div class=highlight><pre><span></span><code><a id=__codelineno-74-1 name=__codelineno-74-1 href=#__codelineno-74-1></a><span class=c1># 直接使用 docker buildx build 命令构建镜像。</span>
<a id=__codelineno-74-2 name=__codelineno-74-2 href=#__codelineno-74-2></a>docker<span class=w> </span>buildx<span class=w> </span>build<span class=w> </span>-o<span class=w> </span>out<span class=w> </span>.
</code></pre></div></p> <h3 id=42-buildx示例>4.2 buildx示例<a class=headerlink href=#42-buildx示例 title="Permanent link">&para;</a></h3> <p>一个go编译环境的例子 <div class=highlight><pre><span></span><code><a id=__codelineno-75-1 name=__codelineno-75-1 href=#__codelineno-75-1></a>$<span class=w> </span>ls
<a id=__codelineno-75-2 name=__codelineno-75-2 href=#__codelineno-75-2></a>Dockerfile<span class=w>  </span>go.mod<span class=w>  </span>main.go
<a id=__codelineno-75-3 name=__codelineno-75-3 href=#__codelineno-75-3></a>
<a id=__codelineno-75-4 name=__codelineno-75-4 href=#__codelineno-75-4></a>$<span class=w> </span>cat<span class=w> </span>Dockerfile
<a id=__codelineno-75-5 name=__codelineno-75-5 href=#__codelineno-75-5></a>FROM<span class=w> </span>golang:1.12-alpine<span class=w> </span>as<span class=w> </span>dev
<a id=__codelineno-75-6 name=__codelineno-75-6 href=#__codelineno-75-6></a>RUN<span class=w> </span>apk<span class=w> </span>add<span class=w> </span>--no-cache<span class=w> </span>git<span class=w> </span>ca-certificates
<a id=__codelineno-75-7 name=__codelineno-75-7 href=#__codelineno-75-7></a>RUN<span class=w> </span>adduser<span class=w> </span>-D<span class=w> </span>appuser
<a id=__codelineno-75-8 name=__codelineno-75-8 href=#__codelineno-75-8></a>WORKDIR<span class=w> </span>/src
<a id=__codelineno-75-9 name=__codelineno-75-9 href=#__codelineno-75-9></a>COPY<span class=w> </span>.<span class=w> </span>/src/
<a id=__codelineno-75-10 name=__codelineno-75-10 href=#__codelineno-75-10></a>CMD<span class=w> </span><span class=nv>CGO_ENABLED</span><span class=o>=</span><span class=m>0</span><span class=w> </span>go<span class=w> </span>build<span class=w> </span>-o<span class=w> </span>app<span class=w> </span>.<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>./app
<a id=__codelineno-75-11 name=__codelineno-75-11 href=#__codelineno-75-11></a>
<a id=__codelineno-75-12 name=__codelineno-75-12 href=#__codelineno-75-12></a>FROM<span class=w> </span>dev<span class=w> </span>as<span class=w> </span>build
<a id=__codelineno-75-13 name=__codelineno-75-13 href=#__codelineno-75-13></a>RUN<span class=w> </span><span class=nv>CGO_ENABLED</span><span class=o>=</span><span class=m>0</span><span class=w> </span>go<span class=w> </span>build<span class=w> </span>-o<span class=w> </span>app<span class=w> </span>.
<a id=__codelineno-75-14 name=__codelineno-75-14 href=#__codelineno-75-14></a>USER<span class=w> </span>appuser
<a id=__codelineno-75-15 name=__codelineno-75-15 href=#__codelineno-75-15></a>CMD<span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;./app&quot;</span><span class=w> </span><span class=o>]</span>
<a id=__codelineno-75-16 name=__codelineno-75-16 href=#__codelineno-75-16></a>
<a id=__codelineno-75-17 name=__codelineno-75-17 href=#__codelineno-75-17></a>FROM<span class=w> </span>scratch<span class=w> </span>as<span class=w> </span>release
<a id=__codelineno-75-18 name=__codelineno-75-18 href=#__codelineno-75-18></a>COPY<span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/etc/passwd<span class=w> </span>/etc/group<span class=w> </span>/etc/
<a id=__codelineno-75-19 name=__codelineno-75-19 href=#__codelineno-75-19></a>COPY<span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/src/app<span class=w> </span>/app
<a id=__codelineno-75-20 name=__codelineno-75-20 href=#__codelineno-75-20></a>USER<span class=w> </span>appuser
<a id=__codelineno-75-21 name=__codelineno-75-21 href=#__codelineno-75-21></a>CMD<span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;/app&quot;</span><span class=w> </span><span class=o>]</span>
<a id=__codelineno-75-22 name=__codelineno-75-22 href=#__codelineno-75-22></a>
<a id=__codelineno-75-23 name=__codelineno-75-23 href=#__codelineno-75-23></a>FROM<span class=w> </span>scratch<span class=w> </span>as<span class=w> </span>artifact
<a id=__codelineno-75-24 name=__codelineno-75-24 href=#__codelineno-75-24></a>COPY<span class=w> </span>--from<span class=o>=</span>build<span class=w> </span>/src/app<span class=w> </span>/app
<a id=__codelineno-75-25 name=__codelineno-75-25 href=#__codelineno-75-25></a>
<a id=__codelineno-75-26 name=__codelineno-75-26 href=#__codelineno-75-26></a>FROM<span class=w> </span>release
<a id=__codelineno-75-27 name=__codelineno-75-27 href=#__codelineno-75-27></a>$<span class=w> </span><span class=nv>DOCKER_BUILDKIT</span><span class=o>=</span><span class=m>1</span><span class=w> </span>docker<span class=w> </span>build<span class=w> </span>--target<span class=w> </span>artifact<span class=w> </span>--output<span class=w> </span><span class=nv>type</span><span class=o>=</span>local,dest<span class=o>=</span>.<span class=w> </span>.
<a id=__codelineno-75-28 name=__codelineno-75-28 href=#__codelineno-75-28></a>或者
<a id=__codelineno-75-29 name=__codelineno-75-29 href=#__codelineno-75-29></a>$<span class=w> </span>docker<span class=w> </span>buildx<span class=w> </span>build<span class=w>  </span>--output<span class=w> </span><span class=nv>type</span><span class=o>=</span>local,dest<span class=o>=</span>path/to/output-dir
<a id=__codelineno-75-30 name=__codelineno-75-30 href=#__codelineno-75-30></a>After<span class=w> </span>the<span class=w> </span>build<span class=w> </span>was<span class=w> </span><span class=nb>complete</span><span class=w> </span>the<span class=w> </span>app<span class=w> </span>binary<span class=w> </span>was<span class=w> </span>exported:
<a id=__codelineno-75-31 name=__codelineno-75-31 href=#__codelineno-75-31></a>
<a id=__codelineno-75-32 name=__codelineno-75-32 href=#__codelineno-75-32></a>$<span class=w> </span>ls
<a id=__codelineno-75-33 name=__codelineno-75-33 href=#__codelineno-75-33></a>Dockerfile<span class=w>  </span>app<span class=w>  </span>go.mod<span class=w>  </span>main.go
<a id=__codelineno-75-34 name=__codelineno-75-34 href=#__codelineno-75-34></a>
<a id=__codelineno-75-35 name=__codelineno-75-35 href=#__codelineno-75-35></a>$<span class=w> </span>./app
<a id=__codelineno-75-36 name=__codelineno-75-36 href=#__codelineno-75-36></a>Ready<span class=w> </span>to<span class=w> </span>receive<span class=w> </span>requests<span class=w> </span>on<span class=w> </span>port<span class=w> </span><span class=m>8080</span>
</code></pre></div></p> <div class="admonition example"> <p class=admonition-title>参考文献</p> <p><a href=https://www.yuque.com/morlay/me/docker-buildx>https://www.yuque.com/morlay/me/docker-buildx</a></p> <p>参考文献：<a href=https://www.cnblogs.com/yance-dev/p/16499553.html>https://www.cnblogs.com/yance-dev/p/16499553.html</a></p> </div> <h2 id=5dockerfile实践>5.Dockerfile实践<a class=headerlink href=#5dockerfile实践 title="Permanent link">&para;</a></h2> <div class="admonition info"> <p class=admonition-title>Golang/Python应用部署到Docker</p> </div> <h3 id=51-构建nginx基础镜像>5.1 构建Nginx基础镜像<a class=headerlink href=#51-构建nginx基础镜像 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-76-1 name=__codelineno-76-1 href=#__codelineno-76-1></a><span class="l l-Scalar l-Scalar-Plain">FROM centos:7</span>
<a id=__codelineno-76-2 name=__codelineno-76-2 href=#__codelineno-76-2></a><span class="l l-Scalar l-Scalar-Plain">LABEL wenlong</span>
<a id=__codelineno-76-3 name=__codelineno-76-3 href=#__codelineno-76-3></a><span class="l l-Scalar l-Scalar-Plain">RUN yum install -y gcc gcc-c++ make \</span>
<a id=__codelineno-76-4 name=__codelineno-76-4 href=#__codelineno-76-4></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">openssl-devel pcre-devel gd-devel \</span>
<a id=__codelineno-76-5 name=__codelineno-76-5 href=#__codelineno-76-5></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">iproute net-tools telnet wget curl &amp;&amp; \</span>
<a id=__codelineno-76-6 name=__codelineno-76-6 href=#__codelineno-76-6></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">yum clean all &amp;&amp; \</span>
<a id=__codelineno-76-7 name=__codelineno-76-7 href=#__codelineno-76-7></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">rm -rf /var/cache/yum/*</span>
<a id=__codelineno-76-8 name=__codelineno-76-8 href=#__codelineno-76-8></a><span class="l l-Scalar l-Scalar-Plain">RUN wget http://nginx.org/download/nginx-1.15.5.tar.gz &amp;&amp; \</span>
<a id=__codelineno-76-9 name=__codelineno-76-9 href=#__codelineno-76-9></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">tar zxf nginx-1.15.5.tar.gz &amp;&amp; \</span>
<a id=__codelineno-76-10 name=__codelineno-76-10 href=#__codelineno-76-10></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">cd nginx-1.15.5 &amp;&amp; \</span>
<a id=__codelineno-76-11 name=__codelineno-76-11 href=#__codelineno-76-11></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">./configure --prefix=/usr/local/nginx \</span>
<a id=__codelineno-76-12 name=__codelineno-76-12 href=#__codelineno-76-12></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">--with-http_ssl_module \</span>
<a id=__codelineno-76-13 name=__codelineno-76-13 href=#__codelineno-76-13></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">--with-http_stub_status_module &amp;&amp; \</span>
<a id=__codelineno-76-14 name=__codelineno-76-14 href=#__codelineno-76-14></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">make -j 4 &amp;&amp; make install &amp;&amp; \</span>
<a id=__codelineno-76-15 name=__codelineno-76-15 href=#__codelineno-76-15></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">rm -rf /usr/local/nginx/html/* &amp;&amp; \</span>
<a id=__codelineno-76-16 name=__codelineno-76-16 href=#__codelineno-76-16></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;ok&quot; &gt;&gt; /usr/local/nginx/html/status.html &amp;&amp; \</span>
<a id=__codelineno-76-17 name=__codelineno-76-17 href=#__codelineno-76-17></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">cd / &amp;&amp; rm -rf nginx-1.15.5* &amp;&amp; \</span>
<a id=__codelineno-76-18 name=__codelineno-76-18 href=#__codelineno-76-18></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span>
<a id=__codelineno-76-19 name=__codelineno-76-19 href=#__codelineno-76-19></a>
<a id=__codelineno-76-20 name=__codelineno-76-20 href=#__codelineno-76-20></a><span class="l l-Scalar l-Scalar-Plain">ENV PATH $PATH:/usr/local/nginx/sbin</span>
<a id=__codelineno-76-21 name=__codelineno-76-21 href=#__codelineno-76-21></a><span class="l l-Scalar l-Scalar-Plain">COPY nginx.conf /usr/local/nginx/conf/nginx.conf</span>
<a id=__codelineno-76-22 name=__codelineno-76-22 href=#__codelineno-76-22></a><span class="l l-Scalar l-Scalar-Plain">WORKDIR /usr/local/nginx</span>
<a id=__codelineno-76-23 name=__codelineno-76-23 href=#__codelineno-76-23></a><span class="l l-Scalar l-Scalar-Plain">EXPOSE 80</span>
<a id=__codelineno-76-24 name=__codelineno-76-24 href=#__codelineno-76-24></a><span class="l l-Scalar l-Scalar-Plain">CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</span>
</code></pre></div> <h3 id=52-构建php基础镜像>5.2 构建PHP基础镜像<a class=headerlink href=#52-构建php基础镜像 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-77-1 name=__codelineno-77-1 href=#__codelineno-77-1></a><span class="l l-Scalar l-Scalar-Plain">复制代码</span>
<a id=__codelineno-77-2 name=__codelineno-77-2 href=#__codelineno-77-2></a><span class="l l-Scalar l-Scalar-Plain">FROM centos:7</span>
<a id=__codelineno-77-3 name=__codelineno-77-3 href=#__codelineno-77-3></a><span class="l l-Scalar l-Scalar-Plain">LABEL maintainer wenlong</span>
<a id=__codelineno-77-4 name=__codelineno-77-4 href=#__codelineno-77-4></a><span class="l l-Scalar l-Scalar-Plain">RUN yum install epel-release -y &amp;&amp; \</span>
<a id=__codelineno-77-5 name=__codelineno-77-5 href=#__codelineno-77-5></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">yum install -y gcc gcc-c++ make gd-devel libxml2-devel \</span>
<a id=__codelineno-77-6 name=__codelineno-77-6 href=#__codelineno-77-6></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">libcurl-devel libjpeg-devel libpng-devel openssl-devel \</span>
<a id=__codelineno-77-7 name=__codelineno-77-7 href=#__codelineno-77-7></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">libmcrypt-devel libxslt-devel libtidy-devel autoconf \</span>
<a id=__codelineno-77-8 name=__codelineno-77-8 href=#__codelineno-77-8></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">iproute net-tools telnet wget curl &amp;&amp; \</span>
<a id=__codelineno-77-9 name=__codelineno-77-9 href=#__codelineno-77-9></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">yum clean all &amp;&amp; \</span>
<a id=__codelineno-77-10 name=__codelineno-77-10 href=#__codelineno-77-10></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">rm -rf /var/cache/yum/*</span>
<a id=__codelineno-77-11 name=__codelineno-77-11 href=#__codelineno-77-11></a>
<a id=__codelineno-77-12 name=__codelineno-77-12 href=#__codelineno-77-12></a><span class="l l-Scalar l-Scalar-Plain">RUN wget http://docs.php.net/distributions/php-5.6.36.tar.gz &amp;&amp; \</span>
<a id=__codelineno-77-13 name=__codelineno-77-13 href=#__codelineno-77-13></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">tar zxf php-5.6.36.tar.gz &amp;&amp; \</span>
<a id=__codelineno-77-14 name=__codelineno-77-14 href=#__codelineno-77-14></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">cd php-5.6.36 &amp;&amp; \</span>
<a id=__codelineno-77-15 name=__codelineno-77-15 href=#__codelineno-77-15></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">./configure --prefix=/usr/local/php \</span>
<a id=__codelineno-77-16 name=__codelineno-77-16 href=#__codelineno-77-16></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">--with-config-file-path=/usr/local/php/etc \</span>
<a id=__codelineno-77-17 name=__codelineno-77-17 href=#__codelineno-77-17></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">--enable-fpm --enable-opcache \</span>
<a id=__codelineno-77-18 name=__codelineno-77-18 href=#__codelineno-77-18></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">--with-mysql --with-mysqli --with-pdo-mysql \</span>
<a id=__codelineno-77-19 name=__codelineno-77-19 href=#__codelineno-77-19></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">--with-openssl --with-zlib --with-curl --with-gd \</span>
<a id=__codelineno-77-20 name=__codelineno-77-20 href=#__codelineno-77-20></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">--with-jpeg-dir --with-png-dir --with-freetype-dir \</span>
<a id=__codelineno-77-21 name=__codelineno-77-21 href=#__codelineno-77-21></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">--enable-mbstring --with-mcrypt --enable-hash &amp;&amp; \</span>
<a id=__codelineno-77-22 name=__codelineno-77-22 href=#__codelineno-77-22></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">make -j 4 &amp;&amp; make install &amp;&amp; \</span>
<a id=__codelineno-77-23 name=__codelineno-77-23 href=#__codelineno-77-23></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">cp php.ini-production /usr/local/php/etc/php.ini &amp;&amp; \</span>
<a id=__codelineno-77-24 name=__codelineno-77-24 href=#__codelineno-77-24></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">cp sapi/fpm/php-fpm.conf /usr/local/php/etc/php-fpm.conf &amp;&amp; \</span>
<a id=__codelineno-77-25 name=__codelineno-77-25 href=#__codelineno-77-25></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">sed -i &quot;90a \daemonize = no&quot; /usr/local/php/etc/php-fpm.conf &amp;&amp; \</span>
<a id=__codelineno-77-26 name=__codelineno-77-26 href=#__codelineno-77-26></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">mkdir /usr/local/php/log &amp;&amp; \</span>
<a id=__codelineno-77-27 name=__codelineno-77-27 href=#__codelineno-77-27></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">cd / &amp;&amp; rm -rf php* &amp;&amp; \</span>
<a id=__codelineno-77-28 name=__codelineno-77-28 href=#__codelineno-77-28></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span>
<a id=__codelineno-77-29 name=__codelineno-77-29 href=#__codelineno-77-29></a>
<a id=__codelineno-77-30 name=__codelineno-77-30 href=#__codelineno-77-30></a><span class="l l-Scalar l-Scalar-Plain">ENV PATH $PATH:/usr/local/php/sbin</span>
<a id=__codelineno-77-31 name=__codelineno-77-31 href=#__codelineno-77-31></a><span class="l l-Scalar l-Scalar-Plain">COPY php.ini /usr/local/php/etc/</span>
<a id=__codelineno-77-32 name=__codelineno-77-32 href=#__codelineno-77-32></a><span class="l l-Scalar l-Scalar-Plain">COPY php-fpm.conf /usr/local/php/etc/</span>
<a id=__codelineno-77-33 name=__codelineno-77-33 href=#__codelineno-77-33></a><span class="l l-Scalar l-Scalar-Plain">WORKDIR /usr/local/php</span>
<a id=__codelineno-77-34 name=__codelineno-77-34 href=#__codelineno-77-34></a><span class="l l-Scalar l-Scalar-Plain">EXPOSE 9000</span>
<a id=__codelineno-77-35 name=__codelineno-77-35 href=#__codelineno-77-35></a><span class="l l-Scalar l-Scalar-Plain">CMD [&quot;php-fpm&quot;]</span>
</code></pre></div> <h3 id=53-构建tomcat基础镜像>5.3 构建Tomcat基础镜像<a class=headerlink href=#53-构建tomcat基础镜像 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-78-1 name=__codelineno-78-1 href=#__codelineno-78-1></a><span class="l l-Scalar l-Scalar-Plain">FROM centos:7</span>
<a id=__codelineno-78-2 name=__codelineno-78-2 href=#__codelineno-78-2></a><span class="l l-Scalar l-Scalar-Plain">LABEL maintainer wenlong</span>
<a id=__codelineno-78-3 name=__codelineno-78-3 href=#__codelineno-78-3></a>
<a id=__codelineno-78-4 name=__codelineno-78-4 href=#__codelineno-78-4></a><span class="l l-Scalar l-Scalar-Plain">ENV VERSION=8.0.52</span>
<a id=__codelineno-78-5 name=__codelineno-78-5 href=#__codelineno-78-5></a>
<a id=__codelineno-78-6 name=__codelineno-78-6 href=#__codelineno-78-6></a><span class="l l-Scalar l-Scalar-Plain">RUN yum install java-1.8.0-openjdk wget curl unzip iproute net-tools -y &amp;&amp; \</span>
<a id=__codelineno-78-7 name=__codelineno-78-7 href=#__codelineno-78-7></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">yum clean all &amp;&amp; \</span>
<a id=__codelineno-78-8 name=__codelineno-78-8 href=#__codelineno-78-8></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">rm -rf /var/cache/yum/*</span>
<a id=__codelineno-78-9 name=__codelineno-78-9 href=#__codelineno-78-9></a>
<a id=__codelineno-78-10 name=__codelineno-78-10 href=#__codelineno-78-10></a><span class="l l-Scalar l-Scalar-Plain">RUN wget http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v${VERSION}/bin/apache-tomcat-${VERSION}.tar.gz &amp;&amp; \</span>
<a id=__codelineno-78-11 name=__codelineno-78-11 href=#__codelineno-78-11></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">tar zxf apache-tomcat-${VERSION}.tar.gz &amp;&amp; \</span>
<a id=__codelineno-78-12 name=__codelineno-78-12 href=#__codelineno-78-12></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">mv apache-tomcat-${VERSION} /usr/local/tomcat &amp;&amp; \</span>
<a id=__codelineno-78-13 name=__codelineno-78-13 href=#__codelineno-78-13></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">rm -rf apache-tomcat-${VERSION}.tar.gz /usr/local/tomcat/webapps/* &amp;&amp; \</span>
<a id=__codelineno-78-14 name=__codelineno-78-14 href=#__codelineno-78-14></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">mkdir /usr/local/tomcat/webapps/test &amp;&amp; \</span>
<a id=__codelineno-78-15 name=__codelineno-78-15 href=#__codelineno-78-15></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;ok&quot; &gt; /usr/local/tomcat/webapps/test/status.html &amp;&amp; \</span>
<a id=__codelineno-78-16 name=__codelineno-78-16 href=#__codelineno-78-16></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">sed -i &#39;1a JAVA_OPTS=&quot;-Djava.security.egd=file:/dev/./urandom&quot;&#39; /usr/local/tomcat/bin/catalina.sh &amp;&amp; \</span>
<a id=__codelineno-78-17 name=__codelineno-78-17 href=#__codelineno-78-17></a><span class=w>    </span><span class="l l-Scalar l-Scalar-Plain">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span>
<a id=__codelineno-78-18 name=__codelineno-78-18 href=#__codelineno-78-18></a>
<a id=__codelineno-78-19 name=__codelineno-78-19 href=#__codelineno-78-19></a><span class="l l-Scalar l-Scalar-Plain">ENV PATH $PATH:/usr/local/tomcat/bin</span>
<a id=__codelineno-78-20 name=__codelineno-78-20 href=#__codelineno-78-20></a>
<a id=__codelineno-78-21 name=__codelineno-78-21 href=#__codelineno-78-21></a><span class="l l-Scalar l-Scalar-Plain">WORKDIR /usr/local/tomcat</span>
<a id=__codelineno-78-22 name=__codelineno-78-22 href=#__codelineno-78-22></a>
<a id=__codelineno-78-23 name=__codelineno-78-23 href=#__codelineno-78-23></a><span class="l l-Scalar l-Scalar-Plain">EXPOSE 8080</span>
<a id=__codelineno-78-24 name=__codelineno-78-24 href=#__codelineno-78-24></a><span class="l l-Scalar l-Scalar-Plain">CMD [&quot;catalina.sh&quot;, &quot;run&quot;]</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>总结</p> <p>上面可以看出python的应用一般直接跑在某个python版本的alpine基础环境下的，而Gloang则是在GO的alpine环境下完成编译与测试后，然后通过多阶段构建的策略， 最后将编译完成Gloang程序运行在scratch镜像中，这样可以减小Golang程序最终的镜像大小，避免浪费资源。</p> </div> <div class="admonition example"> <p class=admonition-title>参考文献</p> <p><a href=https://www.bococ.cn/Docker/106.html>https://www.bococ.cn/Docker/106.html</a></p> </div> <h2 id=6dockerfile工具>6.Dockerfile工具<a class=headerlink href=#6dockerfile工具 title="Permanent link">&para;</a></h2> <div class="admonition info"> <p class=admonition-title>查看运行容器的Dockerfile工具</p> <p>项目地址：<a href=https://github.com/P3GLEG/Whaler>Whaler(opens new window)</a></p> <p>项目说明：能够查看在运行容器的Dockerfile的工具，有时候我们可能会维护一个没有Dockerfile的容器，即可借助此工具。</p> <p>相关文章：<a href=https://samaritan.ai/blog/reversing-docker-images-into-dockerfiles/ >博文介绍</a></p> </div> <div class="admonition info"> <p class=admonition-title>查看docker容器运行命令的所有参数</p> <p>项目地址：<a href=https://github.com/lavie/runlike>runlike(opens new window)</a></p> <p>项目说明：给定一个现有的 docker 容器，打印运行它的副本所需的命令行。</p> <p>相关文章：README</p> </div> <p>可以将运行的docker 推导反写为docker-compose文件</p> <h2 id=7参考文献>7.参考文献<a class=headerlink href=#7参考文献 title="Permanent link">&para;</a></h2> <div class="admonition info"> <p class=admonition-title>推荐阅读</p> <p><a href=https://vuepress.mirror.docker-practice.com/appendix/best_practices/#>Dockerfile 最佳实践</a></p> <p><a href=https://www.qikqiak.com/k8strain2/docker/dockerfile-practice/ >Dockerfile 实践</a></p> <p><a href=https://mp.weixin.qq.com/s/K7hD2hdwx_xXCFDQFHWvMg>Dockerfile那么多，哪个才是真正的最佳实践？</a></p> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">February 1, 2024 18:04:35</span> </span> <span class=md-source-file__fact> <span class=md-icon title=创建日期> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">March 30, 2023 11:29:10</span> </span> </aside> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by using our <a href="https://github.com/hujianli94/hujianli94.github.io/issues/new/?title=[Feedback]+7.Dockerfile+-+/Docker/1.%E5%9F%BA%E7%A1%80/7.Dockerfile/" target=_blank>feedback form</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=页脚> <a href=../6.Docker%E7%BD%91%E7%BB%9C/ class="md-footer__link md-footer__link--prev" aria-label="上一页: 6.Docker网络"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> 上一页 </span> <div class=md-ellipsis> 6.Docker网络 </div> </div> </a> <a href=../8.docker-compose/ class="md-footer__link md-footer__link--next" aria-label="下一页: 8.docker-compose"> <div class=md-footer__title> <span class=md-footer__direction> 下一页 </span> <div class=md-ellipsis> 8.docker-compose </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 - 2024 hujainli94 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/hujianli94 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://kaliarch-bucket-1251990360.cos.ap-beijing.myqcloud.com/blog_img/20220125122524.png target=_blank rel=noopener title=kaliarch-bucket-1251990360.cos.ap-beijing.myqcloud.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154zm-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4zm-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2zM563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4zm-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6zm107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6z"/></svg> </a> <a href="mailto:<1879324764@qq.com>" target=_blank rel=noopener title=发送邮件 class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">同意</button> <label class=md-button for=__settings>管理设定</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script> <script id=__config type=application/json>{"base": "../../..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "content.code.annotate", "navigation.indexes", "navigation.footer", "navigation.indexes", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../../assets/javascripts/bundle.8fd75fb4.min.js></script> <script src=../../../javascripts/extra.js></script> <script src=https://file.cdn.shafish.cn/blog/js/video.min.js></script> </body> </html>